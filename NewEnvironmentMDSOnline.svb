'Global Variables
Dim Excel, Result, Reason, Username1, Environment, Browser, pdfdoc, TestCaseName, strFormatDate, IdNo, UniqueName
Dim GlobalLname, GlobalInitial, GloabalContacts, GlobalFName, GlobalEmailAddress, GlobalID, GlobalContribution, GlobalTransfer, GlobalPathToScreen
Dim GlobalContractNumber, GlobaProcessId, ContributePayer, TestEnvironment, LoginURL,LogOffURL, LoggedInPage, PDFLinkpage  
'Get the name of the person who ran the test
Set Username1 = CreateObject("Wscript.Network")
GlobalContractNumber = " " 
GlobaProcessId = " "
Reason = "Reason"
TestEnvironment = "_"

'This is the driver script that controls the execution of our scripts 
Sub DriverScript
  
'This is to close all the instances of excel before open new ones
'Kill all instances of PDF before you generate a new PDF
Call Close_Process_Instances("AcroRd32")
Aqutils.Delay 2000
 
Call Close_Process_Instances("Excel")
aqUtils.Delay 1500
Call Close_Process_Instances("iexplore")
aqUtils.Delay 4500
'Read from the TestSuite Controller 
'This is where we populate the test suites that we want to execute
Set objFileRead = CreateObject("Scripting.FileSystemObject").OpenTextFile("C:\Testing\TestSuite\Test.txt",1)
Dim strLine,strLine1
Do While Not objFileRead.AtEndOfStream

strLine = objFileRead.ReadLine()
read = Split(strLine,"||") 
	
	if read(2) = "1" Then
	'Select the TestSuite that we want to Execute
  ' MsgBox "Test Suite that has been selected for execution :" &read(0)
 
	Dim RowCount, ColumnCount, i, j, s
 
  'Set Excel = Sys.OleObject("Excel.Application")
	Set Excel = CreateObject("Excel.Application")
  Excel.Workbooks.Open("C:\Testing\TestSuite\"&read(0)&".xlsx")
  'Excel.ActiveSheet("MainSheet").Activate
  'Activate the Mainsheet from the opnened excel file
	Excel.WorkSheets("MainSheet").Activate
	RowCount = Excel.ActiveSheet.UsedRange.Rows.Count
  ColumnCount = Excel.ActiveSheet.UsedRange.Columns.Count
      
	  For i = 2 To RowCount
    'Check if the test has been selected for test automation execution
	  If Excel.Cells(i,3) = "Y"  Then	    
		Excel.Cells(i,3).Value = "N"	
		Excel.Cells(i,13).Value = "In Progress"
		Excel.Cells(i,13).Interior.Color =  RGB(0,0,255)
    'Set the Test Case Name
    TestCaseName = Excel.Cells(i,1)
    'Get the formatted date to be used for our folder
    strFormatDate = FuncStrDateFormat 
      
    Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "Test Case Automation Started")
    'Set Excel = CreateObject("Excel.Application")   
    'Create an excel workbook that we going to report to  - Also making the 
    Set objWorkBook = Excel.Workbooks.Add()  
    Excel.Visible = False
    Excel.Cells(1,1).Value = "Test Case Name" 
   ' Excel.Cells(1,1).Font.Bold = True
    Excel.Cells(2,1).Value = TestCaseName
   ' Excel.Cells(2,1).Font.Bold = True
    Excel.Cells(1,2).Value = "Process Functionality"
 '   Excel.Cells(1,2).Font.Bold = True
    Excel.Cells(1,3).Value = "Result"
 '   Excel.Cells(1,3).Font.Bold = True
    Excel.Cells(1,4).Value = "Reason"
 '   Excel.Cells(1,4).Font.Bold = True
    Excel.Cells(1,5).Value = "ProcessId"
 '   Excel.Cells(1,5).Font.Bold = True
    Excel.Cells(1,6).Value = "ContractNumber"
 '   Excel.Cells(1,6).Font.Bold = True
    Excel.Cells(1,7).Value = "Path to screenshot"
  
   'This is the path to the Execution folder
    ExecutionPath = "C:\Test\"&TestCaseName&"\"&strFormatDate
    'Path to the report 
    Strpath = "C:\Test\"&TestCaseName&"\"&strFormatDate&"\Report.xlsx" 
  '  MsgBox Strpath
    objWorkBook.SaveAs("C:\Test\"&TestCaseName&"\"&strFormatDate&"\Report.xlsx")
   ' objWorkBook.SaveAs("C:\Test\"&TestCaseName&"\"&strFormatDate&"\Report.xlsx")
    objWorkBook.Close
    'Strpath - This is the path of Excel report -     
          b = 1
          'Activate The MainSheet
          Excel.WorkSheets("MainSheet").Activate
	    		For j = 4 To 11
          'Execute the selected function in the process         
          
          if Excel.Cells(i,j) <> "" Then
          'Msgbox(Excel.Cells(i,j))
	     	 	Eval(Excel.Cells(i,j))
			    End If
			  	if Result = "fail" Then
          b = b+1
          'Create the new Excel file where we going to send our results to 

          Excel.WorkSheets("MainSheet").Activate
          'Get the process as defined in Excel
          strProcess = Excel.Cells(i,j)
        '  MsgBox strProcess
          strStep = GetProcessFlow(strProcess)
         ' MsgBox strStep
          Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", strStep)
          'Log the details back to excel file that we created for reporting purposes
          Excel.Workbooks.Open(Strpath)
          Excel.WorkSheets("Sheet1").Activate
          Excel.Cells(b,2).Value = strStep          
          Excel.Cells(b,3).Value = "Fail" 
          Excel.Cells(b,3).Interior.Color = RGB(255,0,0)         
          Excel.Cells(b,4).Value = Reason 
          Excel.Cells(2,5).Value = GlobaProcessId 
          Excel.Cells(2,6).Value =  GlobalContractNumber
          Excel.Cells(b,7).Value = GlobalPathToScreen    
                     
          Excel.DisplayAlerts = False
          Excel.ActiveWorkBook.Save
          Excel.ActiveWorkBook.Close
				  'Activate the Mainsheet after the result is returned
					Excel.WorkSheets("MainSheet").Activate
          log.Message (" Test Suite:  "& read(0)& Excel.Cells(i,1)&"Failed at "&" -"& Excel.Cells(i,j))
					Excel.Cells(i,13).Value = "Fail"
					Excel.Cells(i,14).Value = "Failed at :"&Excel.Cells(i,j)&" - "& Reason
					Excel.Cells(i,13).Interior.Color = RGB(255,0,0)
					Excel.Cells(i,15).Value = "Last Execution :" &Now()
          Excel.Cells(i,16).Value = Username1.UserName
          Excel.Cells(i,17).Value = ExecutionPath

          Excel.ActiveWorkBook.Save
					'Exit the process cos of failure - To move onto the next test in the test suite
					 EXIT FOR
					ELSE	
          
            'Create the new Excel file where we going to send our results to 
          b = b+1
          'Activate The Excel sheet where we are going to report to
          Excel.WorkSheets("MainSheet").Activate
          'Get the process as defined in Excel
          strProcess = Excel.Cells(i,j)
        '  MsgBox strProcess
          strStep = GetProcessFlow(strProcess)
         ' MsgBox strStep
          Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", strStep)
          'Log the details back to excel file
          Excel.Workbooks.Open(Strpath)
          Excel.WorkSheets("Sheet1").Activate
          Excel.Cells(b,2).Value = strStep          
          Excel.Cells(b,3).Value = "Pass" 
          Excel.Cells(b,3).Interior.Color =  RGB(0,255,0)         
          Excel.Cells(b,4).Value = Reason  
          Excel.Cells(2,5).Value = GlobaProcessId 
          Excel.Cells(2,6).Value =  GlobalContractNumber
          Excel.Cells(b,7).Value = GlobalPathToScreen  
          
          Excel.DisplayAlerts = False
          Excel.ActiveWorkBook.Save
          Excel.ActiveWorkBook.Close                    
          'Activate the mainsheet that controls the test
					'Excel.ActiveSheet("MainSheet").Activate
					Excel.WorkSheets("MainSheet").Activate
					Excel.Cells(i,13).Value = "Pass"
					Excel.Cells(i,13).Interior.Color =  RGB(0,255,0)
					'Clear the comments if there is no failure
					Excel.Cells(i,14).Value = strStep&"-"&Reason
					Excel.Cells(i,15).Value = "Last Execution :" &Now()
          Excel.Cells(i,16).Value = Username1.UserName
          Excel.Cells(i,17).Value = ExecutionPath
          'Get the process as defined in Excel
          Excel.ActiveWorkBook.Save		
					END IF

    			NEXT
		ELSE
		Excel.Cells(i,3).Value = "Not selected for execution"
    
	  END IF 
  NEXT  
 			' Excel.Workbooks.SAVE 	
		  Excel.ActiveWorkBook.Save	
	    Excel.Quit
 End If

Loop

objFileRead.Close
Set objFileRead = Nothing 
Call Log.SaveResultsAs("C:\TestResult\"&Date()&"Log.mht", lsMHT)
End Sub

'Author JM Kekana
'The aim of the function is to remove the string before the (bracket in order to get the Process
Function GetProcessFlow(Byval process)
  if process = "" OR process = NULL Then
  strextract = "No process"
  Reason = ""
  else 
  str = process
  st = Split(str,"(")
'  if st(0) <> "" Then 
  strextract = st(0)  
  
  End IF 
  
  'str = process
  'st = Split(str,"(")
  'if st(0) <> "" Then 
  'strextract = st(0)    
  'else
  '  strextract = "No process"     
 ' End If
  GetProcessFlow = strextract
End Function 
'Author JM Kekana
'The aim of the function is to get the current date in a string format type
Function FuncStrDateFormat
  strDate = Now()
  newdate =  Replace(strDate,":","_")
  newdate2 = Replace(newdate," ","_")
  'MsgBox newdate2
  newdate1 = Replace(newdate2,"/","_")
  'MsgBox newdate1
  FuncStrDateFormat = newdate1
End Function
'Author JM Kekana
'The aim of the function is to upload documents
Function UploadFileDoc
 Set fileup = Sys.Browser("iexplore").Window("#32770", "Choose File to Upload", 1).Window("ComboBoxEx32", "", 1).Window("ComboBox", "", 1).Window("Edit", "", 1)
 fileup.SetText "C:\Users\johannes.kekana\Pictures\Beneficiary Screen\UploadDoc.docx" 
 
 Set Files = Sys.Browser("iexplore").Window("#32770", "Choose File to Upload", 1).Window("ComboBox", "", 1)
 Files.ClickItem("All Files (*.*)")
 
 Set BtnOpen = Sys.Browser("iexplore").Window("#32770", "Choose File to Upload", 1).Window("Button", "&Open", 1)
 BtnOpen.Click
 aqUtils.Delay 2000
 
 Call ObjPropertyFindClick("contentText", "Upload", "Button")
 
End Function


'Author JM Kekana
'The aim of this function is to take and save screentshot it takes as it executes
' Argument ExecutionDate is for getting the folder in a date format will call FuncStrDateFormat
'Argument 2 takes the test case name
'Argument 3 takes the Result 
'Argument 4 Test step or where in the process 
Function SaveScreenShot(Byval ExecutionDate, Byval TestName, Byval Result, Byval TestStep)

  strDate = Now()
  newdate =  Replace(strDate,":","_")
  newdate2 = Replace(newdate," ","_")
  newdate1 = Replace(newdate2,"/","_")

 'Concatinate the TestEnvironment so that when we take our screenshot we always include the environment
  Spath = "C:\Test\"&TestName&"\"&ExecutionDate&"\"&Result&"_"&TestEnvironment&"\"
  'MsgBox Spath
  'Set w = Sys.Desktop.FocusedWindow.Picture '(20, 20, 50, 50)
  Set w = Sys.Desktop.Picture '(20, 20, 50, 50)
  'w.SaveToFile "C:\Data\screenimage1"&Date()&".png"
  aqFileSystem.CreateFolder(Spath)
  'Assign the global variable path to screenshot
  GlobalPathToScreen = Spath&TestStep&newdate1&".png" 
  w.SaveToFile Spath &TestStep&newdate1&".png"  
End Function 
'Author JM Kekana
'This function is for entering a password on the PDF Application form
'As a parameter we taking the password from the ID No we used when entering the application details
Function FuncPDFPassword(Byval passw)
aqUtils.Delay 6000  
'Trim the spaces
pwd = Trim(passw)
Set AcrobatRead = Sys.Process("AcroRd32",2).Window("#32770", "Password", 1).Window("GroupBox", "", 1).Window("RICHEDIT50W", "", 1)

if AcrobatRead.Exists Then
  AcrobatRead.Keys pwd
  aqUtils.Delay 5000
  Set BtnObj = Sys.Process("AcroRd32",2).Window("#32770", "Password", 1).Window("GroupBox", "", 1).Window("Button", "OK", 1)
  BtnObj.Click  
  aqUtils.Delay 8000
  'Click the Ok confirmation button
  Set BtnOk = Sys.Process("AcroRd32",2).Window("#32770", "Acrobat Reader", 1).Window("GroupBox", "", 1).Window("Button", "OK", 2)
  BtnOk.Click  
  aqUtils.Delay 4500 
End IF

End Function

Sub PDFReader
'Dim str
'Dim docobj
'Call loadDocument("C:\Users\johannes.kekana\Documents\Docs\Change of Employer.pdf")
'dotNET.
'Set File1 = dotNET.org_apache_pdfbox_io.ASCII85InputStream
Dim fso, f1
'Set fso = CreateObject("Scripting.FileSystemObject")
'Set f1 = fso.GetFile("C:\Users\johannes.kekana\Documents\Docs\Change of Employer.pdf")
'File1 = "C:\Users\johannes.kekana\Documents\Docs\Change of Employer.pdf"


'Set File1 = dotNET.org_apache_pdfbox_io.RandomAccessFileInputStream("C:\Users\johannes.kekana\Documents\Docs\Change of Employer.pdf")
'Set pdfdoc = dotNET.org_apache_pdfbox_pdmodel.PDDocument.load_5(f1,true)
JavaClasses.javax_imageio.ImageIO()
Set File1 = JavaClasses.java_io.File("‪C:\TestExecution\InvestmentProposal.pdf")
Set pdff = JavaClasses.org_apache_pdfbox_pdmodel.PDDocument.load(File1)
'Set pdfdoc = dotNET.org_apache_pdfbox_pdmodel.PDDocument.load(File1)
Set stripper = JavaClasses.org_apache_pdfbox_util.PDFTextStripper.newInstance
Set str = stripper.getText(pdff)
MsgBox str
'text = getParagraphText(docObj, 0, 4)
'Log.Message(text)
'MsgBox docobj
'Set textStripperObj = dotNET.org_apache_pdfbox_util.PDFTextStripper.zctor

'str = dotNET.org_apache_pdfbox_util.PDFTextStripper.zctor_2.getText(docobj)
'str = textStripperObj.getText(pdfdoc)
'MsgBox str
Call Log.Message("See info",str)

End Sub 



Function loadDocument(fileName)

'  Dim docObj1
  
  ' Load the PDF file to the PDDocument object
Set pdfdoc =  dotNET.org_apache_pdfbox_pdmodel.PDDocument.load(fileName)
 'Set docObj1 = JavaClasses.org_apache_pdfbox_pdmodel.PDDocument.load(fileName)
  '// Return the resulting PDDocument object
'loadDocument = pdfdoc
End Function
'Author JM Kekana
'This function closes the processes
'Take the name of a process as a parameter
Function Close_Process_Instances(Byval application)
  Dim p, isClosed
  ' Obtains the notepad.exe process
  Set p = Sys.FindChild("ProcessName", application)
  ' until all of them are closed
  While p.Exists
    p.Close
    ' Waits until the process is closed
    isClosed = p.WaitProperty("Exists", False)
    ' Checks whether the process has been closed successfully
    If Not isClosed Then
      ' Terminates the process
      p.Terminate
    End If
    ' Obtains another instance of the application process
    Set p = Sys.FindChild("ProcessName", application)
  Wend
End Function


Function ProcessCreate(Byval test, Byval env, Byval Prodtype)
  Dim Process
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
'	str1 = str
 ' msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else     
     Process = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

  Dim browser,section, panel, textbox, button

  Browsers.Item("iexplore").Run()
  aqUtils.Delay 2000

  'Maximize the screen
  Sys.Browser().BrowserWindow(0).Maximize
  'Re Direct to the correct screen
  Call Browsers.Item(btIExplorer, "", Browsers.pX64).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/processSearch")
    
'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/processSearch")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set panel = section.formFormHorizontalNgUntouchedNg.panelFormGroup
  Call panel.panelCheckboxColSm3.checkboxCreateNewProcess.Click(10, 13)
  Set textbox = panel.panelColSm9.textboxProcessId
  Call textbox.Click(37, 12)
  Call textbox.SetText(Process)
  Call browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser.Click(1138, 268)
 ' Select the product that you want to select
 Set vselect = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup.panelColSm9.panelModalContent.selectProductType
 if Prodtype = "FEO"  Then 
 
    Call vselect.ClickItem("Flexible endowment option")
  'Call browser.ToUrl("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/processSearch")
    Elseif Prodtype = "FIO"   Then
    Call vselect.ClickItem("Flexible investment option")
    Elseif Prodtype = "FTFO"  Then
    Call vselect.ClickItem("Flexible tax free option")
   Elseif Prodtype = "RAO" Then
    Call vselect.ClickItem("Retirement annuity option")
   Elseif Prodtype = "RIO"  Then
    Call vselect.ClickItem("Retirement income option")
   Elseif Prodtype = "RPO" Then
    Call vselect.ClickItem("Retirement preservation option")
  End If 
'  Call browser.pageWwwGoogleCoZa.panelAls.Click(1183, 17)
  Set button = section.buttonCreateAndLoadProcess
  Call button.Click
 aqUtils.Delay 2000 
  if textbox.Exists Then
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/processSearch").Section(0).Panel(1).Panel(0).Button(0).Click
  ' Call button.Click
  ' ElseIf button.Exists Then
   'Do nothing
  End If 
  
End Function
'Load Process Function Pass it the row and enviroment
Function LoadProcess(Byval test, Byval env)

  Dim Process
  Excel.WorkSheets("LoadProcess1").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then

		 Else     
     ProcessId = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

  Dim section, textbox
  
  Browsers.Item("iexplore").Run()
  aqUtils.Delay 2000

    'Maximize the screen
  Sys.Browser().BrowserWindow(0).Maximize
  'Re Direct to the correct screen
  Call Browsers.Item(btIExplorer, "", Browsers.pX64).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")
   
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")
  Set section = Aliases.browser.pageNewBusinessCapture2.section
  Set textbox = section.formFormHorizontalNgUntouchedNg.panelFormGroup.panelColSm9.textboxProcessId
  Call textbox.Click(24, 26)
  Call textbox.SetText(ProcessId)
  'Call textbox.Keys(ProcessId)
  Call section.buttonCreateAndLoadProcess.ClickButton
  
End Function

Function CaptureClientD(Byval val,Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section

  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click
  
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  if panel.selectTitle.Exists Then
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.selectTitle.ClickItem(Title&"*")
'  Call panel.selectTitle.ClickItem(Title&"*")
  Call aqObject.CheckProperty(panel.selectTitle, "wText", cmpEqual, Title, False)
  
  Set textbox = panel.panelColSm3.textboxInitials
  
 ' Call textbox.Click(34, 26)
  Call textbox.SetText(Initials)
  
  Call aqObject.CheckProperty(textbox, "wText", cmpEqual, Initials, False)

  'Call textbox.Keys("[Tab]")
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  Call textbox2.SetText(Fullname)
  Call aqObject.CheckProperty(textbox2, "wText", cmpEqual, Fullname, False)
  'Call textbox2.Keys("[Tab]")
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  Call textbox2.SetText(PreferName)
  Call aqObject.CheckProperty(textbox2, "wText", cmpEqual, PreferName, False)
  'Call textbox2.Keys("[Tab]")
  'Call textbox.Click(28, 8)
  'Call textbox.SetText("J")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  Call textbox.Click(99, 34)
  Call textbox.SetText(Surname)
    Call aqObject.CheckProperty(textbox, "wText", cmpEqual, Surname, False)
 ' Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panel.panelFormGroup.buttonYes. 
 'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.Panel(6).Panel(0).Panel(0).Textbox("passportNumberInput")
 'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.Panel(6).Panel(1).Panel(0).Select("passportCountryOfIssueInput")
  Call form.buttonRsaIdNumber.Click(11, 11)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  Call textbox.Click(220, 16)
  

  Call textbox.SetText(Idnumber)
  Call aqObject.CheckProperty(textbox, "wText", cmpEqual, Idnumber, False)
  Set button2 = form.buttonSouthAfrican
  
  Nationality = Excel.Cells(b,9)
  
  If Nationality = "SA" Then
  Call button2.Click(9, 10)
  Else
  Call form.buttonNonSouthAfrican.Click(18, 10)
  Call button2.Click(8, 3)
  End If
 
 Gender = Excel.Cells(b,10)
 
 If Gender = "Female" Then
  Call form.radiobuttonFemale.Click(18, 5)
  Else  
 Call form.buttonMale.Click(16, 8) 
 End If
 
 
  Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  PEP = Excel.Cells(b,11)

   
  If PEP = "Yes" Then
'  MsgBox "Selected"
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Call form2.buttonYes.Click
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  Call browser2.Drag(1359, 282, 6, 89)
  
  Else 
 '       MsgBox "Its A No"
        Set form2 = form.formFormHorizontalNgUntouchedNg
        Call form2.buttonNo.Click(12, 9)
  End if 
  'Call button.Click(53, 17)
  'set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)

  set UpdateBtn =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails")
'  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
      UpdateBtn.Click
      
      
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")   
  Result = "pass"
  
  Else
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")  
  Result = "fail"
  End If 
End Function

Function Contactdetails(Byval val,Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,18)
     TelW = Excel.Cells(b,19)
     Cell = Excel.Cells(b,20)
     Fax = Excel.Cells(b,21)
     Email = Excel.Cells(b,22)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set button = section.buttonCreateAndLoadProcess
 ' Set obj = Aliases.browser.pageNewBusinessCapture2.section.buttonCreateAndLoadProcess.textnodeView
'  Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0)
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click

'  Set tst1 = obj.Find("sourceIndex","103", 2)
'  tst1.Click
  'Call button.textnodeView.Click
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  'if panel.selectTitle.Exists Then
  
  'Call panel.selectTitle.ClickItem(Title)
  'Set textbox = panel.panelColSm3.textboxInitials
 ' Call textbox.Click(34, 26)
  'Call textbox.SetText(Initials)
  'Call textbox.Keys("[Tab]")
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  'Call textbox2.SetText(Fullname)
  'Call textbox2.Keys("[Tab]")
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  'Call textbox2.SetText(PreferName)
  'Call textbox2.Keys("[Tab]")
  'Call textbox.Click(28, 8)
  'Call textbox.SetText("J")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  'Call textbox.Click(99, 34)
  'Call textbox.SetText(Surname)
  'Call form.buttonRsaIdNumber.Click(11, 11)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  'Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  'Call textbox.Click(220, 16)
  'Call textbox.Keys("[Up]")
  'Call textbox.SetText("")
  'Call textbox.Keys("[Home]")
  'Call textbox.SetText(Idnumber)
  Set button2 = form.buttonSouthAfrican
  'Call button2.Click(9, 10)
  'Call form.buttonNonSouthAfrican.Click(18, 10)
  'Call button2.Click(8, 3)
  'Call form.radiobuttonFemale.Click(18, 5)
  'Call form.buttonMale.Click(16, 8)
  'Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  'Call form2.buttonNo.Click(12, 9)
  'Call form2.buttonYes.Click(6, 11)
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  'Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  'Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  'Call browser2.Drag(1359, 282, 6, 89)
  'Call button.Click(53, 17)
  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
   '   UpdateBtn.Click
      
  'Call browser2.Drag(1360, 374, 5, 176)
  Set panel6 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Call panel6.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(835, 29)
  Set button2 = form.buttonEnglish
  language = Excel.Cells(b,16)
  if language = "English" Then
  Set button2 = form.buttonEnglish
  Call button2.Click(15, 15)
  Else   
  Call form.buttonAfrikaans.Click(6, 21)
  'Call button2.Click(11, 17)
  
  End If
  CommMethod =  Excel.Cells(b,17)
  if CommMethod = "Post" Then
  Call panel.buttonPost.Click(13, 22)
  Else 
  Call panel2.buttonEmail.Click(15, 13)
  End If
  Call browser2.Drag(1358, 233, 7, 101)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
'  Call textbox.Click(226, 31)
  Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Call textbox.Click(22, 25)
  Call textbox.SetText(TelH)
  Call form.Click(308, 243)
  Set textbox = panel4.panelColSm4.textboxCellphone
  'Call textbox.Click(125, 22)
  Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  'Call textbox.Click(42, 22)
  Call textbox.SetText(Fax)
  Set panel = form.panelFormGroup5.panelColSm4
  Set emailInput = panel.emailinputEmail
  'Call emailInput.Click(240, 16)
  Call emailInput.SetText(Email)
  Call browser2.Drag(1357, 335, 8, 145)
  'The Adress Section
  
  Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.Click(12, 11)
  Set form2 = form.formFormNgUntouchedNgPristineN2
  Set textbox = form2.panelFormGroup.panelColSm8.textboxLine1
  'Call textbox.Click(220, 15)
  'textbox.ClickR
  Line1 = Excel.Cells(b,23)  
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  'lin1.DblClickM
  lin1.SetText(Line1)
  'Call textbox.SetText(Line1)
  Set textbox = form2.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox.Click(132, 5)
  Line2 = Excel.Cells(b,24)
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  'lin2.DblClickM
  lin2.SetText(Line2)
  'Call textbox.SetText(Line2)
  Set textbox = form2.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox.Click(82, 31)
  Line3 = Excel.Cells(b,25)
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  'lin3.DblClickM
  lin3.SetText(Line3)
  'Call textbox.SetText(Line3)
  Set textbox = form2.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox.Click(44, 20)
  City = Excel.Cells(b,26)
  Set cit = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  'cit.DblClickM
  cit.SetText(City)
  'Call textbox.SetText(City)
  Set textbox = form2.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox.Click(26, 25)
  PostCode = Excel.Cells(b,27)
  Set Code = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  'Code.DblClickM
  Code.SetText(PostCode)
  'Call textbox.SetText(PostCode)
  Set textbox = form2.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox.Click(5, 36)
  Province = Excel.Cells(b,28)
  Set provinc = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  'provinc.DblClickM
  provinc.SetText(Province)
  'Call textbox.SetText(Province)
  Call browser2.Drag(1361, 430, 3, 67)
  Set vselect = form2.selectCountry
  Country = Excel.Cells(b,29)
  Set Countr = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.selectCountrycodePhysical
  Countr.ClickItem(Country)
  'Call vselect.ClickItem(Country)
 ' Call vselect.ClickItem("Select..")
 'Have to get the Full Name
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
 '  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click 
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails").Click
  
  'Call button.Click(28, 21)
  
  
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")  

End Function 

'This function is for adding Contribution Payer details
Function ContributionDetails(Byval val,Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("ContributionPayer").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	aqUtils.Delay 5000
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

   
 ' Set Title1 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Select("titleInput")
 ' Title1.ClickItem(Title&"*")
    Call ObjPropertyFindSelect("idStr","titleInput","Select",Title&"*")

  'Set Initial = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Textbox("initialsInput")
  'Initial.SetText(Initials) 
  Call ObjPropertyFindEnterText("idStr","initialsInput","INPUT",Initials)
 ' Call textbox.SetText()
  'Call textbox.Keys("[Tab]")
'  Fullname = Excel.Cells(b,5)
  Call ObjPropertyFindEnterText("idStr","fullNamesInput","INPUT",Fullname)
  'Set FName = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Textbox("fullNamesInput")
  'FName.SetText(Fullname)

 ' Set PrefName = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("preferredNameInput")
 ' Prefname.SetText(PreferName)
  Call ObjPropertyFindEnterText("idStr","preferredNameInput","INPUT",PreferName)

 ' Set Sname = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("surnameInput")
 ' Sname.SetText(Surname)
  Call ObjPropertyFindEnterText("idStr","surnameInput","INPUT",Surname)
  aqUtils.Delay 0550
 ' Set IDType = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Label(0)
 ' IDType.Click
  Call  ObjPropertyFindClick("contentText","RSA ID number", "Label")
  'Call textbox.Click(220, 16)
 ' Set IdNum = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Textbox("idNumberInput")
 ' IdNum.SetText(Idnumber)
  IdNo = Idnumber
  Call ObjPropertyFindEnterText("idStr","idNumberInput","INPUT",Idnumber)
  'Set button2 = form.buttonSouthAfrican
 ' Set NationSA = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(0).Label(0)
 ' NationSA.Click
 Call  ObjPropertyFindClick("contentText","South African", "Label")
 
  'Set GenderMale = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(0).Panel(0).Label(0)
  'GenderMale.Click
  
    IF Gender = "Male" Then
 'Select the Gender Male
 Call  ObjPropertyFindClick("contentText","Male", "Label")
 
  Else
  'Select the Gender Female
  Call  ObjPropertyFindClick("contentText","Female", "Label")
  End If  
  
  PEP = Excel.Cells(b,11)
  
  
  IF PEP = "No" THEN
  'Set PEPNO = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(0).Panel(0).Panel(1).Label(0)
  'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(0).Panel(0).Panel(1).Label(0)
  'PEPNO.Click
  Call  ObjPropertyFindClick("contentText","No", "Label")
  ELSE
 ' Set PEPYES = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(0).Panel(0).Panel(0).Label(0)
  'PEPYES.Click
  Call  ObjPropertyFindClick("contentText","Yes", "Label")
  aqUtils.delay 1500
  'Set HeadOfState = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Panel(0).Panel(0).Label(0)
  'HeadOfState.Click - Member of Parliament
  Call  ObjPropertyFindClick("contentText","Member of parliament/local/provincial government", "Label")  
  END IF
 
 ' Set UpdateBtn = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails")   
 ' set UpdateBtn Old = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
  '    UpdateBtn.Click
   Call  ObjPropertyFindClick("idStr","updatePersonDetails", "Button")   
  'Click the Contact Details  
  ' Set ContactAccordion = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0)      
  ' ContactAccordion.Click
   aqUtils.Delay 1500
   Call  ObjPropertyFindClick("contentText","Contact details", "DIV")
   
  'Set English = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Label(0)
  'English.Click
  'Click the English radio button
  Call  ObjPropertyFindClick("contentText","English", "Label") 
   
  'Set MethodofComP = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Label(0)
  'MethodofComP.Click
  'Select Method of communication
  Call  ObjPropertyFindClick("contentText","Email", "Label")
  'Set textbox = panel3.panelColSm4.textboxTelephoneW
  'Set TeleW = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("workTelephone")
  'TeleW.SetText(TelW)
  Call ObjPropertyFindEnterText("idStr","workTelephone","INPUT",TelW)
  'Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Set TeleH = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(1).Textbox("homeTelephone") 
 ' TeleH.SetText(TelH)
  Call ObjPropertyFindEnterText("idStr","homeTelephone","INPUT",TelH)
 ' Set CellNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("cellPhone")
 ' CellNo.SetText(Cell)
  Call ObjPropertyFindEnterText("idStr","cellPhone","INPUT",Cell)
'  Set Faxno = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(1).Textbox("fax")
'  Faxno.SetText(Fax)
  Call ObjPropertyFindEnterText("idStr","fax","INPUT",Fax)
'  Set emailtxt = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).EmailInput("email")
'  emailtxt.SetText(Email)
Call ObjPropertyFindEnterText("idStr","email","INPUT",Email)

  Line1 = Excel.Cells(b,21)  
'  Set lin1 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
 ' lin1.SetText(Line1)
  Call ObjPropertyFindEnterText("idStr","addressLine1_Physical","INPUT",Line1)  
  Line2 = Excel.Cells(b,22)
  'Set lin2 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  'lin2.SetText(Line2)
  Call ObjPropertyFindEnterText("idStr","addressLine2_Physical","INPUT",Line2)

  Line3 = Excel.Cells(b,23)
 ' Set lin3 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
'  lin3.SetText(Line3)
Call ObjPropertyFindEnterText("idStr","addressLine3_Physical","INPUT",Line3)

  City = Excel.Cells(b,24)
 ' Set cit = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
 ' cit.SetText(City)
  Call ObjPropertyFindEnterText("idStr","addressCity_Physical","INPUT",City)

  PostCode = Excel.Cells(b,25)
 ' Set Code = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
 ' Code.SetText(PostCode)  
  Call ObjPropertyFindEnterText("idStr","addressPostalCode_Physical","INPUT",PostCode)

  Province = Excel.Cells(b,26)
 ' Set provinc = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Select("addressProvince_Physical")
  'Old Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
 ' provinc.ClickItem(Province)
  Call ObjPropertyFindSelect("idStr","addressProvince_Physical","Select",Province)
  Country = Excel.Cells(b,27)
  'Set Countr = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(7).Panel(0).Select("countryCode_Physical")
  'Countr.ClickItem(Country)
  Call ObjPropertyFindSelect("idStr","countryCode_Physical","Select",Country)

  'Set PostalSame = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(1).Panel(0).Label(0) 
  'PostalSame.Click
  Call ObjPropertyFindClick("contentText","Same as physical address", "Label")
' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
 ' Set Updateb = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails")
 ' Updateb.Click
  Call  ObjPropertyFindClick("idStr","updatePersonContactDetails", "BUTTON") 
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  aqUtils.delay 2000
 ' Set BankingSec = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(0).Panel(0).Panel(0).Panel(0)
 ' BankingSec.Click
  Call  ObjPropertyFindClick("contentText","Banking details", "DIV")

  AccHolder = Excel.Cells(b,29)
  'Set Accntholder = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Select("accountHolderRelationshipInput")
  'Accntholder.ClickItem(AccHolder)
  Call ObjPropertyFindSelect("idStr","accountHolderRelationshipInput","Select",AccHolder) 
  'Set vselect = panel2.selectBankName
  BankName = Excel.Cells(b,30)
'  Set Banknm = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Select("bankNameInput")
'  Banknm.ClickItem(BankName)
  Call ObjPropertyFindSelect("idStr","bankNameInput","Select",BankName)
 ' Set Branchnm = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Select("branchNameInput")  
  BranchName = Excel.Cells(b,31)
  'Branchnm.ClickItem(Branchname)
  Call ObjPropertyFindSelect("idStr","branchNameInput","Select",Branchname)
  AccType = Excel.Cells(b,32)
'  Set Accntype = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Select("accountTypeInput")
'  Accntype.ClickItem(AccType)
  Call ObjPropertyFindSelect("idStr","accountTypeInput","Select",AccType)
  
 ' Set textbox = panel.textboxBranchNumber
 ' Set Branchnumber = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Textbox("branchNumberInput")
  BranchNum = Excel.Cells(b,33) 
 ' Branchnumber.SetText(BranchNum)
  Call ObjPropertyFindSelect("idStr","branchNumberInput","Select",BranchNum)

 ' Set Accnumb = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Textbox("accountNumberInput")
  AccNo = Excel.Cells(b,34) 
 ' Accnumb.SetText(AccNo)
  Call ObjPropertyFindEnterText("idStr","accountNumberInput","INPUT",AccNo)
  'Click the Update Button
  'Set BankingDet = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonBankingDetails")
  'BankingDet.Click
  Call  ObjPropertyFindClick("idStr","updatePersonBankingDetails", "BUTTON") 
  aqUtils.Delay 1500  
  'Click the Product Details Button to take you back to the Role Players screen
 ' Set btnProdDetails = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("productDetails")
 ' btnProdDetails.Click
 Call  ObjPropertyFindClick("idStr","productDetails", "BUTTON")
  Aqutils.Delay 2000
End Function

'Author JM Kekana
'The aim of the function is to capture client details
'It takes the Row No as an Arguement
Function ClientDetails(Byval val,Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	aqUtils.Delay 5000
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     Gender = Excel.Cells(b,10) 
     PEP = Excel.Cells(b,11) 
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
     
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect
  
  'Call the Validate Process Status in the Task List
  Call ValidateQuoteStatus("Progress")
  aqUtils.Delay 5000
'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")

  'Check to see if the View Client Details screen exists
  'Set ViewClientDetails = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Button("viewClientDetails")
  ViewClientDetails = ObjPropertyFind("idStr","viewClientDetails","Button")
  If ViewClientDetails = True Then
  'Get the ProcessID
  Call GetProcessid()
  'Click the Client Details Edit button
  Call  ObjPropertyFindClick("idStr","viewClientDetails", "Button")
  
  aqUtils.Delay 2000
  'Validate the NBC details vs Quote Details
  Call ValidateQuoteDataNBC("Personal")
     
 ' Set Title1 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Select("titleInput")
 ' Title1.ClickItem(Title&"*")
 'Select the Title
  Call ObjPropertyFindSelect("idStr","titleInput","Select",Title&"*")

  'Set Initial = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel("[0-9]").Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Textbox("initialsInput")
  'Initial.SetText(Initials) 
  'Enter the Initials
  '  Call ObjPropertyFindEnterText("idStr","initialsInput","Textbox",Initials)
  Call ObjPropertyFindEnterText("idStr","initialsInput","INPUT",Initials)
 
 ' Set FName = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("preferredNameInput")
'  FName.SetText(Fullname)
  'Enter the Fulla Name
 ' Call ObjPropertyFindEnterText("idStr","fullNamesInput","Textbox",Fullname)
  Call ObjPropertyFindEnterText("idStr","fullNamesInput","INPUT",GlobalFName)
  
'  Set PrefName = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("preferredNameInput")
 ' Prefname.SetText(PreferName)
  'Enter the Prefer Name
  Call ObjPropertyFindEnterText("idStr","preferredNameInput","INPUT",PreferName)

 ' Set Sname = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("surnameInput")
 ' Sname.SetText(Surname)
 'Enter The Surname
  Call ObjPropertyFindEnterText("idStr","surnameInput","INPUT",Surname)

  aqUtils.Delay 0550
'  Set IDType = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Label(0)
'  IDType.Click
  'Click the RSA ID Number
  Call  ObjPropertyFindClick("contentText","RSA ID number", "Label")
  'Call textbox.Click(220, 16)
 ' Set IdNum = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Textbox("idNumberInput")
 ' IdNum.SetText(Idnumber)
  IdNo = Idnumber
  'Enter the Id Number
  Call ObjPropertyFindEnterText("idStr","idNumberInput","INPUT",Idnumber)

 ' Set NationSA = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(0).Label(0)
 ' NationSA.Click
 'Select the Nationality 
 Call  ObjPropertyFindClick("contentText","South African", "Label")
  'Select the Gender
  IF Gender = "Male" Then
 ' Set GenderMale = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(0).Panel(0).Label(0)
 ' GenderMale.Click
 'Select the Gender Male
 Call  ObjPropertyFindClick("contentText","Male", "Label")
 
  Else
  'Set GenderFemale = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(0).Panel(1).Label(0)
  'GenderFemale.Click
  'Select the Gender Female
  Call  ObjPropertyFindClick("contentText","Female", "Label")
  End If
 
  If PEP = "No" Then
  'Set PEPNO = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(0).Panel(0).Panel(1).Label(0)
  'PEPNO.Click
  Call  ObjPropertyFindClick("contentText","No", "Label")
  Else 
  Call  ObjPropertyFindClick("contentText","Yes", "Label")
  'Set PEPYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(0).Panel(0).Panel(0).Label(0)
  'PEPYes.Click
  
  aqUtils.Delay 2500
  'Option to select when person is politically exposed person
  
'  Set MemberofParliament = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Panel(0).Panel(1).Label(0)
'  MemberofParliament.Click
  'Head of State
  Call  ObjPropertyFindClick("contentText","Member of parliament/local/provincial government", "Label")
  'Set SeniorOfficial = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Panel(0).Panel(3).Label(0)
  'SeniorOfficial.Click
  Call  ObjPropertyFindClick("contentText","Senior and/or influential official", "Label")
  End IF
  
  'Click the Update Personal details Button Button
   Call  ObjPropertyFindClick("idStr","updatePersonDetails", "Button")
   'Click the Contact Details Panel
  ' Call  ObjPropertyFindClick("contentText","Contact details", "Panel")
                    
'  Set UpdateBtn = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails")   
 ' set old UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
 '     UpdateBtn.Click
      aqUtils.Delay 1500
  'Click the Contact Details  Accordion
  ' Set ContactAccordion = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0)      
  ' ContactAccordion.Click
   Call  ObjPropertyFindClick("contentText","Contact details", "DIV")
   aqUtils.Delay 1500
   'Validate the NBC contact details vs Quote Details
   Call ValidateQuoteDataNBC("Contact")
   
'  Set English = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Label(0)
'  English.Click

  Call  ObjPropertyFindClick("contentText","English", "Label")
  
 ' Set MethodofComP = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Label(0)
 ' MethodofComP.Click
  'Method of Communication Select English
   Call  ObjPropertyFindClick("contentText","Email", "Label")
  '

 ' Set TeleW = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("workTelephone")
 ' TeleW.SetText(TelW)
  'Enter the Telephone Work
  'Call ObjPropertyFindEnterText("idStr","workTelephone","Textbox",TelW)
  Call ObjPropertyFindEnterText("idStr","workTelephone","INPUT",TelW)  
  'Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Set TeleH = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(1).Textbox("homeTelephone") 
 ' TeleH.SetText(TelH)
  'Enter the Telephone home
  Call ObjPropertyFindEnterText("idStr","homeTelephone","INPUT",TelH)

 ' Set CellNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("cellPhone")
 ' CellNo.SetText(Cell)
  Call ObjPropertyFindEnterText("idStr","cellPhone","INPUT",Cell)
  
'  Set Faxno = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(1).Textbox("fax")
'  Faxno.SetText(Fax)
'  Enter the FaxNo
  Call ObjPropertyFindEnterText("idStr","fax","INPUT",Fax)

'  Set emailtxt = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).EmailInput("email")
'  emailtxt.SetText(Email)
  Call ObjPropertyFindEnterText("idStr","email","INPUT",Email)

  Line1 = Excel.Cells(b,21)  
'  Set lin1 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
 ' lin1.SetText(Line1)
   Call ObjPropertyFindEnterText("idStr","addressLine1_Physical","INPUT",Line1)
  
  Line2 = Excel.Cells(b,22)
'  Set lin2 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
 ' lin2.SetText(Line2)
  Call ObjPropertyFindEnterText("idStr","addressLine2_Physical","INPUT",Line2)
  
  Line3 = Excel.Cells(b,23)
  'Set lin3 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  'lin3.SetText(Line3)
  Call ObjPropertyFindEnterText("idStr","addressLine3_Physical","INPUT",Line3)
  
  City = Excel.Cells(b,24)
 ' Set cit = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
 ' cit.SetText(City)
  Call ObjPropertyFindEnterText("idStr","addressCity_Physical","INPUT",City)

  PostCode = Excel.Cells(b,25)
 ' Set Code = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
 ' Code.SetText(PostCode)   
  Call ObjPropertyFindEnterText("idStr","addressPostalCode_Physical","INPUT",PostCode) 

  
  Province = Excel.Cells(b,26)
  'Set provinc = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Select("addressProvince_Physical")
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  'provinc.ClickItem(Province)
  Call ObjPropertyFindSelect("idStr","addressProvince_Physical","Select",Province)


  Country = Excel.Cells(b,27)
 ' Set Countr = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(7).Panel(0).Select("countryCode_Physical")
 ' Countr.ClickItem(Country)
  Call ObjPropertyFindSelect("idStr","countryCode_Physical","Select",Country)

 ' Set PostalSame = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(1).Panel(0).Label(0) 
 ' PostalSame.Click
 Call  ObjPropertyFindClick("contentText","Same as physical address", "Label")
' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
'  Set Updateb = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails")
'  Updateb.Click
  Call  ObjPropertyFindClick("idStr","updatePersonContactDetails", "BUTTON")  

  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  Aqutils.Delay 2500
'  Call  ObjPropertyFindClick("contentText","Banking details", "Panel")
'  Set BankingSec = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(0).Panel(0).Panel(0).Panel(0)
'  BankingSec.Click
  Call  ObjPropertyFindClick("contentText","Banking details", "DIV")
  
  AccHolder = Excel.Cells(b,29)
 ' Set Accntholder = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Select("accountHolderRelationshipInput")
 ' Accntholder.ClickItem(AccHolder)
  Call ObjPropertyFindSelect("idStr","accountHolderRelationshipInput","Select",AccHolder)
  'Set vselect = panel2.selectBankName
  BankName = Excel.Cells(b,30)
'  Set Banknm = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Select("bankNameInput")
'  Banknm.ClickItem(BankName)  
  Call ObjPropertyFindSelect("idStr","bankNameInput","Select",BankName)
 ' Set Branchnm = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Select("branchNameInput")  
  BranchName = Excel.Cells(b,31)
  'Branchnm.ClickItem(Branchname)  
  Call ObjPropertyFindSelect("idStr","branchNameInput","Select",Branchname)
  AccType = Excel.Cells(b,32)
  'Set Accntype = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Select("accountTypeInput")
  'Accntype.ClickItem(AccType)
  Call ObjPropertyFindSelect("idStr","accountTypeInput","Select",AccType)
 ' Set textbox = panel.textboxBranchNumber
'  Set Branchnumber = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Textbox("branchNumberInput")
  BranchNum = Excel.Cells(b,33) 
 ' Branchnumber.SetText(BranchNum)
  Call ObjPropertyFindSelect("idStr","branchNumberInput","Select",BranchNum)
 ' Set Accnumb = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Textbox("accountNumberInput")
  AccNo = Excel.Cells(b,34) 
 ' Accnumb.SetText(AccNo)
  Call ObjPropertyFindEnterText("idStr","accountNumberInput","INPUT",AccNo)
  'Click the Update Button on the Banking Details
  'Set BankingDet = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonBankingDetails")
  'BankingDet.Click
  Call  ObjPropertyFindClick("idStr","updatePersonBankingDetails", "Button")  

  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
 
  Aqutils.Delay 2000
  'Tax Section
 ' Set TaxDetai = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(0).Panel(0).Panel(0).Panel(0)
 ' Aqutils.Delay 2000
 ' TaxDetai.Click
  Aqutils.Delay 2500
  Call  ObjPropertyFindClick("contentText","Tax details", "DIV") 
  Aqutils.Delay 3000
  'Assign TaxPayer is Yes or Not
  Taxpay = Excel.Cells(b,36) 
  
  IF Taxpay = "Yes" Then
  ' Set TaxPayerYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Label(0)
  ' TaxPayerYes.Click
   Call  ObjPropertyFindClick("htmlFor","saTaxPayer_Yes", "LABEL") 
   
   'Set IncomeTaxPayer = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Textbox("sarsTaxReferenceInput")
   TaxRef = Excel.Cells(b,37)  
   'IncomeTaxPayer.SetText(TaxRef) 
   Call ObjPropertyFindEnterText("idStr","sarsTaxReferenceInput","INPUT",TaxRef)
   
   ElseIf Taxpay = "No" Then
  ' Set TaxPayerNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Label(0)
  ' TaxPayerNo.Click
   Call  ObjPropertyFindClick("htmlFor","saTaxPayer_No", "LABEL")    
  End IF
   'Check to see if another Country has to be added
         AddAnotherCount = Excel.Cells(b,38) 
        IF AddAnotherCount = "Yes" THEN
         'Click the Add Another Country Button
         Call AddAnotherCountry()
        END IF
        
           If AddAnotherCount = "Yes" And Taxpay = "Yes" Then
           DTaxExempt = Excel.Cells(b,39)
                      
                If DTaxExempt = "No" Then           
                'Set TaxExamptionNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(1).Label(0)
                Call  ObjPropertyFindClick("htmlFor","qualifyForDividendWithholding_no", "LABEL") 
                'TaxExamptionNo.Click                
                End If
                
               DReducedRate = Excel.Cells(b,40)          
               If DReducedRate = "No" Then          
                'Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=c64714d6-fa1b-48dd-b101-3fae0a84a270#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(1).Label(0)        
               'Set TaxReducedRateNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).Panel(0).Panel(1).Label(0)
               'TaxReducedRateNo.Click
               Call  ObjPropertyFindClick("htmlFor","qualifyForReducedRateInDividendWithholdingTax_no", "LABEL")
               
               End IF
               aqUtils.Delay 1500
          
          End If
          
          'Check to see if the Tax is Yes and Country is No
          If AddAnotherCount = "No" And Taxpay = "Yes" Then
          '
         ' Set TaxExamptionNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Panel(1).Label(0)
         ' TaxExamptionNo.Click
           Call  ObjPropertyFindClick("htmlFor","qualifyForDividendWithholding_no", "LABEL")
         ' Set TaxReducedRateNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(1).Panel(0).Panel(1).Label(0)
         ' TaxReducedRateNo.Click
          Call  ObjPropertyFindClick("htmlFor","qualifyForReducedRateInDividendWithholdingTax_no", "LABEL")
          End If
          'Check to see if the Tax is No and Country is Yes
          If AddAnotherCount = "Yes" And Taxpay = "No" Then
            
            'Set ExemptionQualifyYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Panel(0).Label(0)
            'ExemptionQualifyYes.Click
            Call  ObjPropertyFindClick("htmlFor","qualifyForDividendWithholding_yes", "LABEL")
            
            aqUtils.Delay 1500
            'Interest Witholding Tax Section
            'Set ExemptiQualifyYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(0).Label(0)
            'ExemptiQualifyYes.Click
            Call  ObjPropertyFindClick("htmlFor","qualifyForInterestWithholding_yes", "LABEL")
            
            'Reason for Exemption
            'Set ExemptReason = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).Panel(0).Panel(0).Select("reasonForExceptionInInterestWithholdingTax")
            'ExemptReason.ClickItem(1)
            Dim ExemptReason
            ExemptReason = "F: s50D(3)(a) – Physical present 183+days in aggregate during preceding 12 months"
            Call ObjPropertyFindSelect("idStr","reasonForExceptionInInterestWithholdingTax","Select",ExemptReason)
            
          End If
          
   'Click the Update Button on the Tax Details Section
  ' Set BtnUpdate1 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonTaxDetails") 
  ' BtnUpdate1.Click
   Call  ObjPropertyFindClick("idStr","updatePersonTaxDetails", "Button")
   aqUtils.Delay 2500
   'Click the Product Details Button
   'Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=f8bdebcb-007d-45b0-9eb2-bdf31c933083#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("productDetails")
   'Set BtnProductDetails = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("productDetails")
   'BtnProductDetails.Click
    Call  ObjPropertyFindClick("idStr","productDetails", "BUTTON")
  
   

  Result = "pass"
  Reason = "Passed Capturing Personal Details "
  Else
  'Log the ProcessId
  Call GetProcessid()
  Result = "fail" 
  Reason = "Failed Capturing Personal Details"
  End If    
End Function

'Author JM Kekana
'The aim of this function is to add another country on the Tax Section
Function AddAnotherCountry()

' Set BTNAddCountry = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Panel(0).Button(0)
' BTNAddCountry.Click
 
 ' Set page = Sys.Browser("iexplore").Page(CurrentURL)  
 ' Set btnAddAnother = page.NativeWebObject.Find("contentText", "Add another country", "Button")
  'btnAddAnother.Click 
  Call  ObjPropertyFindClick("contentText","Add another country", "BUTTON")  
  
  ' Find and click the "Products" link
 ' Set SelectObj = page.NativeWebObject.Find("idStr", "countryInput_0", "Select")
  'SelectObj.ClickItem("Zimbabwe") 
  Call ObjPropertyFindSelect("idStr","countryInput_0","Select","Zimbabwe")

 ' Set TIN = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Form(0).Panel(1).Panel(0).Textbox("taxNumberInput_0")
 'Check to see if the correct Panel is loaded if Tax Payer is Yes
 
' If TIN.Exists Then
' Call ObjPropertyFindEnterText("idStr","taxNumberInput_0","INPUT","123456667")
 'TIN.SetText("1234567") 
 'Sys.HighlightObject TIN      
 'Set NoCitizen = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Form(0).Panel(2).Panel(1).Label(0)
 'Set YesCitizen = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Form(0).Panel(2).Panel(0).Label(0)
 'YesCitizen.Click
' Call  ObjPropertyFindClick("contentText","Add another country", "Label")
         
' Set NoPrimaryTax = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Form(0).Panel(3).Panel(1).Label(0) 
' NoPrimaryTax.Click
' Else 
 'Set TINInput = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Form(0).Panel(1).Panel(0).Textbox("taxNumberInput_0")
 'TINInput.SetText("123456799999")
 Call ObjPropertyFindEnterText("idStr","taxNumberInput_0","INPUT","123456799999")
 
' Set CitizenOfCountryYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Form(0).Panel(2).Panel(0).Label(0)
' CitizenOfCountryYes.Click
 Call  ObjPropertyFindClick("htmlFor","citizenTypeRadiosYes_0", "LABEL")  
 
 'Set PrimaryTaxCountryNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Form(0).Panel(3).Panel(1).Label(0)
 
 'PrimaryTaxCountryNo.Click
' Set PrimaryTaxCountryYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Form(0).Panel(3).Panel(0).Label(0)
' PrimaryTaxCountryYes.Click
 Call  ObjPropertyFindClick("htmlFor","primaryTaxCountryRadiosTrue_0", "LABEL") 
' End If 
End Function
'Author JM Kekana
'The aim of the function is to validate that Quote Data is displayed on NBC from Client Details and Contact Details
'We check the Name, IdNo, Initial, Surname, Email 
Function ValidateQuoteDataNBC(Byval section)

'Check to see which part do we want to validate Personal Details Or contacts
IF section = "Personal" Then
     'Assigning Personal Details 
     ' Set InitialCheck = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Textbox("initialsInput")
      InitialCheckval = ObjPropertyFindGetText("idStr","initialsInput", "INPUT")
     ' InitialCheckval = aqObject.GetPropertyValue(InitialCheck, "wText")

      'Set FnameCheck = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Textbox("fullNamesInput")
      FnameCheckval = ObjPropertyFindGetText("idStr","fullNamesInput", "INPUT")
      'FnameCheckval = aqObject.GetPropertyValue(FnameCheck, "wText")

     ' Set SurnameCheck = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("surnameInput")
      SurnameCheckval = ObjPropertyFindGetText("idStr","surnameInput", "INPUT")
     ' SurnameCheckval = aqObject.GetPropertyValue(SurnameCheck, "wText")

      'Set IdNoCheck = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Textbox("idNumberInput")
      IdNoCheckval = ObjPropertyFindGetText("idStr","idNumberInput", "INPUT")
      'IdNoCheckval = aqObject.GetPropertyValue(IdNoCheck, "wText") 


     ' MsgBox GlobalInitial &"-"&InitialCheckval &"-"&GlobalLname&"-"&SurnameCheckval&"-"&GlobalFName&"-"&FnameCheckval&"5"&GlobalID&"6"&IdNoCheckval
      If (GlobalInitial = InitialCheckval) And (GlobalLname = SurnameCheckval) And (GlobalFName = FnameCheckval) And (GlobalID = IdNoCheckval) Then
       ' Sys.HighlightObject IdNoCheck
        Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "VerifyQuotePersonalDetailsMatchNBC") 
       ' MsgBox "Matched Personal Details Found"        
      Else 
        Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "VerifyQuotePersonalDetailsNotMatchNBC")
        'MsgBox "Not Found Personal Details"
      End If
End IF    

'Here we want to check if we are on the contacts section and validate our data
IF section = "Contact" Then
      'Contact Details Section - Email and Cell No
     ' Set CellNoCheck = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("cellPhone")
      CellNoCheckval = ObjPropertyFindGetText("idStr","cellPhone", "INPUT")
     ' CellNoCheckval = aqObject.GetPropertyValue(CellNoCheck, "wText")

      'Set EmailCheck = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).EmailInput("email")
      EmailCheckval = ObjPropertyFindGetText("idStr","email", "INPUT")
     ' EmailCheckval = aqObject.GetPropertyValue(EmailCheck, "wText")

      IF GloabalContacts = CellNoCheckval And GlobalEmailAddress = EmailCheckval Then
         'Sys.HighlightObject CellNoCheck 
         Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "VerifyQuoteContactDetailsMatchNBC")
        ' MsgBox "Matched Contact Details Found"
      Else
         Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "VerifyQuoteContactDetailsNotMatchNBC")
         'MsgBox "Not Found Contact Details"
      End IF
End IF 
End Function

Sub Test45
Dim MyStr, Char, NewStr, x, y

joe =  InputBox("Enter the String")

MyStr = joe'"Take it back"

y = Len(MyStr)

For x = y To 1 Step -1
    Char = Mid(MyStr,x,1) 
    'MsgBox Char  
    NewStr = NewStr & Char
   
Next
 MsgBox NewStr
End Sub
'Author JM Kekana
'The aim of this function is to extract the Process ID from the current URL
Function GetProcessid()
'Assign current URL
strURL = CurrentURL  
'MsgBox str 
'Dim str1(1)
'str1(0)  = split(str,"quote/")

strright = Right(strURL,25)
'str1(0) = str3(0) 
'str1(1) = str3(1)
'str2 = str1(1)
'MsgBox str1(0)
'MsgBox str1(1)
if IsEmpty(strright) Then
str2 = "No process ID returned"
Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", str2)
Else 
str2 = strright
Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", str2&"_ProcessId")  
End IF

GetProcessid = str2
GlobaProcessId = str2
End Function

'Author JM Kekana
'This function is for doing validations on whether the status has changed properly on Task List
'We pass the Status as an arguement - Completed or In Progress depending where we are at in the process.
Function ValidateQuoteStatus(Byval State)
aqUtils.Delay 5000
'Click the Investor Link
'Set InvestorLink = Sys.Browser("iexplore").Page(CurrentURL).Nav("top").Panel(1).Panel(0).Panel(0).Link(0)
'InvestorLink.Click
Call  ObjPropertyFindClick("contentText","Investors", "A")

aqUtils.Delay 2500
'Set TaskListLink = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(1).Panel("tasksPanel").Panel(1).Table(0).Cell(0, 0)
'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(1).Panel(1).Panel(1).Table(0).Cell(0, 0)
'TaskListLink.Click 
Call  ObjPropertyFindClick("idStr","tasksLink", "TD")

aqUtils.Delay 2000
IF State = "Progress" THEN

   Set QuickSearch = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox(0)
                    ' Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox(0)
   ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(2).Panel("showAdvanced")
  'Old Object Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox(0)
  'Search using the Unique Name that was used to create the Quote
   QuickSearch.Keys(UniqueName)
   QuickSearch.Click
   aqUtils.delay 2000

   Set Tasks = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(1).Panel(1).Table(0).Cell(1, 3)
   TaskValue = aqObject.GetPropertyValue(Tasks, "innerText")

   Set Status = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(1).Panel(1).Table(0).Cell(1, 4)
   Statusvalue = aqObject.GetPropertyValue(Status, "innerText")

   Set ContractNumber = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(1).Panel(1).Table(0).Cell(1, 1)
   ContractNumbervalue = aqObject.GetPropertyValue(ContractNumber, "innerText")
   'Assign the contract number to the Global Variable Value
   GlobalContractNumber = ContractNumbervalue

              IF Statusvalue = "In Progress" AND ContractNumbervalue <> "" AND TaskValue = "New Business Application"  THEN
                    'Click the row that's returned from search
                     Sys.HighlightObject Status
                     Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", ContractNumbervalue&"ContractNumber")
                     'Write The Contract number to a Text File
                      Status.Click     
                      aqUtils.Delay 1500
                      TaskDetailsScreen  = ObjPropertyFind("contentText","Task Details","H4")
                      'Check to see if the Task Details Screen is displayed
                      IF TaskDetailsScreen = True Then
                     
                         Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "TaskDetailsScreenFound") 
                         'btnOpen.Click
                         Call  ObjPropertyFindClick("contentText","Open", "Button")
                       Else
                         Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "TaskDetailsScreenNotFound")     
                       End IF
         
               Else
                 Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", ContractNumbervalue&"StatusNot-In-progress")    
               End IF
               
'Check to see if the state is in a Completed State
ElseIF State = "Completed" Then
             'Click the Advance Search Button
             'Old Object Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(2).Panel(0)
             'Set btnAdvancedSearch = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(2).Panel("showAdvanced")
              'btnAdvancedSearch.Click
              Call  ObjPropertyFindClick("contentText","Advanced search", "SPAN")
              
              aqUtils.Delay 4000

              ' Call ObjPropertyFindSelect("ObjectLabel", "Compliance option", "Select","Completed")

              Set QuickSearch = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox(0)
              'Search using the Unique Name that was used to create the Quote
              QuickSearch.Keys(GlobalContractNumber)
              QuickSearch.Click
              aqUtils.delay 4000
        
              Set Tasks = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(1).Panel(1).Table(0).Cell(1, 3)
              TaskValue = aqObject.GetPropertyValue(Tasks, "innerText")

              Set Status = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(1).Panel(1).Table(0).Cell(1, 4)
              Statusvalue = aqObject.GetPropertyValue(Status, "innerText")

              Set ContractNumber = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel(1).Panel(1).Table(0).Cell(1, 1)
              ContractNumbervalue = aqObject.GetPropertyValue(ContractNumber, "innerText")
        
               aqUtils.delay 2500
               If Statusvalue = "In Progress" AND ContractNumbervalue <> "" AND TaskValue = "New Business Application"  Then
                    'Click the row that's returned from search
                    Sys.HighlightObject Status
                    Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", ContractNumbervalue&"-ContractNumber_Completed")
                    'Write The Contract number to a Text File
                     Status.Click 
                     aqUtils.Delay 2500
                     Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", ContractNumbervalue&"-TaskDetails")
                     'Click the Open Button
                     Call  ObjPropertyFindClick("contentText","Open", "Button")
                     Aqutils.delay 1500
                     
                     'Close The Task Details Screen
                     'Call ObjPropertyFindClick("contentText", "Close", "Button")
                       'Check to see if the Application has already been submitted
                       SubmitStatus = ObjPropertyFind("contentText","Application has already been submitted.","DIV")

                         IF SubmitStatus = True Then
                     
                         Result = "pass"
                         Reason = "Application_In_Submitted_Status"
                         Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", ContractNumbervalue&"-ContractNumber_In_Progress_Submitted")
                         Else 
                         Result = "fail"
                         Reason = "Application_Not_In_Submitted_Status"
                         Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", ContractNumbervalue&"-ContractNumber_Not_In_Progress_Submitted")
                         End IF
                     
               Else 'If Status is not Completed
                    ' Sys.HighlightObject Status
                     Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", ContractNumbervalue&"-StatusNotCompleted") 
                     Result = "fail"
                     Reason = "Application_Not_In_Progress_Status"
               End If
        
End IF
End Function
 

Function TaxDetails(Byval val, Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("TaxDetails").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
 ' Set button = section.buttonCreateAndLoadProcess
 ' Set obj = Aliases.browser.pageNewBusinessCapture2.section.buttonCreateAndLoadProcess.textnodeView
 Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click
'  Set tst1 = obj.Find("sourceIndex","103", 2)
'  tst1.Click
  'Call button.textnodeView.Click
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  if panel.selectTitle.Exists Then
  
  'Call panel.selectTitle.ClickItem(Title)
  Set textbox = panel.panelColSm3.textboxInitials
 ' Call textbox.Click(34, 26)
  'Call textbox.SetText(Initials)
  'Call textbox.Keys("[Tab]")
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  'Call textbox2.SetText(Fullname)
  'Call textbox2.Keys("[Tab]")
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  'Call textbox2.SetText(PreferName)
  'Call textbox2.Keys("[Tab]")
  'Call textbox.Click(28, 8)
  'Call textbox.SetText("J")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  'Call textbox.Click(99, 34)
  'Call textbox.SetText(Surname)
  'Call form.buttonRsaIdNumber.Click(11, 11)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  'Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  'Call textbox.Click(220, 16)
  'Call textbox.Keys("[Up]")
  'Call textbox.SetText("")
  'Call textbox.Keys("[Home]")
  'Call textbox.SetText(Idnumber)
  Set button2 = form.buttonSouthAfrican
  'Call button2.Click(9, 10)
  'Call form.buttonNonSouthAfrican.Click(18, 10)
  'Call button2.Click(8, 3)
  'Call form.radiobuttonFemale.Click(18, 5)
  'Call form.buttonMale.Click(16, 8)
  'Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  'Call form2.buttonNo.Click(12, 9)
  'Call form2.buttonYes.Click(6, 11)
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  'Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  'Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  'Call browser2.Drag(1359, 282, 6, 89)
  'Call button.Click(53, 17)
  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
  '   UpdateBtn.Click
      
  'Call browser2.Drag(1360, 374, 5, 176)
  Set panel6 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  'Call panel6.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(835, 29)
  Set button2 = form.buttonEnglish
  'Call button2.Click(15, 15)
  'Call form.buttonAfrikaans.Click(6, 21)
  'Call button2.Click(11, 17)
  'Call panel.buttonPost.Click(13, 22)
  'Call panel2.buttonEmail.Click(15, 13)
  'Call browser2.Drag(1358, 233, 7, 101)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
'  Call textbox.Click(226, 31)
  'Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Call textbox.Click(22, 25)
  'Call textbox.SetText(TelH)
  'Call form.Click(308, 243)
  Set textbox = panel4.panelColSm4.textboxCellphone
  'Call textbox.Click(125, 22)
  'Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  'Call textbox.Click(42, 22)
  'Call textbox.SetText(Fax)
  Set panel = form.panelFormGroup5.panelColSm4
  Set emailInput = panel.emailinputEmail
  'Call emailInput.Click(240, 16)
  'Call emailInput.SetText(Email)
  'Call browser2.Drag(1357, 335, 8, 145)
  'The Adress Section
  
  'Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.Click(12, 11)
  Set form2 = form.formFormNgUntouchedNgPristineN2
  Set textbox = form2.panelFormGroup.panelColSm8.textboxLine1
  'Call textbox.Click(220, 15)
  Line1 = Excel.Cells(b,21)  
  'Call textbox.SetText(Line1)
  Set textbox = form2.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox.Click(132, 5)
  Line2 = Excel.Cells(b,22)
  'Call textbox.SetText(Line2)
  Set textbox = form2.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox.Click(82, 31)
  Line3 = Excel.Cells(b,23)
  'Call textbox.SetText(Line3)
  Set textbox = form2.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox.Click(44, 20)
  City = Excel.Cells(b,24)
  'Call textbox.SetText(City)
  Set textbox = form2.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox.Click(26, 25)
  PostCode = Excel.Cells(b,25)
  'Call textbox.SetText(PostCode)
  Set textbox = form2.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox.Click(5, 36)
  Province = Excel.Cells(b,26)
  'Call textbox.SetText(Province)
  'Call browser2.Drag(1361, 430, 3, 67)
  Set vselect = form2.selectCountry
  Country = Excel.Cells(b,27)
  'Call vselect.ClickItem(Country)
 ' Call vselect.ClickItem("Select..")
  'Have to get the Full Name
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  'Call button.Click(28, 21)
'  Call browser2.Drag(1356, 417, 6, 90)
  'This is the banking Section
'  Call panel6.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Click(561, 27)
'  Call browser2.Drag(1359, 292, 6, 112)
  Set vselect = form.selectAccountHolderRelationship
  AccHolder = Excel.Cells(b,31)
'  Call vselect.ClickItem(AccHolder)
  Set vselect = panel2.selectBankName
  BankName = Excel.Cells(b,32)
'  Call vselect.ClickItem(BankName)
  Set vselect = form.selectBranchName
  'Call vselect.ClickItem("Select...")
  BranchName = Excel.Cells(b,33)
'  Call vselect.ClickItem(Branchname)
  AccType = Excel.Cells(b,34)
'  Call form.selectAccountType.ClickItem(AccType)
  Set textbox = panel.textboxBranchNumber
  BranchNum = Excel.Cells(b,35) 
'  Call textbox.SetText(BranchNum)
  'AccNo = Excel.Cells(b,34) 
  Set textbox = panel5.textboxAccountNumber
  'Call textbox.Click(156, 7)
  AccNo = Excel.Cells(b,36) 
'  Call textbox.SetText(AccNo)
'  Call browser2.Drag(1356, 500, 6, 96)
  'Have to get the Button Fullname
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  'Call button.Click(29, 18)
 ' Call browser2.Drag(1360, 380, 5, 114)
  'Banking Section
  Call panel6.panelPanelPanelDefault3.panelPanelHeading.panelTaxDetails.Click(1052, 13)
  Call browser2.Drag(1357, 395, 8, 119)
  Call form.buttonNo.Click(9, 8)
  Set button2 = form.buttonYes
  Call button2.Click(15, 10)
  Call button2.HoverMouse(15, 11)
  Set textbox = panel2.textboxSarsTaxReference
  'Call textbox.Click(29, 11)
  TaxRef = Excel.Cells(b,4)
  Call textbox.SetText(TaxRef)
  Call browser2.Drag(1361, 379, 3, 145)
  Call form.buttonNo2.Click(10, 6)
  Call panel4.buttonNo.Click(13, 13)
  'Click the No Button on the Tax Details
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Form(0).Panel(0).Panel(1).Label(0).Click
  
  'Click the Object Using the FullName 
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  
 ' Call button.Click(57, 10)
  Call browser2.Drag(1357, 486, 2, 32)
  'Have to click the Product Details Update Button
  '
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonTaxDetails").Click
  
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click  
  'Call button.Click(49, 13)
  Set btn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(0).TextNode(0)
  
  If btn.Exists Then
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(1).Click  
  End IF
  
  Result = "pass"
  Else
  Result = "pass"
  End If    
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")
End Function

Function Banking(Byval val, Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set button = section.buttonCreateAndLoadProcess
 ' Set obj = Aliases.browser.pageNewBusinessCapture2.section.buttonCreateAndLoadProcess.textnodeView
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click
'  Set tst1 = obj.Find("sourceIndex","103", 2)
'  tst1.Click
  'Call button.textnodeView.Click
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  if panel.selectTitle.Exists Then
  
  Set textbox = panel.panelColSm3.textboxInitials
 
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  'Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  'Call textbox.Click(220, 16)
  'Call textbox.Keys("[Up]")
  'Call textbox.SetText("")
  'Call textbox.Keys("[Home]")
  'Call textbox.SetText(Idnumber)
  Set button2 = form.buttonSouthAfrican
  'Call button2.Click(9, 10)
  'Call form.buttonNonSouthAfrican.Click(18, 10)
  'Call button2.Click(8, 3)
  'Call form.radiobuttonFemale.Click(18, 5)
  'Call form.buttonMale.Click(16, 8)
  'Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  'Call form2.buttonNo.Click(12, 9)
  'Call form2.buttonYes.Click(6, 11)
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  'Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  'Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  'Call browser2.Drag(1359, 282, 6, 89)
  'Call button.Click(53, 17)
  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
   '   UpdateBtn.Click
      
  'Call browser2.Drag(1360, 374, 5, 176)
  Set panel6 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  'Call panel6.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(835, 29)
  Set button2 = form.buttonEnglish
  'Call button2.Click(15, 15)
  'Call form.buttonAfrikaans.Click(6, 21)
  'Call button2.Click(11, 17)
  'Call panel.buttonPost.Click(13, 22)
  'Call panel2.buttonEmail.Click(15, 13)
  'Call browser2.Drag(1358, 233, 7, 101)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
'  Call textbox.Click(226, 31)
  'Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Call textbox.Click(22, 25)
  'Call textbox.SetText(TelH)
  'Call form.Click(308, 243)
  Set textbox = panel4.panelColSm4.textboxCellphone
  'Call textbox.Click(125, 22)
  'Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  'Call textbox.Click(42, 22)
  'Call textbox.SetText(Fax)
  Set panel = form.panelFormGroup5.panelColSm4
  Set emailInput = panel.emailinputEmail
  'Call emailInput.Click(240, 16)
  'Call emailInput.SetText(Email)
  'Call browser2.Drag(1357, 335, 8, 145)
  'The Adress Section
  
  'Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.Click(12, 11)
  Set form2 = form.formFormNgUntouchedNgPristineN2
  Set textbox = form2.panelFormGroup.panelColSm8.textboxLine1
  'Call textbox.Click(220, 15)
  Line1 = Excel.Cells(b,21)  
  'Call textbox.SetText(Line1)
  Set textbox = form2.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox.Click(132, 5)
  Line2 = Excel.Cells(b,22)
  'Call textbox.SetText(Line2)
  Set textbox = form2.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox.Click(82, 31)
  Line3 = Excel.Cells(b,23)
  'Call textbox.SetText(Line3)
  Set textbox = form2.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox.Click(44, 20)
  City = Excel.Cells(b,24)
  'Call textbox.SetText(City)
  Set textbox = form2.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox.Click(26, 25)
  PostCode = Excel.Cells(b,25)
  'Call textbox.SetText(PostCode)
  Set textbox = form2.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox.Click(5, 36)
  Province = Excel.Cells(b,26)
  'Call textbox.SetText(Province)
  'Call browser2.Drag(1361, 430, 3, 67)
  Set vselect = form2.selectCountry
  Country = Excel.Cells(b,27)
  'Call vselect.ClickItem(Country)
 ' Call vselect.ClickItem("Select..")
  'Have to get the Full Name
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  'Call button.Click(28, 21)
'  Call browser2.Drag(1356, 417, 6, 90)
  'This is the banking Section
  Call panel6.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Click(561, 27)
  Call browser2.Drag(1359, 292, 6, 112)
  Set vselect = form.selectAccountHolderRelationship
  AccHolder = Excel.Cells(b,31)
  Call vselect.ClickItem(AccHolder)
  Set vselect = panel2.selectBankName
  BankName = Excel.Cells(b,32)
  Call vselect.ClickItem(BankName)
  Set vselect = form.selectBranchName
  'Call vselect.ClickItem("Select...")
  BranchName = Excel.Cells(b,33)
  Call vselect.ClickItem(Branchname)
  AccType = Excel.Cells(b,34)
  Call form.selectAccountType.ClickItem(AccType)
  Set textbox = panel.textboxBranchNumber
  BranchNum = Excel.Cells(b,35) 
  Call textbox.SetText(BranchNum)
  'AccNo = Excel.Cells(b,34) 
  Set textbox = panel5.textboxAccountNumber
  'Call textbox.Click(156, 7)
  AccNo = Excel.Cells(b,36) 
  Call textbox.SetText(AccNo)
'  Call browser2.Drag(1356, 500, 6, 96)
  'Have to get the Button Fullname
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonBankingDetails").Click
  
  'Call button.Click(29, 18)
  
  Set btn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(0).TextNode(0)
  
 ' If btn.Exists Then
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(1).Click  
 ' End IF
  
  Result = "pass"
  Else
  Result = "pass"
  End If   
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/") 
End Function
'Author JM Kekana
'This function is for capturing the Product details
Function ProdDetails(Byval test, Byval env, Byval ProdType)
  
  Dim Process
  Excel.WorkSheets("RolePlayer").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     ProcessId = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  
  'Get the value of the Contribution Payer from Excel
  ContributePayer = Excel.Cells(b,2)
  IF ContributePayer = "No" THEN

  Call  ObjPropertyFindClick("htmlFor","isInvestorContributorNo", "Label")
  aqUtils.Delay 5000
  'Call the Contribution Payer Details Section Function
  Call ContributionDetails(test,env)
  'Activate The Role Player Sheet 
  Excel.WorkSheets("RolePlayer").Activate
  ELSE
  'Contribution Payer = Yes
  Call  ObjPropertyFindClick("htmlFor","isInvestorContributorYes", "Label")
  End IF
  

  Call ObjPropertyFindClick("contentText","Investment details","DIV")  
  aqUtils.Delay 1500
  
  Sourceincome = Excel.Cells(b,3)
  
'  Set SourceofInc = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Select("incomeSourceInput_0")
  if Sourceincome = "Employed" Then
  'SourceofInc.ClickItem("Employed") 
  Call ObjPropertyFindSelect("idStr","incomeSourceInput_0","Select","Employed") 
  'Set NameOfEmployer = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
  'NameOfEmployer.SetText("Momentum")
  Call ObjPropertyFindEnterText("idStr","incomeSourceEmployerNameInput_0","INPUT","Momentum")
  ElseIF Sourceincome = "Unemployed" Then
  Call ObjPropertyFindSelect("idStr","incomeSourceInput_0","Select","Unemployed") 
 ' SourceofInc.ClickItem("Unemployed")
  ElseIf Sourceincome = "Self-employed" Then
  Call ObjPropertyFindSelect("idStr","incomeSourceInput_0","Select","Self-employed")
  Call ObjPropertyFindEnterText("idStr","incomeSourceBusinessNameInput_0","INPUT","Business Trading")
  ElseIf Sourceincome = "Other" Then
 ' SourceofInc.ClickItem("Other")
  Call ObjPropertyFindSelect("idStr","incomeSourceInput_0","Select","Other")
  Call ObjPropertyFindEnterText("idStr","incomeSourceOtherSourceInput_0","TEXTAREA","Other Business Interest")
  End If
  
  SourceFunds = Excel.Cells(b,5)
  If SourceFunds = "Salary/Remuneration" Then   
  'SourceOffunds.ClickItem("Salary/Remuneration")
  'Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Salary/Remuneration")
  Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Salary/Remuneration")
  aqUtils.delay 0500
  Call ObjPropertyFindEnterText("idStr","moneySourceEmployerNameInput_0","INPUT","Momentum Retail")
 
  ElseIf SourceFunds = "Self-employed" Then
  Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Self-employed")
  'SourceOffunds.ClickItem("Self-employed")
  aqUtils.delay 0500
  Call ObjPropertyFindEnterText("idStr","moneySourceBusinessNameInput_0","INPUT","Manufacturing")
  ElseIF SourceFunds = "Business Transaction"  Then
  Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Business Transaction")
  'SourceOffunds.ClickItem("Business Transaction")
  aqUtils.delay 0500
  Call ObjPropertyFindEnterText("idStr","moneySourceNatureOfBusinessInput_0","INPUT","Business Transaction")
  'Set BizTransaction = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("natureOfBusinessInput_0")
  'BizTransaction.SetText("Finance Transaction")
  ElseIf SourceFunds = "Investment" Then
  'SourceOffunds.ClickItem("Investment")
   Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Investment")
  'SourceOffunds.ClickItem("Business Transaction")
  aqUtils.delay 0500
   Call ObjPropertyFindEnterText("idStr","moneySourceCapitalSourceInput_0","INPUT","Investment")
   aqUtils.delay 0500
 ' Set capitalsource = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("capitalSourceInput_0")
 ' capitalsource.SetText("Loan Amount") 
   ElseIF SourceFunds = "Savings" Then
  'SourceOffunds.ClickItem("Savings")
   Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Savings")
  'SourceOffunds.ClickItem("Business Transaction")
  aqUtils.delay 0500
  Call ObjPropertyFindEnterText("idStr","moneySourceSavingsOriginInput_0","INPUT","SAvings Amount")
  aqUtils.delay 0500
  'Set Savings = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("savingsOriginInput_0")
  'Savings.SetText("Savings Amount")
  ElseIf SourceFunds = "Inheritance" Then
 ' SourceOffunds.ClickItem("Inheritance")
   Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Inheritance")
  'SourceOffunds.ClickItem("Business Transaction")
  aqUtils.delay 0500
  Call ObjPropertyFindEnterText("idStr","moneySourceDeceasedEstateNameInput_0","INPUT","Inheritance from estate")
  aqUtils.delay 0500
  ElseIF SourceFunds = "Other" Then
  'SourceOffunds.ClickItem("Other")
   Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Other")
  'SourceOffunds.ClickItem("Business Transaction")
  aqUtils.delay 0500
  Call ObjPropertyFindEnterText("idStr","moneySourceOtherSourceInput_0","Textarea","Other Source of Income")
  aqUtils.delay 0500
        ElseIF SourceFunds = "Winnings" Then
        Call ObjPropertyFindSelect("idStr","moneySourceInput_0","Select","Winnings")
       'SourceOffunds.ClickItem("Business Transaction")
        aqUtils.delay 0500
        Call ObjPropertyFindEnterText("idStr","moneySourceWinningsSourceInput_0","INPUT","Winnings from Casino")
        'Click select the date that you won - Past Date  
        Call PreviousDateSelect("datePickerButton_winningsDate_0")
        'This is for clicking on the screen after selecting date
        Call ObjPropertyFindClick("contentText","Anti-money laundering provisions: source of funds and income*","DIV")  
        aqUtils.delay 0500

 End IF 
  
  'Lump Sum Payment Section
  'SourceFunds = Excel.Cells(b,5
  'MethodofPay = "Direct deposit into Momentum's bank account"
  MethodofPay = Excel.Cells(b,6)
'  Set PaymentMethod = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(0).Select("paymentMethodInput")
  IF MethodofPay = "Direct deposit into Momentum's bank account" Then
  'PaymentMethod.ClickItem("Direct deposit into Momentum's bank account")
  Call  ObjPropertyFindSelect("idStr","paymentMethodInput","Select","Direct deposit into Momentum's bank account")
  ElseIF MethodofPay = "Electronic transfer to Momentum's bank account" Then
   Call  ObjPropertyFindSelect("idStr","paymentMethodInput","Select","Electronic transfer to Momentum's bank account")
  'PaymentMethod.ClickItem("Electronic transfer to Momentum's bank account")
  ElseIf MethodofPay = "Momentum must collect electronically" Then
  'PaymentMethod.ClickItem("Momentum must collect electronically")  
  Call  ObjPropertyFindSelect("idStr","paymentMethodInput","Select","Momentum must collect electronically")
 ' Set CollectDate = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(2).Panel(0).Panel(0).Panel(0).Textbox(0)
  'CollectDate.SetText("2017-12-15")
  'Set the date to a future date by clicking the date calendar
  'Set CalendarBtn = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(0).Panel(0).Panel(0).Button(0)
                  'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Panel(0).Panel(0).Button(0) 
  'CalendarBtn.Click

'  Set Nextbtn = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Table(0).Cell(0, 2).Button(0)
              'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Table(0).Cell(0, 2).Button(0)
 ' Nextbtn.Click 

'  Set ClickDate = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Table(0).Cell(2, 2).Button(0)
 ' ClickDate.Click 
  Call FutureDateSelect("datePickerButton_lumpSumCollectionDate")
  Call ObjPropertyFindClick("contentText","Anti-money laundering provisions: source of funds and income*","DIV")
  End IF 
  '                     Sys.Browser("iexplore").Page().Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).Panel(0).TextNode("lumpSumAmountInput")
  'Set LumpInvestAmnt = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).Panel(0).TextNode("lumpSumAmountInput")
  
  
  'Regular Investment Section########################################################################
  'Set RegularStartDate = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Panel(0).Panel(0).Textbox(0)  
  'CurrentRegularDate = aqObject.GetPropertyValue(RegularStartDate, "wText")
  'strdate = aqConvert.DateTimeToStr(Date)
  'MsgBox CurrentRegularDate
  'MsgBox strdate 
  'IF strdate = CurrentRegularDate Then
 ' MsgBox "Current Day's Date Found"
  'Set CalendarBtn = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Panel(0).Panel(0).Button(0) 
  'CalendarBtn.Click
  'End IF 

 'str =  aqDateTime.Compare(CurrentRegularDate,Date)
 'MsgBox str
'  Set CalendarBtn = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Panel(0).Panel(0).Button(0)
                  'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Panel(0).Panel(0).Button(0) 
 '  CalendarBtn.Click

'  Set Nextbtn = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Table(0).Cell(0, 2).Button(0)
              'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Table(0).Cell(0, 2).Button(0)
'  Nextbtn.Click 
  aqUtils.Delay 1500
 ' Nextbtn.Click

'  Set ClickDate = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Table(0).Cell(2, 2).Button(0)
 ' ClickDate.Click 
 
 ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Click
 ' RegularStartDate.Click
 ' RegularStartDate.SetText("2017-12-25")
 ' RegularStartDate.Click
 
  Call FutureDateSelect("datePickerButton_regularInvestmentCollectionDate")  
  Call ObjPropertyFindClick("contentText","Anti-money laundering provisions: source of funds and income*","DIV")
     'Set InvestAmount = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(1).Panel(0).TextNode("investmentAmountInput")
  
      'Unit Transfers Section
      GlobalTransfer = Excel.Cells(b,7)
      IF GlobalTransfer = "Yes" THEN           
         ' Set UnitTransferYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(0).Panel(0).Label(0)
         ' UnitTransferYes.Click 
         ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(0).Panel(0).Label(0).Click
         ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(0).Label(0).Click
          aqUtils.Delay 1500
          Call ObjPropertyFindClick("htmlFor","unitsTransferredYes","Label")
      ELSE
         ' Set UnitTransferNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(0).Panel(1).Label(0)        
         ' UnitTransferNo.Click
         ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Panel(1).Label(0).Click
         ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(0).Panel(1).Label(0).Click
          aqUtils.Delay 1500
          Call ObjPropertyFindClick("htmlFor","unitsTransferredNo","Label")
      END IF 
       
       'Click the Update Payment Details Button
       Call ObjPropertyFindClick("idStr","updatePaymentDetails","Button")
     ' Set BtnUpdateInvest = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePaymentDetails")
     ' BtnUpdateInvest.Click
      
      aqUtils.Delay 2000
  'Drawdown Details  'Click the Drawdown Details ##########################################################
  'Initials the PanelValue 
  Panelval = 0
'Set DrawDownDetails = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(0).Panel(0).Panel(0).Panel(0)
'Set FinanAdvDetailsPanel3 = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(0).Panel(0).Panel(0).Panel(0)
     'Check to see if the Drawdown screen exists
      Drawdown = ObjPropertyFind("contentText","Drawdown details", "DIV")

     IF Drawdown = True Then
      Call ObjPropertyFindClick("contentText","Drawdown details", "DIV") 
     ' MsgBox "Object Found"
      Call ObjPropertyFindClick("idStr","drawDownUpdate", "BUTTON")
      'Click the Update Button
      'Call ObjPropertyFindClick("contentText","Update", "BUTTON")
      
     End IF  
  
      'Click the Financial Adviser Details Screen
      FinancialAdviser = ObjPropertyFind("contentText","Financial adviser details", "DIV")
      IF FinancialAdviser = True Then
      'MsgBox "Object Found"
       Call ObjPropertyFindClick("contentText","Financial adviser details", "DIV") 
       'Validate the preferred financial adviser  
       InitialCheckval = ObjPropertyFindGetText("idStr","initialsInput", "INPUT")   
       
      ' Set FSPHouseCode = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Panel(0).Textbox("fspHouseCodeInput_0")
       FSPHouseCodeCheckval = ObjPropertyFindGetText("idStr","fspHouseCodeInput_0", "INPUT")
       'aqObject.GetPropertyValue(FSPHouseCode, "wText")
  
       'Set FinacialAdvisercode = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox("financialAdviserCodeInput_0")
       FinacialAdvisercodeCheckval = ObjPropertyFindGetText("idStr","financialAdviserCodeInput_0", "INPUT")
       'aqObject.GetPropertyValue(FinacialAdvisercode, "wText")
    
      ' Set MarketingAdviseCode = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(2).Panel(0).Panel(0).Textbox("marketingAdviserCodeInput")
       MarketingAdviseCodeCheckval = ObjPropertyFindGetText("idStr","marketingAdviserCodeInput", "INPUT")
       'aqObject.GetPropertyValue(MarketingAdviseCode, "wText")
            'Check to see if the Marketing AdviseCode is not Blank
'       MarketingAdviseCode.Click
          IF MarketingAdviseCodeCheckval <> "" And FSPHouseCodeCheckval <> "" THEN
            Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", MarketingAdviseCodeCheckval&"AdviseCodeFound") 
            Else
            Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "AdviseCodeNotFound")
          End IF          
          '          'Add Another Financial Advisor - Call the AddAnotherFA() Method
                     'GlobalTransfer = Excel.Cells(b,8)
                     AnotherFAAdviser = Excel.Cells(b,8)
                    IF AnotherFAAdviser = "Yes" Then
                     Call AddAnotherFA(Panelval)  
                    END IF
'''''''''''''''''''''''        
                  'Contact person at financial adviser's office  
                  'Set FName = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(2+1).Panel(0).Textbox("contactFullNameInput")
                  FNameCheckval = ObjPropertyFindGetText("idStr","contactFullNameInput", "INPUT")
                  'aqObject.GetPropertyValue(FName, "wText")
  
                  'Set SName = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(3+1).Panel(0).Textbox("contactSurnameInput")
                  SNameCheckval = ObjPropertyFindGetText("idStr","contactSurnameInput", "INPUT")
                  'aqObject.GetPropertyValue(SName, "wText")
    
                  'Set TelNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(4+1).Panel(0).PhoneInput("contactTelephoneInput")
                  TelNoCheckval = ObjPropertyFindGetText("idStr","contactTelephoneInput", "INPUT")
                  'aqObject.GetPropertyValue(TelNo, "wText")
    
                  'Set CellN = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(4+1).Panel(1).PhoneInput("contactCellphoneInput")
                  CellNCheckval = ObjPropertyFindGetText("idStr","contactCellphoneInput", "INPUT")
                  'aqObject.GetPropertyValue(CellN, "wText")
  
                  'Set EmailInput = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(5+1).Panel(0).Textbox("contactEmailInput")
                  EmailInputCheckval = ObjPropertyFindGetText("idStr","contactEmailInput", "INPUT")
                  'aqObject.GetPropertyValue(EmailInput, "wText")
                  'EmailInput.Click
                 'Check to see if the Contact Details are not blank
                 IF TelNoCheckval <> "" And  EmailInputCheckval <> "" And CellNCheckval <> "" And FNameCheckval <> "" And SNameCheckval <> "" Then
                   'Sys.HighlightObject EmailInput
                   Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "AdviserContactDetailsFound")
                 Else 
                    'Sys.HighlightObject EmailInput
                    Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "AdviserContactDetailsNotFound")
                 End IF  
  
             'Add the declaration section
    
             'DeclarationVal = "Yes"
              DeclarationVal = Excel.Cells(b,17)
                IF DeclarationVal = "Yes" THEN 
                    Call ObjPropertyFindClick("htmlFor","inv_Yes","Label")
                   ' Set DeclarationYes = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(0).Label(0)
                   ' DeclarationYes.Click
                ElseIf DeclarationVal = "No" THEN
                   'Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=8c00f02b-0c7d-429f-9281-050bb4ebcd90#!/tools/quote/59f9f08c50ce050100286a85").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(1).Label(0)
                   Call ObjPropertyFindClick("htmlFor","inv_No","Label")
                   'Set DeclarationNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Panel(7).Panel(1).Label(0)
                   'DeclarationNo.Click 
                End If
''''''''''''''''''''''''''''''''''          
                                
End IF  
      
  
  'Click the Update FA Button Section  
  aqUtils.Delay 2000
'  Set BtnUpdateFinAdvDetails = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(Panelval).Panel(1).Panel(0).Panel(0).Form(0).Button("updateFinancialAdviserDetails")
'  BtnUpdateFinAdvDetails.Click
  Call ObjPropertyFindClick("idStr","updateFinancialAdviserDetails","Button")
  BtnUpdateFinDetails =  ObjPropertyFind("idStr","updateFinancialAdviserDetails","Button")
  If BtnUpdateFinDetails = True Then
  Reason = "Product Details Captured"
  Else
  Reason = "Product Details Not Captured"
  End If
  aqUtils.Delay 2000
  'Click the Docuemnts Section
  
  Call ObjPropertyFindClick("idStr","documents","Button")
  
 End Function

'Author JM Kekana
'The aim of the function is to upload Documents
Function Documents(Byval test, Byval env)
'  Dim browser,browser2,section,form,panel,textbox,panel2, table,textNode, legend    
  
  Excel.WorkSheets("CaptureDocs").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     'ProcessId = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  
  Aqutils.Delay 5000
  'Check to see if the Generate Application Button has been enabled
Rem  Set BtnGen = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Button("generateApplication")
  '             Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Button("generateApplication")
 ' if BtnGen.Enabled Then
  '  Sys.HighlightObject BtnGen
 '   Else MsgBox "Object not enabled"
'  End If
  
  'Documents 
  'Documents name section
  'Investment proposal - download the doc
                      ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Table(0).Cell(1, 1).Link(0)
                      ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Panel(0).Table(0).Cell(1, 1).Link(0)
Rem  Set InvestProposal = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Panel(0).Table(0).Cell(1, 1).Link(0)
                      'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Table(0).Cell(1, 1).Link(0)
                       ' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(3).Panel(0).Table(0).Cell(1, 1).Link(0)
                       'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Table(0).Cell(1, 1).Link(0)
Rem  Set ScreenClick = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0)
                    'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0)
Rem  Call DownloadDoc(InvestProposal, ScreenClick, "InvestProposal")
  'InvestProposal.Click
  'Click the download node
  
  'Proposal brochure - download the doc
  'Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=dd1f0622-8f16-4c21-a28e-4fbffa641600#!/tools/quote/5a0018bfb78a7b0100e34e37").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Table(0).Cell(2, 1).Link(0)
Rem  Set ProposalBrochure = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Panel(0).Table(0).Cell(2, 1).Link(0)
                        'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Table(0).Cell(2, 1).Link(0)
                         'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(3).Panel(0).Table(0).Cell(2, 1).Link(0)
                        'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Table(0).Cell(2, 1).Link(0)
Rem  Call DownloadDoc(ProposalBrochure, ScreenClick,"ProposalBrochure")
  'ProposalBrochure.Click
  'Check to see if the Transfer of wealth has been set to Yes
  'Set TransferUnitTrust = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Panel(0).Table(0).Cell(3, 0)
  TransferUnitTrustlnk = ObjPropertyFind("idStr","unitsTransferredVoluntary240_dropdown_menu)","A")
  'IF GlobalTransfer = "Yes" And TransferUnitTrust = True Then
  IF TransferUnitTrustlnk = True Then 
     Call ObjPropertyFindClick("idStr","unitsTransferredVoluntary240_dropdown_menu","A")
     aqUtils.Delay 1500
     'Call the PDF Documents download document file 
     Call DownloadingPDFDocs()
  End IF
  
  'Documents to Share
  'Click Investment proposal                
  'Set InvePro = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Label(0)
  InvePro = ObjPropertyFind("contentText","Investment proposal","Label")  
  if InvePro = True Then
  Call ObjPropertyFindClick("contentText","Investment proposal","Label")
  End If
  'Click Application form
  'Set Appform = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(3).Panel(0).Label(0)
  Appform = ObjPropertyFind("contentText","Application form","Label")
  if Appform = True Then
  Call ObjPropertyFindClick("contentText","Application form","Label")
  End If  
  'Click proposal brochure
  'Set PropBroch = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(4).Panel(0).Label(0)
  PropBroch = ObjPropertyFind("contentText","Product brochure","Label")
  if PropBroch = True Then
  Call ObjPropertyFindClick("contentText","Product brochure","Label")
  End If
  'Click fund fact sheet
  'Set Funcfact = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(5).Panel(0).Label(0)
  Funcfact = ObjPropertyFind("contentText","Fund fact sheet","Label")
  if Funcfact = True Then
  Call ObjPropertyFindClick("contentText","Fund fact sheet","Label")
  End If
  
  'Set TransferUnitTrust = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(6).Panel(0).Label(0)
  TransferUnitTrust = ObjPropertyFind("contentText","Transfer of unit trusts (Wealth 240)","Label")
  IF TransferUnitTrust = True Then
  Call ObjPropertyFindClick("contentText","Transfer of unit trusts (Wealth 240)","Label")
  End IF 
  aqUtils.Delay 1000
  'Click the Send Button
  SendEmailButton  = ObjPropertyFind("idStr","sendDocuments","Button")
  IF SendEmailButton = True Then
  Call ObjPropertyFindClick("idStr","sendDocuments","Button")
  End IF 
  'Verify if the email has been sent successfully
  aqUtils.Delay 10000
   EmailSentSuccess = ObjPropertyFind("contentText","Successfully sent email","DIV")
    IF EmailSentSuccess = True Then
  'Log.Message "Email Success confirmation"
   Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "EmailSent")
    Else 
  'Log.Message "Email not sent error"
   Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "EmailNotSent")
  End IF 
  
  '''''
  aqUtils.Delay 7000
 
 'The Upload Section Click the Upload Section
 Call ObjPropertyFindClick("contentText","Upload","DIV")
 
 'Client Documents Section ########################################
 'Call the ClientDocs function to upload the Documents 
 'Check to see if the Contribution Payer is No
 If ContributePayer = "No" Then
 Call ClientDocs() 
 aqUtils.Delay 1000
 Call ContributionDocs()
 aqUtils.Delay 1000
 Call AdviceDocumentsContri(2)
 aqUtils.Delay 1000
 Call ComplianceContribution()

 Else 
 'Client Documents Section
  Call ClientDocs()
  aqUtils.Delay 1000
 'Advice Documents Section
   Call AdviceDocumentsContri(1)
   aqUtils.Delay 1000
  'Compliance Documents
  ' Call ComplianceDocs()
   Call ComplianceContribution()
 
 End If
   
 BtnReview = ObjPropertyFind("idStr","review","BUTTON") 
 IF BtnReview = True Then
 Reason = "Documents Uploaded"
 Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "BtnReviewClicked")
 'BtnReview.Click 
 Call ObjPropertyFindClick("idStr","review","BUTTON") 
 Else 
 Reason = "Documents Not Uploaded"
 Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "BtnReviewNotClicked")
 End if 
 
 End Function

 'Author JM Kekana
 'Aim of the function is to Enter text into the textbox 
Function ObjPropertyFindEnterText(Byval objProp,Byval objString, Byval objTag, Byval TextInput)
  Set page = Sys.Browser("iexplore").Page(CurrentURL)
  ' Find and click the "Products" link
  Set SelectObj = page.NativeWebObject.Find(objProp, objString, objTag)
 ' aqUtils.Delay 1000
  SelectObj.Click
  'Sys.HighlightObject SelectObj
  if TextInput = "Money Market Fund" Then
  SelectObj.Keys(TextInput)
  Else
  SelectObj.SetText(TextInput)
  End If
End Function   
  
 'Author JM Kekana
 'Aim of the function is to select option from the listbox
Function ObjPropertyFindSelect(Byval objProp,Byval objString, Byval objTag, Byval SelectItem)
  Set page = Sys.Browser("iexplore").Page(CurrentURL)
  ' Find and click the "Products" link
  Set SelectObj = page.NativeWebObject.Find(objProp, objString, objTag)
  aqUtils.Delay 0450
 ' Sys.HighlightObject link
  SelectObj.ClickItem(SelectItem)
End Function 

'Author JM Kekana 
'Aim of the function is to Find an Object for us taking 3 arguements
Function ObjPropertyFindGetText(Byval objProp,Byval objString, Byval objTag)
  Set page = Sys.Browser("iexplore").Page(CurrentURL)
  Set link = page.NativeWebObject.Find(objProp, objString, objTag)
  aqUtils.Delay 0450
  Sys.HighlightObject link
 
  InitialCheckval = aqObject.GetPropertyValue(link, "wText")
  ObjPropertyFindGetText = InitialCheckval

End Function 




Sub Testst

Dim description, filepath

Set xmlDoc = CreateObject("Msxml2.DOMDocument") 
xmlDoc.async = False
xmlDoc.load("C:\Testing\TestSuite\testfile.xml") 

Set ElemList = xmlDoc.getElementsByTagName("deceasedestatenameinput")

'viewClientDetails
'filepath = ElemList.item(0).getAttribute("PORT")
'filepath = ElemList.item(0).Text
'read = Split(filepath," ") 
'MsgBox read(0)&"-"&vbNewLine &read(1)&
For Each Elem In ElemList   
                 Set identify = Elem.getElementsByTagName ("identifier") (0)  
                 Set Element = Elem.getElementsByTagName ("Element") (0)  
                 Set ObjectT = Elem.getElementsByTagName ("ObjType") (0)  
                 'Msg ="[identifier :]" & identify.Text & vbNewLine  
                 'Msg = Msg & "[Element:]" & Element.Text & vbNewLine  
                 'Msg = Msg & "[ObjType :]" & ObjectT.Text  
                 MsgBox  identify.Text &vbNewLine &  Element.Text & vbNewLine & ObjectT.Text
Next  


'Call FutureDateSelect("datePickerButton_dateOfBirthPicker")
Call PreviousDateSelect("datePickerButton_dateOfBirthPicker")
Call ObjPropertyFindClick("contentText","Title*", "DIV")
Call ObjPropertyFindClick("htmlFor","pepNo", "Label")

End Sub
'Author JM Kekana
'The aim of the function is to select a Future Date
'You pass the name of the Date Picker object property idStr
Function FutureDateSelect(Byval DateObj)
  
  Call ObjPropertyFindClick("idStr",DateObj, "Button")
  DateObjFuture = ObjPropertyFind("contentText","›", "Button")

    IF DateObjFuture = True Then
     Call ObjPropertyFindClick("contentText","›", "Button")
     Call ObjPropertyFindClick("contentText","01", "SPAN")
    End IF

End Function
'Author JM Kekana
'The aim of the function is to select a Previous Date
'You pass the name of the Date Picker object property idStr
Function PreviousDateSelect(Byval DateObj)
  
  Call ObjPropertyFindClick("idStr",DateObj, "Button")
  DateObjPrv = ObjPropertyFind("contentText","‹", "Button")

    IF DateObjPrv = True Then
      Call ObjPropertyFindClick("contentText","‹", "Button")
      Call ObjPropertyFindClick("contentText","01", "SPAN")
    End IF

End Function

'Author JM Kekana 
'Aim of the function is to search for an object
Function ObjPropertyFind(Byval objProp,Byval objString, Byval objTag)
  Set page = Sys.Browser("iexplore").Page(CurrentURL)
  Set link = page.NativeWebObject.Find(objProp, objString, objTag)
  aqUtils.Delay 0250
 ' Sys.HighlightObject link
   IF link.Exists Then
    ObjPropertyFind = True
   End IF
End Function   
'Author JM Kekana 
'Aim of the function is to click the object
Function ObjPropertyFindClick(Byval objProp,Byval objString, Byval objTag)
  Set page = Sys.Browser("iexplore").Page(CurrentURL)

  ' Find and click the "Products" link
  Set link = page.NativeWebObject.Find(objProp, objString, objTag)
  aqUtils.Delay 0250
 ' Sys.HighlightObject link
  link.Click
  aqUtils.Delay 0500
End Function 
Sub Test89

'Call ObjPropertyFindEnabled("contentText", "Generate Application", "Button")

if ObjPropertyFindEnabled("contentText", "Generate Application", "Button") = True Then
Msgbox "Object Enabled"
End If

End Sub

'Author JM Kekana 
'Aim of the function is to Find the object and Check if its enabled and Return Boolean True
Function ObjPropertyFindEnabled(Byval objProp,Byval objString, Byval objTag)
  Set page = Sys.Browser("iexplore").Page(CurrentURL)

  ' Find and click the "Products" link
  Set link = page.NativeWebObject.Find(objProp, objString, objTag)
  aqUtils.Delay 0450
  Sys.HighlightObject link
  aqUtils.Delay 0500

  'Check to see if the object has been enabled
    If link.Enabled Then
    ObjPropertyFindEnabled = True    
    End If  

End Function 

'Author JM Kekana
'This function is for loading Advice Documents on the Contribution Payer
Function AdviceDocumentsContri(Byval Panel)
'Investment Proposal

Call ObjPropertyFindClick("idStr", "advice_investmentProposal_dropdown_menu", "A")

Call ObjPropertyFindClick("idStr", "advice_investmentProposal_upload", "LI")
' Find and click the Drag and drop file
 Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
 
 Call UploadFileDoc()

 'Application Form Section 
Call ObjPropertyFindClick("idStr", "advice_application_dropdown_menu", "A")

Call ObjPropertyFindClick("idStr", "advice_application_upload", "LI")
' Find and click the Drag and drop file
Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")

Call UploadFileDoc()
'Check to see if we have the Transfer of Units Checked.

TransferOfUnits = ObjPropertyFind("idStr","advice_unitsTransferredVoluntary240_dropdown_menu","A")

IF TransferOfUnits = True Then
Call ObjPropertyFindClick("idStr","advice_unitsTransferredVoluntary240_dropdown_menu","A")

Call ObjPropertyFindClick("idStr", "advice_unitsTransferredVoluntary240_upload", "LI")

' Find and click the Drag and drop file
Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")

Call UploadFileDoc()
End IF
End Function

'Author JM Kekana
'This function is for uploading Client Details Documents
Function ClientDocs()
 'Proof of ID Client Details

 Call ObjPropertyFindClick("idStr", "client_id_dropdown_menu", "A")

 Call ObjPropertyFindClick("idStr", "client_id_upload", "LI")
 
 Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
 'Call the upload file documents
 Call UploadFileDoc()
 
 'Proof Of Residence  

 Call ObjPropertyFindClick("idStr", "client_residence_dropdown_menu", "A")

 Call ObjPropertyFindClick("idStr", "client_residence_upload", "LI")
 
 Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
  'Call the upload file documents
 Call UploadFileDoc() 
  
  'Proof of Banking details
  Call ObjPropertyFindClick("idStr", "client_bankingDetails_dropdown_menu", "A")
  Call ObjPropertyFindClick("idStr", "client_bankingDetails_upload", "LI")
  
  Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
  'Call the upload file documents
  Call UploadFileDoc() 
  'Check if the Proof Of Deposit Exists

  'Proof of Proof Of Deposit details
  ProofOfDep = ObjPropertyFind("idStr","client_deposit_dropdown_menu","A")
  IF ProofOfDep = True Then
  
   Call ObjPropertyFindClick("idStr", "client_deposit_dropdown_menu", "A")
   Call ObjPropertyFindClick("idStr", "client_deposit_upload", "LI")
  
   Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
  'Call the upload file documents
   Call UploadFileDoc() 
  
  END IF

End Function


'Author JM Kekana
'This is for downloading PDFDocs
Function DownloadingPDFDocs()
       aqUtils.delay 5000 
      'Check if the Download window is displayed
      Set DownloadWindow = Sys.Browser("iexplore").BrowserWindow(0).Window("Frame Notification Bar", "", 1).UIAObject("Notification")
      Sys.HighlightObject DownloadWindow
      'Check if the Download window is displayed
      IF DownloadWindow.Exists Then
       'Open the Application form with Keys Alt+o Shortcut
       DownloadWindow.Keys("~o") 
       End If
      aqUtils.Delay 2500
Call Close_Process_Instances("AcroRd32")
End Function

'Author JM Kekana
'This is for upload contribution payer details documents
 Function ContributionDocs() 
 'Proof of ID
   Call ObjPropertyFindClick("idStr", "contributionPayer_contributorId_dropdown_menu", "A")
   Call ObjPropertyFindClick("idStr", "contributionPayer_contributorId_upload", "LI")

  ' Find and click the Drag and drop file
  Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
  'Call the upload file documents
  Call UploadFileDoc()
  
  'Proof of Residence
  Call ObjPropertyFindClick("idStr", "contributionPayer_contributorResidence_dropdown_menu", "A")
  Call ObjPropertyFindClick("idStr", "contributionPayer_contributorResidence_upload", "LI")
  ' Find and click the Drag and drop file
  Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
  'Call the upload file documents
  Call UploadFileDoc()
  
  'Proof of Banking
  Call ObjPropertyFindClick("idStr", "contributionPayer_contributorBanking_dropdown_menu", "A")
  Call ObjPropertyFindClick("idStr", "contributionPayer_contributorBanking_upload", "LI")
  ' Find and click the Drag and drop file
  Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
  'Call the upload file documents
  Call UploadFileDoc()
  'Proof of Deposit
  Call ObjPropertyFindClick("idStr", "contributionPayer_contributorDeposit_dropdown_menu", "A")
  Call ObjPropertyFindClick("idStr", "contributionPayer_contributorDeposit_upload", "LI")
  ' Find and click the Drag and drop file
  Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
  'Call the upload file documents
  Call UploadFileDoc()

 End Function
 
 'Author Kekana JM 
 'This function Clicks the Generate Application button and Loads the PDF
 Function ReviewAndGenerate() 
 aqUtils.Delay 15000

 'Check if the Generate Application Button has been enabled
 IF ObjPropertyFindEnabled("contentText", "Generate Application", "Button") = True Then
    
  'Take Screenshot of the Button
  Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "BTNGenerateEnabled") 
  'Click the Generate Application Button
  Call ObjPropertyFindClick("contentText", "Generate Application", "Button")
 ' btnGenerate.Click  
  aqUtils.delay 8000 
  
      'Check if the Download window is displayed
      Set DownloadWindow = Sys.Browser("iexplore").BrowserWindow(0).Window("Frame Notification Bar", "", 1).UIAObject("Notification")
      Sys.HighlightObject DownloadWindow
      'Check if the Download window is displayed
      IF DownloadWindow.Exists Then
        'Take the Screenshot of the Downloaded Screen Window
        Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "DownloadedWindow") 
       'Open the Application form with Keys Alt+o Shortcut
       'DownloadWindow.Keys("~o")        
        'DownloadWindow.Keys("~c")        
        Sys.Browser("iexplore").BrowserWindow(0).Window("Frame Notification Bar", "", 1).UIAObject("Notification").UIAObject("Close").Click
       'Call the Password submission function for the Application form passing the Id No from the Global Variable IdNo
       aqUtils.delay 8000 
       'This is for downloading the documents 
'       Call FuncPDFPassword(IdNo)
       End If  
  Else 
      Reason = "Button Generate not enabled"

       Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "BTNGenerateNotEnabled")
      'Check to see if the error is coming from Client Details Section
       'Set ClientDetailsError = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Legend(0).TextNode(0).Panel(0)
         ClientDetailsError = ObjPropertyFind("idStr","error_count_clientDetails","DIV")
         IF ClientDetailsError = True Then
          Call ObjPropertyFindClick("idStr", "error_count_clientDetails", "DIV")         
          Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "ClientDetailsError")
         End IF
        'Check to see if there are errors on the contribution payer details section
         ContributionError = ObjPropertyFind("idStr","error_count_contributionPayerDetails","DIV")
          IF ContributionError = True Then
            Call ObjPropertyFindClick("idStr","error_count_contributionPayerDetails","DIV")

            Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "ContributionPayerError")
          End IF        
                
         'Check to see if there are errors on the Product Details section
         ProductDetailsError= ObjPropertyFind("idStr","error_count_productDetails","DIV")
         IF ProductDetailsError = True Then
         Call ObjPropertyFindClick("idStr","error_count_productDetails","DIV")
         Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "ProductDetailsError")
         End IF
    
           'Check to see if there are errors on the financial accordion
            'Set FADetailsError = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(15).Legend(0).TextNode(0).Panel(0)
            FADetailsError = ObjPropertyFind("idStr","error_count_financialAdviserDetails","DIV")
            
            IF FADetailsError = True Then
            Call ObjPropertyFindClick("idStr","error_count_financialAdviserDetails","DIV")
            Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "FADetailsError")
            End IF
 END IF
 
 End Function
'Author JM Kekana
'This function is for Submitting the application 
Function ConfirmAndSubmit()
  'MsgBox "Confirm And Submit function called"
  aqUtils.Delay 3500
  'ConfSubmit.Click - Click the Confirm and Submit Panel
   Call ObjPropertyFindClick("contentText", "Confirm and submit", "DIV")
  
  aqUtils.Delay 1500
  'Check to see if the Submit Application Button is enabled and TestEnvironment is not 
'  Set btnSubmitApplica = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(1).Button("submitApplication")
  
IF ObjPropertyFindEnabled("idStr", "submitApplication", "Button") = True And TestEnvironment <> "prod" Then
    'Sys.HighlightObject btnSubmitApplica
    Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "SubmitApplicaionEnabled")  
    Call ObjPropertyFindClick("idStr", "submitApplication", "Button")
    'btnSubmitApplica.Click 
    Aqutils.Delay 1500
    'Click The Submit Application Button
    Call ObjPropertyFindClick("contentText", "Submit application", "Button")
    Aqutils.Delay 10000
    'The function checks the status of the Quote whether its in a In Progress Status
    Call ValidateQuoteStatus("Completed")  

ElseIf ObjPropertyFindEnabled("idStr", "submitApplication", "Button") = True And TestEnvironment = "prod" Then
        Call ObjPropertyFind("idStr","submitApplication","Button")
        Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "SubmitApplicaionEnabledINProd")
        Result = "pass"
        Reason = "SubmitApplicationEnabled_IN_Prod"  
'Check to see if the SubmitApplication button is not enabled        
ElseIf ObjPropertyFindEnabled("idStr", "submitApplication", "Button") = False Then       
  ' Check to see if there are errors on di
 '    Click on the button si that when we take our screenshot it will be focused
     Call ObjPropertyFind("idStr","submitApplication","Button")
     Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "SubmitApplicaionNotEnabled")

    'idStr error_count_complianceDocuments DIV
       ErrorCompliDocs = ObjPropertyFind("idStr","error_count_complianceDocuments","DIV")   
        If ErrorCompliDocs = True Then
         Call ObjPropertyFindClick("idStr", "error_count_complianceDocuments", "DIV") 
         Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "ComplianceDocsError")
        End If 
      aqUtils.Delay 1000
     'idStr error_count_clientDetails DIV     
       ErroClientDocs = ObjPropertyFind("idStr","error_count_clientDetails","DIV")
       If ErroClientDocs = True Then
         Call ObjPropertyFindClick("idStr", "error_count_clientDetails", "DIV") 
         Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "ClientDocsError")
        ' ErroClientDocs.HoverMouse
       End If
       aqUtils.Delay 1000      
     'idStr error_count_adviceDocuments DIV    
       ErrorAdviceDocs = ObjPropertyFind("idStr","error_count_adviceDocuments","DIV")
       If ErrorAdviceDocs = True Then

            Call ObjPropertyFindClick("idStr", "error_count_adviceDocuments", "DIV") 
            Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "AdviceDocsError")
           ' ErrorAdviceDocs.HoverMouse
            aqUtils.Delay 1000 
        End If

  
Result = "fail"
Reason = "SubmitApplicationNotEnabled"    
End IF

End Function 

'Author JM Kekana
'The aim of this function is to upload Compliance Contribution Documents 
Function ComplianceContribution()
Call ObjPropertyFindSelect("idStr", "complianceOptionSelect", "Select","Option 1 – Pace record")
aqUtils.delay 5000
'Set PaceInteractionlnk = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(1).Table(0).Cell(1, 4).Link(0)
'PaceInteractionlnk.Click
Call ObjPropertyFindClick("idStr", "compliance_paceInteractionLog_dropdown_menu", "A")

'Set PaceInteractionNode = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(1).Table(0).Panel(0).Panel(0).TextNode(0)
'PaceInteractionNode.Click
Call ObjPropertyFindClick("idStr", "compliance_paceInteractionLog_upload", "LI")
aqUtils.Delay 1000
' Find and click the Drag and drop file
Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
 aqUtils.Delay 1500
 Call UploadFileDoc()
End Function
'
Function ComplianceDocs()
Call ObjPropertyFindSelect("idStr", "complianceOptionSelect", "Select","Option 1 – Pace record")
aqUtils.Delay 6000
Call ObjPropertyFindClick("idStr", "compliance_paceInteractionLog_dropdown_menu", "A")

Call ObjPropertyFindClick("idStr", "compliance_paceInteractionLog_upload", "LI")
' Find and click the Drag and drop file
Call ObjPropertyFindClick("contentText", "Drag and drop files or click here to select.", "Label")
 
Call UploadFileDoc()
End Function

'This function is for Adding Amount Tranfer
Function AmntTransfer(Byval test, Byval env)
  Dim browser, section,panel, form, panel2, button,browser2, form2, textbox   

  Excel.WorkSheets("AmntTransfer").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  
  
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set panel = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Call panel.panelPanelPanelDefault3.panelPanelHeading.panelTaxDetails.panelAccordionToggle.panelAmountTransfer.Click(305, 17)
    
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel2 = form.panelFormGroup2
  'Call panel2.panelColSm3.buttonNo.ClickButton
  aqUtils.Delay 1000
  Set button = panel2.panelColSm9.buttonYes
 ' button.ClickButton
 
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Label(0).ClickButton
  'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelColSm9.buttonYes.ClickButton
  
  'Call button.HoverMouse(9, 20)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1352, 470, 13, 94)
  Set button = section.buttonCreateAndLoadProcess
 ' Set AddAnotherbtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Panel(0).Panel(0).Button(0)
  AmntTransfer = Excel.Cells(b,2)
  if AmntTransfer = "Yes" Then
  
  Set AddAnotherbtn =  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Panel(0).Panel(0).Button(0)
  
  if AddAnotherbtn.Exists Then
  AddAnotherbtn.Click
  End IF
  
'  button.ClickButton
  
  Set btnamtsaved =  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Panel(0).Panel(0).Button(0)
  if btnamtsaved.Exists Then
  btnamtsaved.Click
  End If  
 
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Set textbox = form2.panelFormGroup2.panelFormGroup.panelColSm6.textboxTransferringcompany0
  Call textbox.Click(22, 19)
  Compref = Excel.Cells(b,3)
  Call textbox.SetText("Test")
  Set textbox = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup.textboxCompanyreference0
  Call textbox.Click(33, 28)
  Company = Excel.Cells(b,4)
  Call textbox.SetText(Company)
  Call browser2.Drag(1358, 472, 7, 147)
  Set textbox = panel.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.textboxExpectedamount0
  Call textbox.Click(63, 21)
  ExpectedAmnt = Excel.Cells(b,5)
  Call textbox.SetText(ExpectedAmnt) 
  
  ElseIF AmntTransfer = "No" Then
  Call panel2.panelColSm3.buttonNo.ClickButton
  End If
  
  
  'Set Updatebtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0)
  Set Updatebtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0)
  Updatebtn.Click
  'button.ClickButton
End Function

Function FuncAddBeneficiary(Byval Browser, Byval test, Byval env)
  'Read Data from the excel sheet
  Excel.WorkSheets("AddBeneficiary").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  
    
   AddBen = Excel.Cells(b,2)
  'Check if you want to add a beneficiary  Or Not
  if AddBen = "Y"  Then

  'Dim browser, page, section, button, form, form2, vselect, browser2, panel, panel2,panel3,textbox,panel4,panel5, textbox2, emailInput, textbox3   
    
  CustType = Excel.Cells(b,3)
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set button = section.buttonCreateAndLoadProcess
  'Click button using the Full Name
  Set AddBen = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Button(0)
  AddBen.Click
  'button.ClickButton
  'Select the Customer Type
  if CustType = "Individual" Then
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Set vselect = form2.panelFormGroup2.panelFormGroup.formFormHorizontalNgUntouchedNg.selectTypeinput
  Call vselect.ClickItem(CustType)
  'Call browser.pagepopup0.Click(654, 18)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1358, 335, -8, 135)
  Set panel = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  Title = Excel.Cells(b,10)
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup.selectTitleinput.ClickItem(Title)
  ''Call panel.selectTitleinput.ClickItem(Title)
  Set panel2 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Set panel3 = panel2.panelPanelPanelDefault2
  Set textbox = panel3.textboxInitialsinput
  Call textbox.Click(34, 27)
  'Initials
  Initials = Excel.Cells(b,11)
  Call textbox.SetText(Initials)
 ' Call textbox.Keys("[Tab]")
  Set panel4 = form.panelFormGroup2.panelColSm3.panelWellMyDropZoneTextCenter
  Set textbox = panel4.textboxFullnamesinput
  Call textbox.Click(174, 16)
  FullName = Excel.Cells(b,12)
  Call textbox.SetText(FullName)
  Set panel5 = panel3.panelPanelHeading
  Set textbox = panel5.textboxSurnameinput
  Call textbox.Click(116, 12)
  SurName = Excel.Cells(b,13)
  Call textbox.SetText(SurName)
  Set textbox = panel4.textboxRsaIdNumber
  Call textbox.Click(55, 12)
  IDNum = Excel.Cells(b,15)
  Call textbox.SetText(IDNum)
  Set textbox = panel5.textboxClientrelationshipinput
  Call textbox.Click(49, 12)
  Relationship = Excel.Cells(b,16)
  Call textbox.SetText(Relationship)
  Set textbox2 = panel2.panelPanelPanelDefault3.panelPanelHeading.textboxContactnumberinput
  Call textbox2.Click(37, 14)
  ContactNo = Excel.Cells(b,17)
  Call textbox2.SetText(ContactNo)
  Set emailInput = form.formFormNgUntouchedNgPristineN2.panelFormGroup4.panelColSm8.emailinputEmailinput
  Call emailInput.Click(36, 10)
  Email = Excel.Cells(b,18)
  Call emailInput.SetText(Email)
  Call browser2.Drag(1365, 481, 0, 115)
  Call page.HoverMouse(1342, 488)
  Call section.HoverMouse(1346, 988)
  Call browser2.Drag(1359, 530, -13, -10)
  Call emailInput.Click(284, 15)
  Call page.HoverMouse(1351, 444)
  Call section.HoverMouse(1330, 681)
  Call browser2.Drag(1359, 454, -51, -145)
    'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Button(0).Click  
 ' Click the Product Details Button
 Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
  'If its the corporations that have been inputed  
  Else 
  Set form = section.formFormHorizontalNgUntouchedNg
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Set vselect = form2.panelFormGroup2.panelFormGroup.formFormHorizontalNgUntouchedNg.selectTypeinput
  Call vselect.ClickItem(CustType)

  Name =  Excel.Cells(b,5)  
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Panel(0).Textbox("surnameInput_").SetText(Name)

  RegNo =  Excel.Cells(b,6)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(1).Panel(1).Panel(0).Textbox("registrationNumberInput_").SetText(RegNo)
  'Relationship to Client
  Relate =  Excel.Cells(b,7)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("clientRelationshipInput_").SetText(Relate)
  'Contact  number
  ContactNum = Excel.Cells(b,8)
  Set Cont = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("contactNumberInput_")
   Cont.SetText(ContactNum)
  'Email Address
  EmailAd = Excel.Cells(b,9)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).EmailInput("emailInput_").SetText(EmailAd)
  'Call browser2.Drag(1354, 514, 3, 153)
 
  'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Button(0).Click  
 ' Click the Product Details Button
 Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
 End If
 End if 
End Function


Function FuncAddBeneficiaryOwner(Byval Browser, Byval test, Byval env)
  
    'Read Data from the excel sheet
  Excel.WorkSheets("AddBenOwnership").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  

  

'  Dim browser,page, section, button, browser2, form, panel, vselect, textbox, panel2, panel3, panel4,panel5, button2, emailInput, textbox2, explorer  


  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set button = section.buttonCreateAndLoadProcess
  'Click the Add Beneficiary Ownership Button
  Set AddBeneficiaryOwner = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Form(0).Panel(0).Panel(0).Panel(0).Button(0)
  AddBeneficiaryOwner.Click
  Call page.HoverMouse(1352, 435)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1358, 358, -10, 44)
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  Set vselect = panel.selectTitle
  'Call vselect.ClickItem("Select..")
  Title = Excel.Cells(b,2)
  Call vselect.ClickItem(Title)
  Set textbox = panel.panelColSm3.textboxInitials
  Call textbox.Click(35, 24)
  Initials = Excel.Cells(b,3)
  Call textbox.SetText(Initials)
  Call textbox.Click(35, 24)
  Set panel2 = form.panelFormGroup
  Set textbox = panel2.panelColSm9.textboxFullNames
  Call textbox.Click(105, 13)
  Fullnames = Excel.Cells(b,4)
  Call textbox.SetText(Fullnames)
  Set panel3 = form.panelFormGroup3
  Set textbox = panel3.panelColSm9.textboxPreferredName
  Call textbox.Click(33, 18)
  Call textbox.SetText("Testing")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  Call textbox.Click(35, 25)
  Surname = Excel.Cells(b,6) 
  Call textbox.SetText(Surname)
  Call browser2.Drag(1354, 413, -8, 119)
  Set panel5 = form.panelFormGroup5.panelColSm4
 ' panel5.buttonPassportNumber.ClickButton
  Set button2 = form.buttonRsaIdNumber
  button2.ClickButton
  Call button2.HoverMouse(11, 12)
  Set textbox = form.panel.panelFormGroup.panelColSm9.textboxIdNumber
  Call textbox.Click(19, 22)
  Surname = Excel.Cells(b,8)
  Call textbox.SetText(Surname)
  form.buttonSouthAfrican.ClickButton
  
  'Make selection based on Gender
  Gender = Excel.Cells(b,10)
  if Gender = "Male" Then
  Set button2 = form.buttonMale
  
  button2.ClickButton
   Else 
  form.buttonFemale.ClickButton
  
  button2.ClickButton
  
  End If 
  
  Set textbox = form.textbox
  Call textbox.Click(65, 21)
  'Call textbox.Click(148, 21)
  'Call textbox.Click(44, 15)
  Call browser2.Drag(1364, 468, 1, 93)
  'form.formFormHorizontalNgUntouchedNg.buttonNo.ClickButton
  'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails").Click
  
  'button.ClickButton
  'Call browser2.Click(755, 349)
  'button.ClickButton
  Call browser2.Drag(1359, 412, 6, 124)
  Call section.panelContainer.panelColSm12.panelPanelBody.panelPanelBodyForm.panelFormDynamicSectionNoMargin.panelContactDetails.Click(593, 22)
  Call page.HoverMouse(1348, 336)
  Call section.HoverMouse(1332, 382)
  Call browser2.Drag(1353, 390, -21, -161)
  Call page.HoverMouse(1365, 228)
  Call browser2.Drag(1363, 252, 2, -82)
  panel.panelColSm9.buttonYes.ClickButton
  
  panel2.buttonPost.ClickButton
  
  Call browser2.Drag(1361, 310, 4, 176)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
  Call textbox.Click(56, 22)
  TelW = Excel.Cells(b,14)
  Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
  Call textbox.Click(25, 18)
  TelH = Excel.Cells(b,15) 
  Call textbox.SetText(TelH)
  Set textbox = panel4.panelColSm4.textboxCellphone
  Call textbox.Click(241, 19)
  Cell = Excel.Cells(b,16) 
  Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  Call textbox.Click(30, 23)
   Fax = Excel.Cells(b,17)
  Call textbox.SetText(Fax)
  Set emailInput = panel5.emailinputEmail
  Call emailInput.Click(165, 13)
   Email = Excel.Cells(b,18)  
  Call emailInput.SetText(Email)
  
  Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.ClickButton(cbChecked)
  Set textbox = form.formFormNgUntouchedNgPristineN2
  Set textbox2 = textbox.panelFormGroup.panelColSm8.textboxLine1
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  line1 = Excel.Cells(b,19)
  lin1.SetText(line1)
  'Call textbox2.SetText("123")
  Set textbox2 = textbox.panelFormGroup2.panelColSm8.textboxLine2
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  line2 = Excel.Cells(b,20)
  lin2.SetText(line2)
  'Call textbox2.SetText("456")
  Set textbox2 = textbox.panelFormGroup3.panelColSm8.textboxLine3
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
   line3 = Excel.Cells(b,21)
  lin3.SetText(line3)
  'Call textbox2.SetText("789")
  Set textbox2 = textbox.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox2.Click(113, 15)
  Set city = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  CityDt = Excel.Cells(b,22)
  city.SetText(CityDt)
  'Call textbox2.SetText("Joburg")
  Set textbox2 = textbox.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox2.Click(132, 17)
  'Call textbox2.SetText("0002")
  Set Code =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  Postal = Excel.Cells(b,23)
  Code.SetText(Postal)
  'Call browser2.DblClick(1359, 655)
  'Call browser2.Click(1359, 655)
  Set textbox2 = textbox.panelFormGroup6.panelColSm8.textboxProvince
  Set Provinc = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  Prov = Excel.Cells(b,24)
  Provinc.SetText(Prov)

  countr = Excel.Cells(b,25)
  Set Country = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(7).Panel(0).Select("countryCode_Physical")
  
  Country.ClickItem(countr)
  
  
  Set btnupdate = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails")
  btnupdate.Click
  
  'Set btnlink = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button(0)
  Set btnlink = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button("productDetails")
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Link(0)
  btnlink.Click
  
End Function


'Add Insure Function
Function FuncAddInsure(Byval Browser, Byval test, Byval env)
  
      'Read Data from the excel sheet
  Excel.WorkSheets("AddBenOwnership").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  


 ' Dim browser,page,section,form,panel,button,button2,browser2,panel2,textbox,panel3,panel4,panel5
 ' Dim button3, emailInput,textbox2, checkbox

  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  Set button = panel.panelColSm9.buttonYes
  button.ClickButton
  'button.ClickButton
  Set button2 = section.buttonCreateAndLoadProcess
  'button2.ClickButton
  Set AddInsure =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(1).Panel(1).Panel(0).Panel(0).Button(0)
  AddInsure.Click
  Call page.HoverMouse(1355, 442)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1355, 372, 4, 21)
  Title = Excel.Cells(b,2)
  Call panel.selectTitle.ClickItem(Title)
  Set panel2 = panel.panelColSm3
  Set textbox = panel2.textboxInitials
  Call textbox.Click(13, 20)
  Initial = Excel.Cells(b,3)
  Call textbox.SetText(Initial)
  Set panel = form.panelFormGroup
  Set panel3 = panel.panelColSm9
  Set textbox = panel3.textboxFullNames
  Call textbox.Click(378, 25)
  FName = Excel.Cells(b,4)
  Call textbox.SetText(FName)
  Set panel4 = form.panelFormGroup3
  Set textbox = panel4.panelColSm9.textboxPreferredName
  Call textbox.Click(80, 21)
  Call textbox.SetText("Teste")
  Set panel5 = form.panelFormGroup4
  Set textbox = panel5.panelColSm9.textboxSurname
  Call textbox.Click(49, 9)
  SName = Excel.Cells(b,6)
  Call textbox.SetText(SName)
  Call browser2.Drag(1359, 367, 6, 146)
  Set textbox = form.panel.panelFormGroup.panelColSm9.textboxIdNumber
  Call textbox.Click(13, 18)
  IDNum = Excel.Cells(b,8)
  Call textbox.SetText(IDNum)
  form.buttonSouthAfrican.ClickButton
    
    'Get Gender from excel file
    Gender = Excel.Cells(b,10)
  
    if Gender = "Male" Then
    'Set button3 = form.buttonMale
    'button3.ClickButton
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.buttonMale.ClickButton
    else 
    'Set button3 = form.buttonMale
    'form.buttonFemale.ClickButton
    'button3.ClickButton
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.buttonFemale.ClickButton
    End If
  
  Call browser2.Drag(1360, 394, 5, 149)
  'button2.ClickButton ' Click The Update Button
  Set UpdateInsure = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails")
  UpdateInsure.Click
  
  Call browser2.Drag(1360, 494, 5, 115)
  section.panelContainer.panelColSm12.panelPanelBody.panelPanelBodyForm.panelFormDynamicSectionNoMargin.panelContactDetails.Click
  Call page.HoverMouse(1365, 165)
  Call browser2.Drag(1358, 301, 7, -140)
  panel2.buttonNo.ClickButton
  button.ClickButton
  panel.buttonPost.ClickButton
  panel3.buttonEmail.ClickButton
  Set textbox = panel4.panelColSm4.textboxTelephoneW
  Call textbox.Click(19, 11)
  TelWork = Excel.Cells(b,14)
  Call textbox.SetText(TelWork)
  Set textbox = panel4.panelColSm42.textboxHometelephone
  Call textbox.Click(27, 21)
  TelHome = Excel.Cells(b,15)
  Call textbox.SetText(TelHome)
  Set textbox = panel5.panelColSm4.textboxCellphone
  Call textbox.Click(195, 16)
  Cell = Excel.Cells(b,16)
  Call textbox.SetText(Cell)
  Set textbox = panel5.panelColSm42.textboxFax
  Call textbox.Click(72, 20)
  Fax = Excel.Cells(b,17)
  Call textbox.SetText(Fax)
  Set emailInput = form.panelFormGroup5.panelColSm4.emailinputEmail
  Call emailInput.Click(41, 21)
  emailad = Excel.Cells(b,18)
  Call emailInput.SetText(emailad)
  Call browser2.Drag(1357, 346, 8, 206)
  Set textbox = form.formFormNgUntouchedNgPristineN2
  Set textbox2 = textbox.panelFormGroup.panelColSm8.textboxLine1
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  line1 = Excel.Cells(b,19)
  lin1.SetText(line1)
  'Call textbox2.Click(155, 27)
  'Call textbox2.SetText("Testing")
  Set textbox2 = textbox.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox2.Click(68, 10)
  'Call textbox2.SetText("5345354h")
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  line2 = Excel.Cells(b,20)
  lin2.SetText(line2)
  Set textbox2 = textbox.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox2.Click(16, 31)
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  line3 = Excel.Cells(b,21)
  lin3.SetText(line3)
  'Call textbox2.SetText("546546")
  Set textbox2 = textbox.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox2.Click(39, 20)
  Set city = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  Cit = Excel.Cells(b,22)
  city.SetText(Cit)
  'Call textbox2.SetText("Johannesburg")
  Set textbox2 = textbox.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox2.Click(45, 18)'
  Set code = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  Post = Excel.Cells(b,23)
  code.SetText(Post)
  'Call textbox2.SetText("0002")
  Set textbox2 = textbox.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox2.Click(40, 5)
  Set Provinc = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  Prov = Excel.Cells(b,24)
  Provinc.SetText(Prov)
  'Call textbox2.SetText("Mpumalanga")
    countr = Excel.Cells(b,25)
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.selectCountrycodePhysical.ClickItem(countr)
 ' Call textbox.selectCountry.ClickItem("South Africa")
  Set checkbox = form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress
  Call checkbox.ClickButton(cbChecked)
  'button2.ClickButton
  'Click the Update Button
  Set Update = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails")
  Update.Click

 ' Set ProdLink = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button(0)
  Set ProdLink = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button("productDetails")
  ProdLink.Click
End Function



Function Uploadfile()
  Dim browser
  Dim section
  Dim panel
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set panel = section.formFormHorizontalNgUntouchedNg.panelFormGroup2
  panel.panelColSm9.buttonYes.Click
  Call browser.dlgViewDownloadsInternetExplorer.OpenFile("C:\Users\johannes.kekana\Pictures\Beneficiary Screen\Delete Beneficiary Add Insure.PNG", "All Files (*.*)")
  Call panel.panelColSm3.HoverMouse(1194, 526)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Table(0).Panel(0).Panel(0).Panel(2).Button(1).Click
  'section.buttonCreateAndLoadProcess.ClickButton
End Function

Function LogOff
  

End Function 
Sub TestLogin

Call LoginVia()

'Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/Home/home").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(2).Section(0).Panel(0).Panel("ProductOverviewApp").Panel("carousel_home").Panel(0).Panel(1).Panel(0).Panel(2).Panel(3).Panel(1).Button(0).Click
aqUtils.Delay 2400
'Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/Home/home").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(2).Section(0).Panel(0).Panel("ProductOverviewApp").Panel("carousel_home").Panel(0).Panel(1).Panel(0).Panel(2).Panel(3).Panel(1).Link(1).Click
End Sub 

Function LoginVia()
Call Close_Process_Instances("iexplore")
Browsers.Item("iexplore").Run("https://viapre.momentum.co.za/for/")
aqUtils.Delay 4500
Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/for/").Header("top").Panel(0).Nav("siteNavbar").Link("loginlink").Click

Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/for/*").Panel("momentum_retail_login_modal").Panel(0).Panel(0).Form("modal_form").Panel(0).Panel(0).Textbox("momentum_retail_login_modal_user_name").SetText("derek")
Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/for/*").Panel("momentum_retail_login_modal").Panel(0).Panel(0).Form("modal_form").Panel(0).Panel(1).PasswordBox("passwordModal").SetText("Momentum1")

Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/for/*").Panel("momentum_retail_login_modal").Panel(0).Panel(0).Form("modal_form").Panel(1).Button("momentum_retail_login_modal_submit").Click
aqUtils.Delay 9000

Set PopLogin = Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/!ut/p/a1/0wcA1NLTeQ!!/").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(3).Section(0).Panel(0).Panel(0).Panel(0).Section(0).Panel("readMoreModal").Panel(0).Panel(0).Panel("carousel_example_generic")

  IF PopLogin.Exists Then
    Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/!ut/p/a1/0wcA1NLTeQ!!/").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(3).Section(0).Panel(0).Panel(0).Panel(0).Section(0).Panel("readMoreModal").Panel(0).Panel(0).Button(0).TextNode(0).Click
  End If
  aqUtils.Delay 5500
 'Click the Side Menu
  Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/!ut/p/a1/0wcA1NLTeQ!!/").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(0).Section(0).Panel(0).Panel("SideMenuApp").Panel(0).Panel("sidemenurootid").Panel(0).Panel(2).Panel(0).TextNode("menuLabel").Click 
  'Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/Home/tools/wealthquote").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(0).Section(0).Panel(0).Panel("SideMenuApp").Panel(0).Panel("sidemenurootid").Panel(0).Panel(2).Panel(0).TextNode("menuLabel").Click
  
  'contentText Sales Illustration
  aqUtils.Delay 2500  
  Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/!ut/p/a1/0wcA1NLTeQ!!/").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(0).Section(0).Panel(0).Panel("SideMenuApp").Panel(0).Panel("sidemenurootid").Panel(0).Panel(0).Link(1).TextNode(0).Click
  'Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/!ut/p/a1/0wcA1NLTeQ!!/").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(0).Section(0).Panel(0).Panel("SideMenuApp").Panel(0).Panel("sidemenurootid").Panel(0).Panel(0).TextNode(0).TextNode(1).Link(0)  
  
  'Access Wealth Quote    
  aqUtils.Delay 2500
  Sys.Browser("iexplore").Page("https://viapre.momentum.co.za/connected/!ut/p/a1/0wcA1NLTeQ!!/").Section(0).Panel(1).Panel(0).Panel("ibmMainContainer").Panel(0).Section(0).Panel(0).Panel("SideMenuApp").Panel(0).Panel("sidemenurootid").Panel(0).Panel(1).Link(1).TextNode(0).Click
      
End Function


'Author JM Kekana
'This Function logs you into MDSONLine
'Paremeter Role in the row that is equivalent to it
Function LoginMDSOnline(Byval Test)
  'Close the Explorer Instance
  Call Close_Process_Instances("iexplore")
  aqUtils.Delay 2000
  Dim Process
  'Activate the LoginMDS sheet with the excel file
  Excel.WorkSheets("LoginMDS").Activate
  'Get the row count of the activated Sheet
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
  
  'Start the row count from second row
	For b = 2 to RowCnt
  '  Compare the value that has been passed as a parameter and what is in the sheet(Column 1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
    'If not the same move to the next row/column
		 Else  
     'If you found the match then assign it to the Process Variable and Exit the for loop   
    ' Process = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

  'Get the TestEnvironment from the Excel Sheet
  TestEnvironment = lcase(Excel.Cells(b,6))
    
  'Check to see what Environment Are you supposed to point to
IF TestEnvironment = "prod" Then
       'Check if the Environment is Prod and assign the objects
       LoginURL = "http://mdsonline.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp"     
       LogOffURL = "http://mdsonline.momentum.co.za/mdsonline/login"
       LoggedInPage = "http://mdsonline.momentum.co.za/mdsonline/login"
          ElseIf TestEnvironment = "pre" Then
           'Check if the Environment is Pre and assign the objects 
           LoginURL = "http://mdsonlinepre.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp"     
           LogOffURL = "http://mdsonlinepre.momentum.co.za/mdsonline/login" 
           LoggedInPage = "http://mdsonlinepre.momentum.co.za/mdsonline/login"      
             'Check if the Environment is TST and assign the objects
             ElseIf TestEnvironment = "test" Then
             LoginURL = "http://mdsonlinepre.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp"     
             LogOffURL = "http://mdsonlinepre.momentum.co.za/mdsonline/login"
             LoggedInPage = "http://mdsonlinepre.momentum.co.za/mdsonline/login"
  End If
'  MsgBox LoginURL &"-"& LogOffURL  
  aqUtils.Delay 3500 
  'Open the Browser and Login Page
  Browsers.Item("iexplore").Run(LoginURL)
 ' Browsers.Item("iexplore").Run("http://mdsonline.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp")

  aqUtils.Delay 3500
    'Maximize the screen
  Sys.Browser().BrowserWindow(0).Maximize
  

  
  Set UserN = Sys.Browser("iexplore").Page(LoginURL).Table(0).Cell(0, 0).Form("loginForm").Table(0).Cell(6, 3).Table(0).Cell(0, 1).Textbox("j_username")
  Username = Excel.Cells(b,3)
  UserN.SetText(Username)

  Password = Excel.Cells(b,4)
  Set MDSPassword = Sys.Browser("iexplore").Page(LoginURL).Table(0).Cell(0, 0).Form("loginForm").Table(0).Cell(6, 3).Table(0).Cell(2, 1).PasswordBox("j_password")
  MDSPassword.SetText(Password)

  Set BtnSubmit = Sys.Browser("iexplore").Page(LoginURL).Table(0).Cell(0, 0).Form("loginForm").Table(0).Cell(6, 3).Table(0).Cell(4, 0).Link(0).Image("submit_gif")
  BtnSubmit.Click 
  
  aqUtils.Delay 6000
  'Get the logoff URL specific to the environment
  Set Logfflnk = Sys.Browser("iexplore").Page(LogOffURL).Frame("headerMenuFrame").Form("actCodes").Table(0).Cell(1, 0).Table(0).Cell(2, 2)  
  
  If Logfflnk.Exists Then
  Result = "pass"
  Reason = "User logged in successfully"
  Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "Logged in Successfully")
  Else 
  Result = "fail"
  Reason = "User not logged in successfully"
  Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "NotLoggedinSuccessfully")
  End If
  
  aqUtils.Delay 3000

End Function 
 
'The aim of the function is to capture the Quote Details from the Quote Applications
'It is passing as a parameter the column value that we want to source data from which row.
Function NewQuoteDetails(Byval test)
  Dim Process
  Excel.WorkSheets("QuoteClientDet").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt

		If lcase(Excel.Cells(b,1)) <> lcase(test) Then

		 Else     
     Process = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  
  'Click the Momentum Wealth Link                                     
  Set MomentumWealth = Sys.Browser("iexplore").Page(LoggedInPage).Frame("leftMenuFrame").Table(9).Cell(0, 0).Link("leftMainMenu10")
  MomentumWealth.Click
  aqUtils.Delay 6000
  
  Set NewWebsiteLink = Sys.Browser("iexplore").Page(LoggedInPage).Frame("contentFrame").Form("wealthLanding").Panel("SELECTVIEW").Table(1).Cell(0, 1).Link("newWebsiteId").Image("new_website_png")
  NewWebsiteLink.Click 
    
  Dim browser,form, textbox, table, passwordBox, page, browserWindow, panel, browser2, frame
 
  aqUtils.Delay 10000
  'Click the Tools Tab
  ToolsLink = ObjPropertyFind("innerText","Tools","A")
  if ToolsLink = True Then
  Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "Tool_MDSONline_Clicked")
  Call ObjPropertyFindClick("innerText","Tools","A")
  'Tools.Click
 
    aqUtils.Delay 5000
    WealthQuote = ObjPropertyFind("ObjectIdentifier","wealth_quote_png","IMG")
    IF WealthQuote = True Then
      Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "WealthQuoteClicked")
     ' WealthQuote.Click 
      Call ObjPropertyFindClick("ObjectIdentifier","wealth_quote_png","IMG") 
    ELSE
      Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "WealthQuoteNotClicked")
      If Sys.Browser.BrowserWindow(1).Exists Then
      Sys.Browser.BrowserWindow(0).Close   
      End If
    End If
  
  aqUtils.Delay 10000
  'Click AddClientButton
  
  BtnAddClient = ObjPropertyFind("contentText","ADD CLIENT","Button")
  IF BtnAddClient = True Then
      Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "BTNAddClientClicked")
      Call ObjPropertyFindClick("contentText","ADD CLIENT","Button")
      'BtnAddClient.Click  
  Else 
      Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "BTNAddClientNotClicked")
  End If

  'Maximize the screen - If we have the second screen opened from QUOTE
  IF Sys.Browser.BrowserWindow(1).Exists THEN
      Sys.Browser.BrowserWindow(0).Close   
  END IF
  Sys.Browser().BrowserWindow(0).Maximize
  
  Set TypeId = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Select(0) 
  TypeId.ClickItem(1) 

  aqUtils.Delay 10000
  
  Idnumber = Excel.Cells(b,2)  
  'Set IdNotxt = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(2).Panel(0).Textbox(0)
' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(2).Panel(0).Textbox(0)
  Set IdNotxt = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Textbox(0)
  IdNotxt.Keys(Idnumber)
  GlobalID = Idnumber

  Set FNametxtb = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(4).Panel(0).Textbox(0)
  FName = Excel.Cells(b,3)
  'Assign a uniquename by concatenating Fname and Converted date format to string 
  UniqueName = Replace(FuncStrDateFormat,"-","")
  GlobalFName = UniqueName
  
  FNametxtb.Keys(UniqueName)
  Initials = Excel.Cells(b,4)
  'Set Initialstxtb = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(6).Panel(0).Textbox(0)
  Set Initialstxtb = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(5).Panel(0).Textbox(0)
  'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(4).Panel(0).Textbox(0)
  Initialstxtb.Click
  InitialVal = Left(UniqueName,1)
  Initialstxtb.SetText("")
  Initialstxtb.Keys(InitialVal)
  GlobalInitial = InitialVal


  LName = Excel.Cells(b,5)
  Set LNametxtbox = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(6).Panel(0).Textbox(0)    
  'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(5).Panel(0).Textbox(0)
  LNametxtbox.Keys(LName)  
  GlobalLname = LName
  Email = Excel.Cells(b,6)
  Set EmailAdd = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(7).Panel(0).Textbox(0) 
  EmailAdd.Keys(Email)
  GlobalEmailAddress = Email
  'Select Language
   Set Language = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(8).Panel(0).Select(0)
   Language.ClickItem(1)

   CellNo = Excel.Cells(b,8)
   Set Celltxtbox = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(9).Panel(0).Textbox(0)
    Celltxtbox.Keys(CellNo)
  GloabalContacts = CellNo 
 ' MsgBox GloabalContacts &"-"&GlobalEmailAddress&"-"&GlobalLname&"-"&GlobalInitial&"-"&GlobalFName&"-"&GlobalID
  aqUtils.Delay 2500
  
 ' Set BtnSaveClient = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Button(1)
  BtnSaveClient = ObjPropertyFind("contentText","SAVE CLIENT","Button")
  IF BtnSaveClient = True Then
    Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "NewQuoteSave")
    Call ObjPropertyFindClick("contentText","SAVE CLIENT","Button")
 
    Else
    Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "NewQuoteSaveNotClicked")
  End If  
  
  aqUtils.Delay 9000

  Call ObjPropertyFindClick("contentText","Add Quote","Button")
  Aqutils.Delay 6000
  
  Result = "pass"
  Reason  = "Tool Tab found and clicked"   
   Else 
  Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "ToolTabNotFound")
  Result = "fail"
  Reason  = "Tool Tab not found to be clicked"
  End If 

End Function 


'This function captures the investment details you pass the row of the data that you want to use
Function InvestmentDetail(Byval test)

Dim Process
  Excel.WorkSheets("InvestmentDetai").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then

		 Else     
     Process = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

  CurrntURL =  CurrentURL 

  Dim sString
  
  Dim compare
  
  sString = "Flexible Investment Option"

  aqUtils.Delay 2000

  Set Product = Sys.Browser("iexplore").Page(CurrntURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Select(0)

  If Product.Exists Then
  
  'Check the product and make the product
  ProductSource = Excel.Cells(b,3)
  If ProductSource = "Flexible Investment Option" Then
  Product.ClickItem(2)  
  End If
  'Click the Death benefit
  DeathBenefit = Excel.Cells(b,4)
  IF DeathBenefit = "Yes" Then
  Call ObjPropertyFindClick("contentText","Death benefit guarantee","Label")
  End IF
  
  'Lump Sum Investment 
  LumpInvestAmount = Excel.Cells(b,6)
  Set InvestAmount =  Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(1).Panel(2).Panel(0).Panel(0).Textbox("lumpSumInvestmentAmount")
  InvestAmount.Keys(LumpInvestAmount)

  Call ObjPropertyFindEnterText("idStr","lumpSumInvestmentAmount","INPUT",LumpInvestAmount)
  
  'Lump Invest Date
  LumpInvestDate  = Replace(Excel.Cells(b,7),"-","/")
  Set InvestDate = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(1).Panel(2).Panel(0).Panel(1).Panel(0).Textbox(0)
 ' MsgBox(LumpInvestDate)
  InvestDate.SetText(LumpInvestDate)
  
  'Click the Draw an income from this investment
  DrawIncome  = Excel.Cells(b,8)
  if DrawIncome = "Yes" Then
  Call ObjPropertyFindClick("contentText","Draw an income from this investment","Label")
  End If

  RegularInvestAmount =  Replace(Excel.Cells(b,11),"-","/")
 
  Set RegularInvestAmnt = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Textbox("regularInvestment")
  RegularInvestAmnt.Keys(RegularInvestAmount)
    
  Frequencyval = Excel.Cells(b,12)
  Set Frequency = Sys.Browser("iexplore").Page(CurrntURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(0).Panel(1).Select(0)
  Frequency.ClickItem(Frequencyval)
  
  'Date of first contribution   
  Dateofcontrval =  Replace(Excel.Cells(b,13),"-","/")                   
  'Set DateOfFirstContr = Sys.Browser("iexplore").Page(CurrntURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Textbox(0)
  Set DateOfFirstContr = Sys.Browser("iexplore").Page(CurrntURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Textbox(0)
  DateOfFirstContr.SetText(Dateofcontrval)
  
  MonthOfFirstIncrease =  Replace(Excel.Cells(b,14),"-","/")
  
  'Set MonthFirstIncr = Sys.Browser("iexplore").Page(CurrntURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(2).Panel(0).Panel(0).Textbox("investmentIncreasePeriodSelector")
  Set MonthFirtsIncr =  Sys.Browser("iexplore").Page(CurrntURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(2).Panel(0).Panel(0).Textbox("investmentIncreasePeriodSelector")
  IncreaseYearlyPerc = Excel.Cells(b,15)
  ' IncreasePerc.Keys(IncreaseYearlyPerc)
   Call ObjPropertyFindEnterText("idStr","increaseYearlyPercentage","INPUT",IncreaseYearlyPerc)
  'Withdraw Details Every Month
  FrequencyPayable = Excel.Cells(b,18)
  'Set FrequencyPaylist = Sys.Browser("iexplore").Page(CurrntURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(2).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Select(0)
  Set FrequencyPaylist = Sys.Browser("iexplore").Page(CurrntURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(2).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Select(0)
  FrequencyPaylist.ClickItem(FrequencyPayable)
  
   IncomeAmountEvery = Excel.Cells(b,19)
  Set WithdrawalAmount = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(3).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Textbox("withdrawalIncomeAmount")
  WithdrawalAmount.Keys(IncomeAmountEvery)
 
  'Call ObjPropertyFindEnterText("ObjectIdentifier","withdrawalIncomeAmount","INPUT",IncomeAmountEvery)   
  InstructDayWithdraw = Excel.Cells(b,20)

  Set WithdrawalInstrucDay  = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(3).Panel(0).Panel(1).Panel(0).Panel(1).Panel(0).Textbox("withdrawalIncomeInstructionDay")
  WithdrawalInstrucDay.SetText(InstructDayWithdraw)
 'Call ObjPropertyFindEnterText("ObjectIdentifier","withdrawalIncomeInstructionDay","INPUT",InstructDayWithdraw)  
  FirstDayInstruct =  Replace(Excel.Cells(b,21),"-","/")

  Set FirstInstructDay = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(3).Panel(0).Panel(1).Panel(0).Panel(1).Panel(1).Panel(0).Textbox(0)
  'FirstInstructDay.SetText("2017/10/30")
  FirstInstructDay.SetText(FirstDayInstruct)
  'Adviser Fees
  LumpsumInitialFee = Excel.Cells(b,24)
 ' Set InitialFeeLump = Sys.Browser("iexplore").Page(CurrntURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(3).Panel(0).Panel(1).Panel(0).Table(0).Cell(1, 1).Panel(0).NumberInput("initialLumpSumAdviceFees")
 ' InitialFeeLump.Keys(LumpsumInitialFee)
  Call ObjPropertyFindEnterText("idStr","initialLumpSumAdviceFees","INPUT",LumpsumInitialFee)
  
  RegularInvestInitialFee = Excel.Cells(b,25)
  'Set InitialFeeRegular = Sys.Browser("iexplore").Page(CurrntURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(3).Panel(0).Panel(1).Panel(0).Table(0).Cell(1, 2).Panel(0).NumberInput("initialAdviceRecurringFees")
  'InitialFeeRegular.Keys(RegularInvestInitialFee)
  Call ObjPropertyFindEnterText("idStr","initialAdviceRecurringFees","INPUT",RegularInvestInitialFee)  
  LumpSumOngoingFee = Excel.Cells(b,26)
 ' Set OngoingFeeLump = Sys.Browser("iexplore").Page(CurrntURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(3).Panel(0).Panel(1).Panel(0).Table(0).Cell(2, 1).Panel(0).NumberInput("ongoingAdviceFees")
 ' OngoingFeeLump.Keys(LumpSumOngoingFee)
  Call ObjPropertyFindEnterText("idStr","ongoingAdviceFees","INPUT",LumpSumOngoingFee)
  aqUtils.Delay 1200
  Call ObjPropertyFindClick("contentText","Next","Button")
   Aqutils.Delay 8000 
  'Investements Components  
  'Click the All Funds TAB
  Call ObjPropertyFindClick("contentText","All funds","A")
  aqUtils.delay 1000
  'Call ObjPropertyFindClick("contentText","Regulation 28 compliant only","Label")
  Call ObjPropertyFindClick("contentText","Reg 28 managed only","Label")  
  Call ObjPropertyFindEnterText("ObjectType","Textbox","INPUT","Money Market Fund")
  'Click the Add Fund Button
  aqUtils.Delay 3000
  'Check the environment to assign the correct object
  IF TestEnvironment = "pre" Then
     'Set AddFund = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Panel(0).Panel(0).Panel(0).Table("clusterizeTable").Cell(0, 4).Panel(0).Button(2)
     Set AddFund = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(3).Table(0).Cell(1, 4).Panel(0).Button(0)
     'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Panel(0).Panel(0).Panel(0).Table("clusterizeTable").Cell(0, 4).Panel(0).Button(2)  
        ElseIf TestEnvironment = "prod" Then
        'Set AddFund = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Panel(2).Panel(0).Panel(0).Panel(0).Panel(0).Table("clusterizeTable").Cell(0, 4).Panel(0).Button(2)
        Set AddFund = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(3).Table(0).Cell(1, 4).Panel(0).Button(0)
         ElseIF TestEnvironment = "tst" Then
  
  End IF

  AddFund.Click
  'Click Apply the same portfolio
  Call ObjPropertyFindClick("contentText","Balance","Button")
  aqUtils.delay 0500
  Call ObjPropertyFindClick("contentText","Apply the same portfolio for lump sum and regular investments","Label")
  aqUtils.delay 0500
  'Fee Component
  Set FundDropdown = Sys.Browser("iexplore").Page(CurrentURL).Panel(1).Panel(0).Panel("wealthQuoteToolIframeContainer").Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(4).Panel(1).Panel(0).Panel(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Panel(1).Select(0)
  FundDropdown.ClickItem(1)  
  'Click The Next Button
  aqUtils.Delay 1000
  Call ObjPropertyFindClick("contentText","Next","Button")
  aqUtils.Delay 2000
  
  'The Implement Screen Tab
  'Click the Capture Button
  Aqutils.Delay 7000
  Call ObjPropertyFindClick("contentText", "Capture", "Button")                   
                   
  aqUtils.Delay 2000
  'Click the Continue Button
  Call ObjPropertyFindClick("contentText", "CONTINUE", "Button")

  aqUtils.Delay 30000  
  Result = "pass"
  Reason = "Investment Details Captured On Quote"
  
  Else
  Result = "fail"
  Reason = "Investment Details Not Captured On Quote"
  End If
  
End Function 

Sub Tests12
Set InvestStartDatebtn = Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=6b189714-428d-4b7b-b361-39cd33ca6fa3#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(1).Panel(2).Panel(0).Panel(1).Panel(0).Button(0)
InvestStartDatebtn.Click
Call ObjPropertyFindClick("contentText", "next", "Button")
Set Tsts = Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=6b189714-428d-4b7b-b361-39cd33ca6fa3#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(1).Panel(2).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Table(0).Cell(2, 2).Button(0)
Sys.HighlightObject Tsts
Tsts.Click

Set DateOffisrtContri = Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=6b189714-428d-4b7b-b361-39cd33ca6fa3#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Button(0)
DateOffisrtContri.Click

Call ObjPropertyFindClick("contentText", "next", "Button")

Set SelectDay = Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=6b189714-428d-4b7b-b361-39cd33ca6fa3#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(1).Panel(0).Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Table(0).Cell(2, 2).Button(0)
Sys.HighlightObject SelectDay
SelectDay.Click
'##################################
Set FirstInstrDay  = Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=6b189714-428d-4b7b-b361-39cd33ca6fa3#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(2).Panel(0).Panel(1).Panel(0).Panel(1).Panel(1).Panel(0).Button(0)
FirstInstrDay.Click

Call ObjPropertyFindClick("contentText", "next", "Button")

Set SelectDay = Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=6b189714-428d-4b7b-b361-39cd33ca6fa3#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(0).Panel(0).Panel(1).Panel(0).Form("ctrl_form").Panel(2).Panel(0).Panel(1).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Table(0).Cell(3, 2).Button(0)
Sys.HighlightObject SelectDay 
SelectDay.Click
End Sub

'Author JM Kekana
'This Function returns the Current URL on the browser opened
'Looking at the Wealth.Momentum.co.za website
Function CurrentURL()
  'Check to see what Environment Are you supposed to point to on wealth
  IF TestEnvironment = "prod" Then
       'Check if the Environment is Prod and assign the variable the URL
       WealthURL = "https://wealth.momentum.co.za/wealth/wealth.html?token*"               
          ElseIf TestEnvironment = "pre" Then
           'Check if the Environment is Pre and assign the variable the URL 
           WealthURL = "https://wealthpre.momentum.co.za/wealth/wealth.html?token*"   
             'Check if the Environment is TST and assign the variable the URL
             ElseIf TestEnvironment = "test" Then
             WealthURL = "http://mdsonlinepre.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp"     
  End If

 Set browser = Sys.Browser("iexplore")
  ' Obtains the page currently opened in the browser
 Set objpage = browser.Page(WealthURL)
  ' Posts the URL of the currently open page to the log
 CurrentURL = objpage.URL 
' MsgBox CurrentURL
End Function

'This Function returns the Current URL on the browser opened
Function SetCurrentURL(Byval URL)
 Set browser = Sys.Browser("iexplore")
  ' Obtains the page currently opened in the browser
  Set objpage = browser.Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token*")
  ' Posts the URL of the currently open page to the log
 SetCurrentURL = objpage.URL 
End Function

'Author JM Kekana
'The aim of the function is to download documents by passing arguments 
'To click the link for downloading a docs and clicking the screen
Function DownloadDoc(Byval Btnlink, Byval Screen, Byval Docname)
  Dim browser
  Dim table
  'Call Browsers.Item(btIExplorer).Navigate("https://wealthpre.momentum.co.za/wealth/wealth.html?token=kantor#!/tools/quote/new")
  aqUtils.Delay 500
  Set browser = Aliases.browser
  Set table = browser.pageMomentumWealth.panelContainerRow.panelPanelCollapseCollapseIn.panelPanelBodyNgScope.panelMediaLeftPullLeft.panelPanelFooter.tableTableTableStripedTableNoBo
'  table.cellTextRight2.link.Click
  Btnlink.Click
  Call table.textnodeDownload.Click(66, 10)
  aqUtils.Delay 5000
  Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", Docname&"Download")
  'If the second screen has been opened then close it after the screenshot
  if Sys.Browser.BrowserWindow(1).Exists Then
  Sys.Browser().BrowserWindow(1).Close
  End If
  'browser.BrowserWindow2.Close
  'Click the Screen to shift focus back on the screen
  aqUtils.Delay 2000
  Screen.Click
  aqUtils.Delay 1500
End Function


Function UploadClientDocs1(Byval Doctype)
  Dim browser
  Dim table
  Dim browser2
  
  Set browser = Aliases.browser
  Set table = browser.pageMomentumWealth.panelContainerRow.frameWealthquotetooliframecontai.formCtrlForm.panelResponsiveTable.tableTableTableStripedTableNoBo
  'table.cellTextRight.link.Click 'Click the doc you want to upload
  Doctype.Click
  
  Call table.textnodeUpload.Click
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Click
  Call browser.dlgViewDownloadsInternetExplorer.OpenFile("C:\Users\johannes.kekana\Pictures\Beneficiary Screen\Delete Beneficiary Add Insure.PNG", "All Files (*.*)")
  Call browser2.Click
End Function


Function UploadComplianceDocs(Byval Doctype)
  Dim browser
  Dim table
  Dim browser2
'  Call Browsers.Item(btIExplorer).Navigate("https://wealthpre.momentum.co.za/wealth/wealth.html?token=kantor#!/tools/quote/new")
  Set browser = Aliases.browser
  Set table = browser.pageMomentumWealth.panelContainerRow.panelPanelCollapseCollapseIn.panelPanelBodyNgScope.panelMediaLeftPullLeft.panelPanelFooter.tableTableTableStripedTableNoBo
  'table.cellTextRight3.link.Click
  aqUtils.Delay 1500
  Doctype.Click
  aqUtils.Delay 1000
  Call table.textnodeDownload.Click
  aqUtils.Delay 1000
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Click
  Call browser.dlgViewDownloadsInternetExplorer.OpenFile("C:\Users\johannes.kekana\Pictures\Beneficiary Screen\Delete Beneficiary Add Insure.PNG", "All Files (*.*)")
  Call browser2.Click
End Function

Function UploadClientDocs(Byval Doctype)
  Dim browser
  Dim panel
  Dim table
 ' Call Browsers.Item(btIExplorer).Navigate("https://wealthpre.momentum.co.za/wealth/wealth.html?token=kantor#!/tools/quote/new")
  aqUtils.Delay 1500
  Set browser = Aliases.browser
  Set panel = browser.pageMomentumWealth.panelContainerRow
  Set table = panel.frameWealthquotetooliframecontai.formCtrlForm.panelResponsiveTable.tableTableTableStripedTableNoBo
  'table.cellTextRight.link.Click
  aqUtils.Delay 500
  Doctype.Click
  aqUtils.Delay 1500
  Call table.textnodeUpload.Click(101, 6)
  aqUtils.Delay 1000
  Call browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser.Click(708, 302)
  Call browser.dlgViewDownloadsInternetExplorer.OpenFile("C:\Users\johannes.kekana\Pictures\Beneficiary Screen\Delete Beneficiary Add Insure.PNG", "All Files (*.*)")
  Call panel.panelPanelCollapseCollapseIn.panelPanelBodyNgScope.panelMediaLeftPullLeft.panelPanelFooter.tableTableTableStripedTableNoBo.panelOverlayNgTnsC399.HoverMouse(1179, 348)
  Call table.buttonUpload.Click(32, 12)
End Function

Sub Test1
'Close_Process_Instances("iexplore")
' Sys.Browser("iexplore,2").BrowserWindow(0).SetFocus
 
 Sys.Browser("iexplore").BrowserWindow(0).Close
' Aliases.browser.BrowserWindow.Window("Client Caption", "", 1).Close
 Set p = Sys.FindChild("ProcessName", "Client Caption")
 p.Close

Sys.Browser("iexplore", 2).BrowserWindow(0).Window("Client Caption", "", 1).Close

'MsgBox CurrentURL
Call Close_Process_Instances("AcroRd32")


Set TestWindow = Sys.Browser("iexplore").BrowserWindow(0).Window("Frame Notification Bar", "", 1).UIAObject("Notification")

Sys.HighlightObject TestWindow
TestWindow.Keys("~o")

Set btnSave = Sys.Browser("iexplore").BrowserWindow(0).Window("Frame Notification Bar", "", 1).UIAObject("Notification").UIAObject("Open")
btnSave.Click
Set Joe = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Label(0)
' Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Label(0)  
Joe.Click


                           'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Label(0)
  Set ContributionPayerNo = Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(1).Label(0) 
      
                           'Sys.Browser("iexplore").Page(CurrentURL).Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(1).Label(0)
  
  Sys.HighlightObject ContributionPayerNo
  
  ContributionPayerNo.Click

Call ObjPropertyFindClick("contentText", "CONTINUE", "Button")
  
End Sub


'Author JM Kekana
'Function to add another Financial Advisor
Function AddAnotherFA(Byval Panelval)

'Click the Add Another Financial Adviser Button
Call ObjPropertyFindClick("contentText", "Add another financial adviser", "Button")
Call ObjPropertyFindEnterText("idStr","fspHouseCodeInput_1","INPUT","039999")

Call ObjPropertyFindEnterText("idStr","financialAdviserCodeInput_1","INPUT","065555")
aqUtils.delay 3500

  MarketingADCodeCheckval = ObjPropertyFindGetText("idStr","marketingAdviserCodeInput", "INPUT")  
  'aqObject.GetPropertyValue(MarketingADCode, "wText")  
  'Check to see if the Marketing AdviseCode is not Blank

  If MarketingADCodeCheckval <> "" Then
  Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", MarketingAdviseCodeCheckval&"ADDAnotherAdviseCodeFound") 
  Else
  Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "ADDAnotherAdviseCodeNotFound")
  End IF
  'Advise fee percentage Split 

  Call ObjPropertyFindEnterText("idStr","feeSplitPercentage_0","INPUT","30")

  Call ObjPropertyFindEnterText("idStr","feeSplitPercentage_1","INPUT","70")
  aqUtils.delay 2500
  
   PercentageTotalCheckval = ObjPropertyFind("contentText","The sum of the financial advisers' fees doesn't add up to 100%", "SPAN") 
  'aqObject.GetPropertyValue(PercentageTotal, "wText")
  'Check to see if the values adds to 100
  IF PercentageTotalCheckval = True Then
  Call SaveScreenShot(strFormatDate, TestCaseName, "Pass", "PercentageNot100")
  Else
  Call SaveScreenShot(strFormatDate, TestCaseName, "Fail", "Percentage100")
  End IF
  
End Function
