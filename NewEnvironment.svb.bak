Dim Excel, Result, Reason, Username1, Environment, Browser
 
'Get the name of the person who ran the test
Set Username1 = CreateObject("Wscript.Network")
 
Reason = "Reason"
Sub DriverScript
'This is to close all the instances of excel before open new ones

Call Close_Excel_Instances("Excel")
aqUtils.Delay 1000
'Read from the TestSuite Controller 
Set objFileRead = CreateObject("Scripting.FileSystemObject").OpenTextFile("C:\Testing\TestSuite\Test.txt",1)
Dim strLine,strLine1
Do While Not objFileRead.AtEndOfStream


strLine = objFileRead.ReadLine()
read = Split(strLine,"||") 
	
	if read(2) = "1" Then
	'Select the TestSuite that we want to Execute
  ' MsgBox "Test Suite that has been selected for execution :" &read(0)
 
	Dim RowCount, ColumnCount, i, j, s
 
  'Set Excel = Sys.OleObject("Excel.Application")
	Set Excel = CreateObject("Excel.Application")
  Excel.Workbooks.Open("C:\Testing\TestSuite\"&read(0)&".xlsx")
  'Excel.ActiveSheet("MainSheet").Activate
	Excel.WorkSheets("MainSheet").Activate
	RowCount = Excel.ActiveSheet.UsedRange.Rows.Count
  ColumnCount = Excel.ActiveSheet.UsedRange.Columns.Count
  
	  For i = 2 To RowCount
    'Check if the test has been selected for automation
	  If Excel.Cells(i,3) = "Y"  Then	
		Excel.Cells(i,3).Value = "N"	
		Excel.Cells(i,13).Value = "In Progress"
		Excel.Cells(i,13).Interior.Color =  RGB(0,0,255)
	    		For j = 4 To 12
          'Execute the selected function in the process
          
          if Excel.Cells(i,j) <> "" Then
          'Msgbox(Excel.Cells(i,j))
	     	 	Eval(Excel.Cells(i,j))
			    End If
			  	if Result = "fail" Then
          
				  'Activate the Mainsheet after the result is returned
					Excel.WorkSheets("MainSheet").Activate
          log.Message (" Test Suite:  "& read(0)& Excel.Cells(i,1)&"Failed at"& Excel.Cells(i,j))
					Excel.Cells(i,13).Value = "Fail"
					Excel.Cells(i,14).Value = "Failed at :"&Excel.Cells(i,j)&Reason
					Excel.Cells(i,13).Interior.Color = RGB(255,0,0)
					Excel.Cells(i,15).Value = "Last Execution :" &Now()
          Excel.Cells(i,16).Value = Username1.UserName
					Log.Picture Sys.Desktop.ActiveWindow, "Message Text", "Extended Message Text", pmHighest
					'Exit the process cos of failure - To move onto the next test in the test suite
					 Exit For
					Else	
          'Activate the mainsheet that controls the test
					'Excel.ActiveSheet("MainSheet").Activate
					Excel.WorkSheets("MainSheet").Activate
					Excel.Cells(i,13).Value = "Pass"
					Excel.Cells(i,13).Interior.Color =  RGB(0,255,0)
					'Clear the comments if there is no failure
					Excel.Cells(i,14).Value = " "
					Excel.Cells(i,15).Value = "Last Execution :" &Now()
          Excel.Cells(i,16).Value = Username1.UserName			
					End If

    			Next
		Else
		Excel.Cells(i,3).Value = "Not selected for execution"
    
	  End If 

  Next  
 			' Excel.Workbooks.SAVE 	
			Excel.ActiveWorkBook.Save	
		  Excel.Quit
 End If

Loop

objFileRead.Close
Set objFileRead = Nothing 
Call Log.SaveResultsAs("C:\TestResult\"&Date()&"Log.mht", lsMHT)
End Sub

Function Close_Excel_Instances(Byval applica)
  Dim p, isClosed
  ' Obtains the notepad.exe process
  Set p = Sys.FindChild("ProcessName", applica)

  ' until all of them are closed
  While p.Exists
    p.Close
    ' Waits until the process is closed
    isClosed = p.WaitProperty("Exists", False)
    ' Checks whether the process has been closed successfully
    If Not isClosed Then
      ' Terminates the process
      p.Terminate
    End If

    ' Obtains another instance of the notepad.exe process
    Set p = Sys.FindChild("ProcessName", applica)
  Wend
End Function


Function ProcessCreate(Byval test, Byval env, Byval Prodtype)
  Dim Process
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
'	str1 = str
 ' msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else     
     Process = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

  Dim browser,section, panel, textbox, button

    Browsers.Item("iexplore").Run()
  aqUtils.Delay 2000

    'Maximize the screen
  Sys.Browser().BrowserWindow(0).Maximize
  'Re Direct to the correct screen
  Call Browsers.Item(btIExplorer, "", Browsers.pX64).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/processSearch")
    
'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/processSearch")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set panel = section.formFormHorizontalNgUntouchedNg.panelFormGroup
  Call panel.panelCheckboxColSm3.checkboxCreateNewProcess.Click(10, 13)
  Set textbox = panel.panelColSm9.textboxProcessId
  Call textbox.Click(37, 12)
  Call textbox.SetText(Process)
  Call browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser.Click(1138, 268)
 ' Select the product that you want to select
 Set vselect = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup.panelColSm9.panelModalContent.selectProductType
 if Prodtype = "FEO"  Then 
 
    Call vselect.ClickItem("Flexible endowment option")
  'Call browser.ToUrl("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/processSearch")
    Elseif Prodtype = "FIO"   Then
    Call vselect.ClickItem("Flexible investment option")
    Elseif Prodtype = "FTFO"  Then
    Call vselect.ClickItem("Flexible tax free option")
   Elseif Prodtype = "RAO" Then
    Call vselect.ClickItem("Retirement annuity option")
   Elseif Prodtype = "RIO"  Then
    Call vselect.ClickItem("Retirement income option")
   Elseif Prodtype = "RPO" Then
    Call vselect.ClickItem("Retirement preservation option")
  End If 
'  Call browser.pageWwwGoogleCoZa.panelAls.Click(1183, 17)
  Set button = section.buttonCreateAndLoadProcess
  Call button.Click
 aqUtils.Delay 2000 
  if textbox.Exists Then
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/processSearch").Section(0).Panel(1).Panel(0).Button(0).Click
  ' Call button.Click
  ' ElseIf button.Exists Then
   'Do nothing
  End If 
  
End Function
'Load Process Function Pass it the row and enviroment
Function LoadProcess(Byval test, Byval env)

  Dim Process
  Excel.WorkSheets("LoadProcess1").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then

		 Else     
     ProcessId = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

  Dim section, textbox
  
  Browsers.Item("iexplore").Run()
  aqUtils.Delay 2000

    'Maximize the screen
  Sys.Browser().BrowserWindow(0).Maximize
  'Re Direct to the correct screen
  Call Browsers.Item(btIExplorer, "", Browsers.pX64).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")
  
   
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")
  Set section = Aliases.browser.pageNewBusinessCapture2.section
  Set textbox = section.formFormHorizontalNgUntouchedNg.panelFormGroup.panelColSm9.textboxProcessId
  Call textbox.Click(24, 26)
  Call textbox.SetText(ProcessId)
  'Call textbox.Keys(ProcessId)
  Call section.buttonCreateAndLoadProcess.ClickButton
  
End Function

Function CaptureClientD(Byval val,Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section

  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click
  
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  if panel.selectTitle.Exists Then
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.selectTitle.ClickItem(Title&"*")
'  Call panel.selectTitle.ClickItem(Title&"*")
  Call aqObject.CheckProperty(panel.selectTitle, "wText", cmpEqual, Title, False)

  Set textbox = panel.panelColSm3.textboxInitials
 ' Call textbox.Click(34, 26)
  Call textbox.SetText(Initials)
  Call aqObject.CheckProperty(textbox, "wText", cmpEqual, Initials, False)

  'Call textbox.Keys("[Tab]")
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  Call textbox2.SetText(Fullname)
  Call aqObject.CheckProperty(textbox2, "wText", cmpEqual, Fullname, False)
  'Call textbox2.Keys("[Tab]")
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  Call textbox2.SetText(PreferName)
  Call aqObject.CheckProperty(textbox2, "wText", cmpEqual, PreferName, False)
  'Call textbox2.Keys("[Tab]")
  'Call textbox.Click(28, 8)
  'Call textbox.SetText("J")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  Call textbox.Click(99, 34)
  Call textbox.SetText(Surname)
    Call aqObject.CheckProperty(textbox, "wText", cmpEqual, Surname, False)
 ' Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panel.panelFormGroup.buttonYes. 
 'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.Panel(6).Panel(0).Panel(0).Textbox("passportNumberInput")
 'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.Panel(6).Panel(1).Panel(0).Select("passportCountryOfIssueInput")
  Call form.buttonRsaIdNumber.Click(11, 11)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  Call textbox.Click(220, 16)
  

  Call textbox.SetText(Idnumber)
  Call aqObject.CheckProperty(textbox, "wText", cmpEqual, Idnumber, False)
  Set button2 = form.buttonSouthAfrican
  
  Nationality = Excel.Cells(b,9)
  
  If Nationality = "SA" Then
  Call button2.Click(9, 10)
  Else
  Call form.buttonNonSouthAfrican.Click(18, 10)
  Call button2.Click(8, 3)
  End If
 
 Gender = Excel.Cells(b,10)
 
 If Gender = "Female" Then
  Call form.radiobuttonFemale.Click(18, 5)
  Else  
 Call form.buttonMale.Click(16, 8) 
 End If
 
 
  Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  PEP = Excel.Cells(b,11)

   
  If PEP = "Yes" Then
'  MsgBox "Selected"
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Call form2.buttonYes.Click
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  Call browser2.Drag(1359, 282, 6, 89)
  
  Else 
 '       MsgBox "Its A No"
        Set form2 = form.formFormHorizontalNgUntouchedNg
        Call form2.buttonNo.Click(12, 9)
  End if 
  'Call button.Click(53, 17)
  'set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)

  set UpdateBtn =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails")
'  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
      UpdateBtn.Click
      
      
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")   
  Result = "pass"
  
  Else
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")  
  Result = "fail"
  End If 
End Function

Function Contactdetails(Byval val,Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,18)
     TelW = Excel.Cells(b,19)
     Cell = Excel.Cells(b,20)
     Fax = Excel.Cells(b,21)
     Email = Excel.Cells(b,22)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set button = section.buttonCreateAndLoadProcess
 ' Set obj = Aliases.browser.pageNewBusinessCapture2.section.buttonCreateAndLoadProcess.textnodeView
'  Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0)
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click

'  Set tst1 = obj.Find("sourceIndex","103", 2)
'  tst1.Click
  'Call button.textnodeView.Click
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  'if panel.selectTitle.Exists Then
  
  'Call panel.selectTitle.ClickItem(Title)
  'Set textbox = panel.panelColSm3.textboxInitials
 ' Call textbox.Click(34, 26)
  'Call textbox.SetText(Initials)
  'Call textbox.Keys("[Tab]")
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  'Call textbox2.SetText(Fullname)
  'Call textbox2.Keys("[Tab]")
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  'Call textbox2.SetText(PreferName)
  'Call textbox2.Keys("[Tab]")
  'Call textbox.Click(28, 8)
  'Call textbox.SetText("J")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  'Call textbox.Click(99, 34)
  'Call textbox.SetText(Surname)
  'Call form.buttonRsaIdNumber.Click(11, 11)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  'Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  'Call textbox.Click(220, 16)
  'Call textbox.Keys("[Up]")
  'Call textbox.SetText("")
  'Call textbox.Keys("[Home]")
  'Call textbox.SetText(Idnumber)
  Set button2 = form.buttonSouthAfrican
  'Call button2.Click(9, 10)
  'Call form.buttonNonSouthAfrican.Click(18, 10)
  'Call button2.Click(8, 3)
  'Call form.radiobuttonFemale.Click(18, 5)
  'Call form.buttonMale.Click(16, 8)
  'Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  'Call form2.buttonNo.Click(12, 9)
  'Call form2.buttonYes.Click(6, 11)
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  'Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  'Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  'Call browser2.Drag(1359, 282, 6, 89)
  'Call button.Click(53, 17)
  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
   '   UpdateBtn.Click
      
  'Call browser2.Drag(1360, 374, 5, 176)
  Set panel6 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Call panel6.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(835, 29)
  Set button2 = form.buttonEnglish
  language = Excel.Cells(b,16)
  if language = "English" Then
  Set button2 = form.buttonEnglish
  Call button2.Click(15, 15)
  Else   
  Call form.buttonAfrikaans.Click(6, 21)
  'Call button2.Click(11, 17)
  
  End If
  CommMethod =  Excel.Cells(b,17)
  if CommMethod = "Post" Then
  Call panel.buttonPost.Click(13, 22)
  Else 
  Call panel2.buttonEmail.Click(15, 13)
  End If
  Call browser2.Drag(1358, 233, 7, 101)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
'  Call textbox.Click(226, 31)
  Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Call textbox.Click(22, 25)
  Call textbox.SetText(TelH)
  Call form.Click(308, 243)
  Set textbox = panel4.panelColSm4.textboxCellphone
  'Call textbox.Click(125, 22)
  Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  'Call textbox.Click(42, 22)
  Call textbox.SetText(Fax)
  Set panel = form.panelFormGroup5.panelColSm4
  Set emailInput = panel.emailinputEmail
  'Call emailInput.Click(240, 16)
  Call emailInput.SetText(Email)
  Call browser2.Drag(1357, 335, 8, 145)
  'The Adress Section
  
  Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.Click(12, 11)
  Set form2 = form.formFormNgUntouchedNgPristineN2
  Set textbox = form2.panelFormGroup.panelColSm8.textboxLine1
  'Call textbox.Click(220, 15)
  'textbox.ClickR
  Line1 = Excel.Cells(b,23)  
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  'lin1.DblClickM
  lin1.SetText(Line1)
  'Call textbox.SetText(Line1)
  Set textbox = form2.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox.Click(132, 5)
  Line2 = Excel.Cells(b,24)
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  'lin2.DblClickM
  lin2.SetText(Line2)
  'Call textbox.SetText(Line2)
  Set textbox = form2.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox.Click(82, 31)
  Line3 = Excel.Cells(b,25)
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  'lin3.DblClickM
  lin3.SetText(Line3)
  'Call textbox.SetText(Line3)
  Set textbox = form2.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox.Click(44, 20)
  City = Excel.Cells(b,26)
  Set cit = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  'cit.DblClickM
  cit.SetText(City)
  'Call textbox.SetText(City)
  Set textbox = form2.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox.Click(26, 25)
  PostCode = Excel.Cells(b,27)
  Set Code = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  'Code.DblClickM
  Code.SetText(PostCode)
  'Call textbox.SetText(PostCode)
  Set textbox = form2.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox.Click(5, 36)
  Province = Excel.Cells(b,28)
  Set provinc = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  'provinc.DblClickM
  provinc.SetText(Province)
  'Call textbox.SetText(Province)
  Call browser2.Drag(1361, 430, 3, 67)
  Set vselect = form2.selectCountry
  Country = Excel.Cells(b,29)
  Set Countr = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.selectCountrycodePhysical
  Countr.ClickItem(Country)
  'Call vselect.ClickItem(Country)
 ' Call vselect.ClickItem("Select..")
 'Have to get the Full Name
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
 '  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click 
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails").Click
  
  'Call button.Click(28, 21)
  
  
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")  

End Function 

Function ClientDetails(Byval val,Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
 ' Set button = section.buttonCreateAndLoadProcess
 ' Set obj = Aliases.browser.pageNewBusinessCapture2.section.buttonCreateAndLoadProcess.textnodeView
'  Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0)
'  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0).Click
'  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click
  
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Button("viewClientDetails").Click
'  Set tst1 = obj.Find("sourceIndex","103", 2)
'  tst1.Click

  'Call button.textnodeView.Click
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  if panel.selectTitle.Exists Then
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.selectTitle.ClickItem(Title&"*")
'  Call panel.selectTitle.ClickItem(Title&"*")
  
  Set textbox = panel.panelColSm3.textboxInitials
 ' Call textbox.Click(34, 26)
  Call textbox.SetText(Initials)
  'Call textbox.Keys("[Tab]")
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  Call textbox2.SetText(Fullname)
  'Call textbox2.Keys("[Tab]")
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  Call textbox2.SetText(PreferName)
  
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  Call textbox.Click(99, 34)
  Call textbox.SetText(Surname)
  Call form.buttonRsaIdNumber.Click(11, 11)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  Call textbox.Click(220, 16)

  Call textbox.SetText(Idnumber)
  Set button2 = form.buttonSouthAfrican
  Call button2.Click(9, 10)
  Call form.buttonNonSouthAfrican.Click(18, 10)
  Call button2.Click(8, 3)
  Call form.radiobuttonFemale.Click(18, 5)
  Call form.buttonMale.Click(16, 8)
  Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Call form2.buttonNo.Click(12, 9)
  Call form2.buttonYes.Click(6, 11)
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  Call browser2.Drag(1359, 282, 6, 89)
  'Call button.Click(53, 17)
  'set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails")   
 ' set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
      UpdateBtn.Click
      
  Call browser2.Drag(1360, 374, 5, 176)
  Set panel6 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Call panel6.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(835, 29)
  Set button2 = form.buttonEnglish
  Call button2.Click(15, 15)
  Call form.buttonAfrikaans.Click(6, 21)
  Call button2.Click(11, 17)
  Call panel.buttonPost.Click(13, 22)
  Call panel2.buttonEmail.Click(15, 13)
  Call browser2.Drag(1358, 233, 7, 101)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
'  Call textbox.Click(226, 31)
  Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Call textbox.Click(22, 25)
  Call textbox.SetText(TelH)
  Call form.Click(308, 243)
  Set textbox = panel4.panelColSm4.textboxCellphone
  'Call textbox.Click(125, 22)
  Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  'Call textbox.Click(42, 22)
  Call textbox.SetText(Fax)
  Set panel = form.panelFormGroup5.panelColSm4
  Set emailInput = panel.emailinputEmail
  'Call emailInput.Click(240, 16)
  Call emailInput.SetText(Email)
  Call browser2.Drag(1357, 335, 8, 145)
  'The Address Section
  
  Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.Click(12, 11)
  Set form2 = form.formFormNgUntouchedNgPristineN2
  Set textbox = form2.panelFormGroup.panelColSm8.textboxLine1
  'Call textbox.Click(220, 15)
  Line1 = Excel.Cells(b,21)  
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  lin1.SetText(Line1)

  'Call textbox.SetText(Line1)
  Set textbox = form2.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox.Click(132, 5)
  Line2 = Excel.Cells(b,22)
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  lin2.SetText(Line2)

 ' Call textbox.SetText(Line2)
  Set textbox = form2.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox.Click(82, 31)
  Line3 = Excel.Cells(b,23)
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  lin3.SetText(Line3)

  'Call textbox.SetText(Line3)
  Set textbox = form2.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox.Click(44, 20)
  City = Excel.Cells(b,24)
  Set cit = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  cit.SetText(City)
  'Call textbox.SetText(City)
  Set textbox = form2.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox.Click(26, 25)
  PostCode = Excel.Cells(b,25)
  Set Code = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  Code.SetText(PostCode)    
  'Call textbox.SetText(PostCode)
  Set textbox = form2.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox.Click(5, 36)
  Province = Excel.Cells(b,26)
  Set provinc = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  provinc.SetText(Province)

  'Call textbox.SetText(Province)
  Call browser2.Drag(1361, 430, 3, 67)
  Set vselect = form2.selectCountry
  Country = Excel.Cells(b,27)
  Set Countr = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.selectCountrycodePhysical
  Countr.ClickItem(Country)

' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails").Click
  'Call button.Click(28, 21)
  Call browser2.Drag(1356, 417, 6, 90)
  'This is the banking Section
  Call panel6.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Click(561, 27)
  Call browser2.Drag(1359, 292, 6, 112)
  Set vselect = form.selectAccountHolderRelationship
  AccHolder = Excel.Cells(b,29)
  Call vselect.ClickItem(AccHolder)
  Set vselect = panel2.selectBankName
  BankName = Excel.Cells(b,30)
  Call vselect.ClickItem(BankName)
  Set vselect = form.selectBranchName
  'Call vselect.ClickItem("Select...")
  BranchName = Excel.Cells(b,31)
  Call vselect.ClickItem(Branchname)
  AccType = Excel.Cells(b,32)
  Call form.selectAccountType.ClickItem(AccType)
  Set textbox = panel.textboxBranchNumber
  BranchNum = Excel.Cells(b,33) 
  Call textbox.SetText(BranchNum)
  'AccNo = Excel.Cells(b,34) 
  Set textbox = panel5.textboxAccountNumber
  'Call textbox.Click(156, 7)
  AccNo = Excel.Cells(b,34) 
  Call textbox.SetText(AccNo)
  Call browser2.Drag(1356, 500, 6, 96)
  'Have to get the Button Fullname Banking Details
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonBankingDetails").Click
  'Call button.Click(29, 18)
  Call browser2.Drag(1360, 380, 5, 114)
  'Banking Section
  Call panel6.panelPanelPanelDefault3.panelPanelHeading.panelTaxDetails.Click(1052, 13)
  Call browser2.Drag(1357, 395, 8, 119)
  Call form.buttonNo.Click(9, 8)
  Set button2 = form.buttonYes
  Call button2.Click(15, 10)
  Call button2.HoverMouse(15, 11)
  Set textbox = panel2.textboxSarsTaxReference
  'Call textbox.Click(29, 11)
  TaxRef = Excel.Cells(b,37)
  Call textbox.SetText(TaxRef)
  Call browser2.Drag(1361, 379, 3, 145)
  Call form.buttonNo2.Click(10, 6)
  Call panel4.buttonNo.Click(13, 13)
  'Click the Object Using the FullName 
 ' Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
 
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonTaxDetails").Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click

 ' Call button.Click(57, 10)
  Call browser2.Drag(1357, 486, 2, 32)
  'Have to click the Product Details Update Button
  '
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("productDetails").Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click  
  'Call button.Click(49, 13)
  
  Set btn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(0).TextNode(0)
  
  If btn.Exists Then
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(1).Click  
  End IF
  
  Result = "pass"
  Else
  Result = "pass"
  End If    
End Function

Function TaxDetails(Byval val, Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("TaxDetails").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
 ' Set button = section.buttonCreateAndLoadProcess
 ' Set obj = Aliases.browser.pageNewBusinessCapture2.section.buttonCreateAndLoadProcess.textnodeView
 Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click
'  Set tst1 = obj.Find("sourceIndex","103", 2)
'  tst1.Click
  'Call button.textnodeView.Click
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  if panel.selectTitle.Exists Then
  
  'Call panel.selectTitle.ClickItem(Title)
  Set textbox = panel.panelColSm3.textboxInitials
 ' Call textbox.Click(34, 26)
  'Call textbox.SetText(Initials)
  'Call textbox.Keys("[Tab]")
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  'Call textbox2.SetText(Fullname)
  'Call textbox2.Keys("[Tab]")
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  'Call textbox2.SetText(PreferName)
  'Call textbox2.Keys("[Tab]")
  'Call textbox.Click(28, 8)
  'Call textbox.SetText("J")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  'Call textbox.Click(99, 34)
  'Call textbox.SetText(Surname)
  'Call form.buttonRsaIdNumber.Click(11, 11)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  'Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  'Call textbox.Click(220, 16)
  'Call textbox.Keys("[Up]")
  'Call textbox.SetText("")
  'Call textbox.Keys("[Home]")
  'Call textbox.SetText(Idnumber)
  Set button2 = form.buttonSouthAfrican
  'Call button2.Click(9, 10)
  'Call form.buttonNonSouthAfrican.Click(18, 10)
  'Call button2.Click(8, 3)
  'Call form.radiobuttonFemale.Click(18, 5)
  'Call form.buttonMale.Click(16, 8)
  'Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  'Call form2.buttonNo.Click(12, 9)
  'Call form2.buttonYes.Click(6, 11)
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  'Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  'Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  'Call browser2.Drag(1359, 282, 6, 89)
  'Call button.Click(53, 17)
  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
  '   UpdateBtn.Click
      
  'Call browser2.Drag(1360, 374, 5, 176)
  Set panel6 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  'Call panel6.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(835, 29)
  Set button2 = form.buttonEnglish
  'Call button2.Click(15, 15)
  'Call form.buttonAfrikaans.Click(6, 21)
  'Call button2.Click(11, 17)
  'Call panel.buttonPost.Click(13, 22)
  'Call panel2.buttonEmail.Click(15, 13)
  'Call browser2.Drag(1358, 233, 7, 101)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
'  Call textbox.Click(226, 31)
  'Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Call textbox.Click(22, 25)
  'Call textbox.SetText(TelH)
  'Call form.Click(308, 243)
  Set textbox = panel4.panelColSm4.textboxCellphone
  'Call textbox.Click(125, 22)
  'Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  'Call textbox.Click(42, 22)
  'Call textbox.SetText(Fax)
  Set panel = form.panelFormGroup5.panelColSm4
  Set emailInput = panel.emailinputEmail
  'Call emailInput.Click(240, 16)
  'Call emailInput.SetText(Email)
  'Call browser2.Drag(1357, 335, 8, 145)
  'The Adress Section
  
  'Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.Click(12, 11)
  Set form2 = form.formFormNgUntouchedNgPristineN2
  Set textbox = form2.panelFormGroup.panelColSm8.textboxLine1
  'Call textbox.Click(220, 15)
  Line1 = Excel.Cells(b,21)  
  'Call textbox.SetText(Line1)
  Set textbox = form2.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox.Click(132, 5)
  Line2 = Excel.Cells(b,22)
  'Call textbox.SetText(Line2)
  Set textbox = form2.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox.Click(82, 31)
  Line3 = Excel.Cells(b,23)
  'Call textbox.SetText(Line3)
  Set textbox = form2.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox.Click(44, 20)
  City = Excel.Cells(b,24)
  'Call textbox.SetText(City)
  Set textbox = form2.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox.Click(26, 25)
  PostCode = Excel.Cells(b,25)
  'Call textbox.SetText(PostCode)
  Set textbox = form2.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox.Click(5, 36)
  Province = Excel.Cells(b,26)
  'Call textbox.SetText(Province)
  'Call browser2.Drag(1361, 430, 3, 67)
  Set vselect = form2.selectCountry
  Country = Excel.Cells(b,27)
  'Call vselect.ClickItem(Country)
 ' Call vselect.ClickItem("Select..")
  'Have to get the Full Name
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  'Call button.Click(28, 21)
'  Call browser2.Drag(1356, 417, 6, 90)
  'This is the banking Section
'  Call panel6.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Click(561, 27)
'  Call browser2.Drag(1359, 292, 6, 112)
  Set vselect = form.selectAccountHolderRelationship
  AccHolder = Excel.Cells(b,31)
'  Call vselect.ClickItem(AccHolder)
  Set vselect = panel2.selectBankName
  BankName = Excel.Cells(b,32)
'  Call vselect.ClickItem(BankName)
  Set vselect = form.selectBranchName
  'Call vselect.ClickItem("Select...")
  BranchName = Excel.Cells(b,33)
'  Call vselect.ClickItem(Branchname)
  AccType = Excel.Cells(b,34)
'  Call form.selectAccountType.ClickItem(AccType)
  Set textbox = panel.textboxBranchNumber
  BranchNum = Excel.Cells(b,35) 
'  Call textbox.SetText(BranchNum)
  'AccNo = Excel.Cells(b,34) 
  Set textbox = panel5.textboxAccountNumber
  'Call textbox.Click(156, 7)
  AccNo = Excel.Cells(b,36) 
'  Call textbox.SetText(AccNo)
'  Call browser2.Drag(1356, 500, 6, 96)
  'Have to get the Button Fullname
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  'Call button.Click(29, 18)
 ' Call browser2.Drag(1360, 380, 5, 114)
  'Banking Section
  Call panel6.panelPanelPanelDefault3.panelPanelHeading.panelTaxDetails.Click(1052, 13)
  Call browser2.Drag(1357, 395, 8, 119)
  Call form.buttonNo.Click(9, 8)
  Set button2 = form.buttonYes
  Call button2.Click(15, 10)
  Call button2.HoverMouse(15, 11)
  Set textbox = panel2.textboxSarsTaxReference
  'Call textbox.Click(29, 11)
  TaxRef = Excel.Cells(b,4)
  Call textbox.SetText(TaxRef)
  Call browser2.Drag(1361, 379, 3, 145)
  Call form.buttonNo2.Click(10, 6)
  Call panel4.buttonNo.Click(13, 13)
  'Click the No Button on the Tax Details
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Form(0).Panel(0).Panel(1).Label(0).Click
  
  'Click the Object Using the FullName 
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  
 ' Call button.Click(57, 10)
  Call browser2.Drag(1357, 486, 2, 32)
  'Have to click the Product Details Update Button
  '
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonTaxDetails").Click
  
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click  
  'Call button.Click(49, 13)
  Set btn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(0).TextNode(0)
  
  If btn.Exists Then
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(1).Click  
  End IF
  
  Result = "pass"
  Else
  Result = "pass"
  End If    
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")
End Function

Function Banking(Byval val, Byval env)

  Dim Title, Initials, Fullname, PreferName, Surname, Idnumber,TelH, TelW, Cell, Fax, Email
  Dim Line1, Line2, Line3, City, PostalCode, Province, Country
  Dim AccHolder, Bank, Branchname, AccType, BranchNum, AccNo
  Dim TaxPayer, TaxRefNo
  
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
	str1 = str
'  msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(val) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else   
     'Client Details  
     Title = Excel.Cells(b,3)
     Initials = Excel.Cells(b,4)
     Fullname = Excel.Cells(b,5)
     PreferName = Excel.Cells(b,6)
     Surname = Excel.Cells(b,7)
     Idnumber = Excel.Cells(b,8)
     TelH = Excel.Cells(b,16)
     TelW = Excel.Cells(b,17)
     Cell = Excel.Cells(b,18)
     Fax = Excel.Cells(b,19)
     Email = Excel.Cells(b,20)
      
		  Exit For	
		End If		
	Next

  Dim browser, section, button, form, panel, textbox, panel2, textbox2, panel3, panel4, browser2 
  Dim panel5, button2, form2, panel6, emailInput, vselect

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set button = section.buttonCreateAndLoadProcess
 ' Set obj = Aliases.browser.pageNewBusinessCapture2.section.buttonCreateAndLoadProcess.textnodeView
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal").Section(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Section(1).Panel(0).Button("viewClientDetails").Click
'  Set tst1 = obj.Find("sourceIndex","103", 2)
'  tst1.Click
  'Call button.textnodeView.Click
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  
  if panel.selectTitle.Exists Then
  
  Set textbox = panel.panelColSm3.textboxInitials
 
  Set panel = form.panelFormGroup
  Set panel2 = panel.panelColSm9
  Set textbox2 = panel2.textboxFullNames
  Set panel3 = form.panelFormGroup3
  Set textbox2 = panel3.panelColSm9.textboxPreferredName
  
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  'Call browser2.Drag(1355, 344, 3, 108)
  Set panel5 = form.panel.panelFormGroup
  Set textbox = panel5.panelColSm9.textboxIdNumber
  'Call textbox.Click(220, 16)
  'Call textbox.Keys("[Up]")
  'Call textbox.SetText("")
  'Call textbox.Keys("[Home]")
  'Call textbox.SetText(Idnumber)
  Set button2 = form.buttonSouthAfrican
  'Call button2.Click(9, 10)
  'Call form.buttonNonSouthAfrican.Click(18, 10)
  'Call button2.Click(8, 3)
  'Call form.radiobuttonFemale.Click(18, 5)
  'Call form.buttonMale.Click(16, 8)
  'Call browser2.Drag(1356, 443, 9, 83)
  Set form2 = form.formFormHorizontalNgUntouchedNg
  'Call form2.buttonNo.Click(12, 9)
  'Call form2.buttonYes.Click(6, 11)
  Set panel6 = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  'Call panel6.panelCheckboxColSm6.checkboxHeadOfState.Click(11, 4)
  'Call panel6.panelCheckboxColSm62.checkboxCabinetMinister.Click(8, 3)
  'Call browser2.Drag(1359, 282, 6, 89)
  'Call button.Click(53, 17)
  set UpdateBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0)
   '   UpdateBtn.Click
      
  'Call browser2.Drag(1360, 374, 5, 176)
  Set panel6 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  'Call panel6.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(835, 29)
  Set button2 = form.buttonEnglish
  'Call button2.Click(15, 15)
  'Call form.buttonAfrikaans.Click(6, 21)
  'Call button2.Click(11, 17)
  'Call panel.buttonPost.Click(13, 22)
  'Call panel2.buttonEmail.Click(15, 13)
  'Call browser2.Drag(1358, 233, 7, 101)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
'  Call textbox.Click(226, 31)
  'Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
 ' Call textbox.Click(22, 25)
  'Call textbox.SetText(TelH)
  'Call form.Click(308, 243)
  Set textbox = panel4.panelColSm4.textboxCellphone
  'Call textbox.Click(125, 22)
  'Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  'Call textbox.Click(42, 22)
  'Call textbox.SetText(Fax)
  Set panel = form.panelFormGroup5.panelColSm4
  Set emailInput = panel.emailinputEmail
  'Call emailInput.Click(240, 16)
  'Call emailInput.SetText(Email)
  'Call browser2.Drag(1357, 335, 8, 145)
  'The Adress Section
  
  'Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.Click(12, 11)
  Set form2 = form.formFormNgUntouchedNgPristineN2
  Set textbox = form2.panelFormGroup.panelColSm8.textboxLine1
  'Call textbox.Click(220, 15)
  Line1 = Excel.Cells(b,21)  
  'Call textbox.SetText(Line1)
  Set textbox = form2.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox.Click(132, 5)
  Line2 = Excel.Cells(b,22)
  'Call textbox.SetText(Line2)
  Set textbox = form2.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox.Click(82, 31)
  Line3 = Excel.Cells(b,23)
  'Call textbox.SetText(Line3)
  Set textbox = form2.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox.Click(44, 20)
  City = Excel.Cells(b,24)
  'Call textbox.SetText(City)
  Set textbox = form2.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox.Click(26, 25)
  PostCode = Excel.Cells(b,25)
  'Call textbox.SetText(PostCode)
  Set textbox = form2.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox.Click(5, 36)
  Province = Excel.Cells(b,26)
  'Call textbox.SetText(Province)
  'Call browser2.Drag(1361, 430, 3, 67)
  Set vselect = form2.selectCountry
  Country = Excel.Cells(b,27)
  'Call vselect.ClickItem(Country)
 ' Call vselect.ClickItem("Select..")
  'Have to get the Full Name
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button(0).Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button(0).Click
  'Call button.Click(28, 21)
'  Call browser2.Drag(1356, 417, 6, 90)
  'This is the banking Section
  Call panel6.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Click(561, 27)
  Call browser2.Drag(1359, 292, 6, 112)
  Set vselect = form.selectAccountHolderRelationship
  AccHolder = Excel.Cells(b,31)
  Call vselect.ClickItem(AccHolder)
  Set vselect = panel2.selectBankName
  BankName = Excel.Cells(b,32)
  Call vselect.ClickItem(BankName)
  Set vselect = form.selectBranchName
  'Call vselect.ClickItem("Select...")
  BranchName = Excel.Cells(b,33)
  Call vselect.ClickItem(Branchname)
  AccType = Excel.Cells(b,34)
  Call form.selectAccountType.ClickItem(AccType)
  Set textbox = panel.textboxBranchNumber
  BranchNum = Excel.Cells(b,35) 
  Call textbox.SetText(BranchNum)
  'AccNo = Excel.Cells(b,34) 
  Set textbox = panel5.textboxAccountNumber
  'Call textbox.Click(156, 7)
  AccNo = Excel.Cells(b,36) 
  Call textbox.SetText(AccNo)
'  Call browser2.Drag(1356, 500, 6, 96)
  'Have to get the Button Fullname
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
 ' Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePersonBankingDetails").Click
  
  'Call button.Click(29, 18)
  
  Set btn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(0).TextNode(0)
  
 ' If btn.Exists Then
 ' Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(1).Click  
 ' End IF
  
  Result = "pass"
  Else
  Result = "pass"
  End If   
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/") 
End Function


Function ProdDetails(Byval test, Byval env, Byval ProdType)
  
  Dim Process
  Excel.WorkSheets("RolePlayer").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     ProcessId = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

  Dim browser, page, section, form, panel, browser2, form2, panel2, textbox, panel13, panel14
  Dim button, textbox2, textbox3, phoneInput,button2 

'  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set form = section.formFormHorizontalNgUntouchedNg

  If ProdType = "FTFO" Or ProdType = "FIO" Then
    
    if form.panelFormGroup2.buttonYes.Exists  Then
  
    Call form.panelFormGroup2.buttonYes.Click(12, 14)
    Set panel = section.panelContainer.panelColSm12.section.panelFormHorizontal
    Call panel.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(626, 14)
    Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
    Call browser2.Drag(1359, 301, 6, 96)
    Set form2 = form.formFormHorizontalNgUntouchedNg
    SourceofIncome = Excel.Cells(b,2)
    Employer = Excel.Cells(b,3)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectIncomesourceinput0.ClickItem(SourceofIncome)
    'Call form2.selectSourceOfIncome.ClickItem(SourceofIncome)
    Employer = Excel.Cells(b,3)
    if SourceofIncome = "Employed" Then
    '
    Set Employ = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    '= Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    Employ.SetText(Employer)
    Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
   ' Set panel2 = form2.panelFormGroup.panelFormDynamicSectionNoMargin
   ' Set textbox = panel2.textboxNameOfEmployer
  '  Call textbox.Click(333, 17)
    
    'Call textbox.SetText(Employer)
    elseif SourceofIncome = "Unemployed" Then
    'Nothing is entered
    elseif SourceofIncome = "Self-employed" Then
    'Name of business
    Set NameofB = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    'NameofB.DblClickM
    NameofB.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
    
    elseif SourceofIncome = "Other" Then
    'Enter the details
    Set OtherDetails =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
   ' Set OtherDetails = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    'OtherDetails.DblClickM
    
    OtherDetails.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelColSm3.panelWellMyDropZoneTextCenter.textareaOthersourceinput0.Keys(Employer)
    End if
     
    Call browser2.Drag(1355, 320, 10, 94)
    Set panel3 = form.panelFormGroup3.panelColSm9
    SourceOfFunds = Excel.Cells(b,4)
    
    Set sourceof =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectMoneysourceinput0
    sourceof.ClickItem(SourceOfFunds)
   ' Call panel3.selectSourceOfFunds.ClickItem(SourceOfFunds)
    
    
   ' Call panel3.selectSourceOfFunds.Keys("[Tab]")
    ' Call textbox.Click(128, 8)
    src = Excel.Cells(b,5)
    if SourceOfFunds = "Salary/Remuneration" Then
    
     Set funds = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
     Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput")
     funds.DblClickM 
     funds.SetText(src)
     
    Elseif SourceOfFunds = "Self-employed" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set SelfEmploy = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    SelfEmploy.DblClickM
    SelfEmploy.SetText(src)
    Elseif SourceOfFunds = "Business Transaction" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set BizTrans = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("natureOfBusinessInput_0")
    BizTrans.DblClickM
    BizTrans.SetText(src)
    Elseif SourceOfFunds = "Investment" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set Invest = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("capitalSourceInput_0")
    Invest.DblClickM
    Invest.SetText(src)
    Elseif SourceOfFunds = "Savings" Then
    Set savings = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("savingsOriginInput_0")
    savings.DblClickM
    savings.SetText(src)
    Elseif SourceOfFunds = "Inheritance" Then
    Set Inheritance = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("deceasedEstateNameInput_0")
    Inheritance.DblClickM
    Inheritance.SetText(src)
    Elseif SourceOfFunds = "Other" Then
    Set other = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    other.DblClickM
    other.SetText(src)
    Elseif SourceOfFunds = "Winnings" Then
    Set Source = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("winningsSourceInput_0")
    Source.DblClickM
    Source.SetText(src)
    End If
    
    Set panel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4
    investno = Excel.Cells(b,26)
 
  'Check to see if the Transfer of Over - Contribution    
    if panel.buttonNewWealthFlexibleInvestmen.Exists Then
        if investno = "" Then
            panel.buttonNewWealthFlexibleInvestmen.ClickButton
        Else
            panel.buttonActiveInvestment.ClickButton
            Set textbox = panel.textboxInvestmentNumber
            Call textbox.DblClick(39, 21)
          Call textbox.SetText(investno)  
      End if 
    End If 
       
    Call browser2.Drag(1354, 393, 11, 111)
    if form.panelFormGroup5.panelColSm4.Exists Then
  
      Set panel4 = form.panelFormGroup5.panelColSm4
      Set button = panel4.buttonYes
      Call button.Click(9, 21)
      Call panel4.buttonNo.Click(8, 20)
      Call button.Click(12, 13)
  
    End if 
  
  Set button = section.buttonCreateAndLoadProcess
  'Have to get the FullName for Update Button
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Button("updatePaymentDetails").Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  
  Set panelbank = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(0).Link(0).Panel(0)
  panelbank.Click
  Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Panel(0).Panel(0).Click
  
  Set textbox = form2.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.textboxFspHouseCode
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)  
  set AddAnotherFinBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)
 

  FSPHouseCode = Excel.Cells(b,13) 
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  if fsphouse.Exists Then
  FSPHouseCode = Excel.Cells(b,13)
  fsphouse.SetText(FSPHouseCode)
  else 
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0).Click
  End if 
  FSPHouseCode = Excel.Cells(b,13)
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  fsphouse.SetText(FSPHouseCode)
  'Call textbox.SetText (FSPHouseCode)
  
  'Set textbox2 = panel2.panelFormGroup.textboxFinancialAdviserCode
  
  'Call textbox2.Click(19, 18)
  FinancialAdviseCode = Excel.Cells(b,14)
  set fadvisorcode = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox("financialAdviserCodeInput_0")
  fadvisorcode.Click
  fadvisorcode.SetText(FinancialAdviseCode) 
  fadvisorcode.Click
  'Call textbox2.SetText (FinancialAdviseCode)
  Set textbox3 = form.formFormNgUntouchedNgPristineN2.panelFormGroup2.panelColSm8.panelColSm8.textboxMarketingAdviserCode
  Call browser2.Drag(1354, 284, 11, 122)

  Set textbox = form.panelFormGroup.panelColSm9.textboxFullNames2
  'Call textbox.Click(164, 23)
  FullNm = Excel.Cells(b,16)
  set full = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("contactFullNameInput")
  full.SetText(FullNm)
  
  Surname = Excel.Cells(b,17)
  set SurNm = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("contactSurnameInput")
  SurNm.SetText(Surname)
  'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup3.panelColSm9.textboxSurname.SetText(Surname)
  Set phoneInput = panel.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
  'Call phoneInput.Click(135, 10)
  phone = Excel.Cells(b,18)
  set phon = Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
 ' phon.SetText(phone)
  set phon = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).PhoneInput("contactTelephoneInput")
  phon.SetText(phone)
  Set phoneInput = form.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'Call phoneInput.Click(67, 24)
  cell = Excel.Cells(b,19)
  Set cellular = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).PhoneInput("contactCellphoneInput")
  cellular.SetText(cell)
  set cel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'cel.SetText(cell)
  Set textbox = panel4.textboxEmail
  'Call textbox.Click(220, 18)
  emailrl = Excel.Cells(b,20)
  set email1 = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4.textboxEmail
 ' email1.SetText(emailrl)
  
  Set emailadd1 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Textbox("contactEmailInput")
  emailadd1.SetText(emailrl)
  Call browser2.Drag(1364, 414, 1, 112)
  'Call textbox.Click(596, 17)
  Set button2 = form.panel.panelFormGroup.buttonYes
  
  Set NoRadio = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(1).Label(0)
  NoRadio.Click
 
 'Call button2.Click(12, 17)
 '' Call button2.Click(6, 16)
  Call browser2.Drag(1360, 535, 5, 93)
  
 'Click the FullNAme
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updateFinancialAdviserDetails")
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updateFinancialAdviserDetails").Click
  'Call button.Click(50, 21)
  Call page.HoverMouse(1348, 463)
  Call section.HoverMouse(1340, 695)
  Call browser2.Drag(1357, 517, 8, 112)
  'HAve to get the FullName of the Button - Documents Button
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0)
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("documents").Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
  
    Set ContinueBTN = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(0)
    if ContinueBTN.Exists Then
    ContinueBTN.Click
    End IF
  
   Result = "pass" 
   Else 
   Result = "fail"
  End If
  
  ElseIf ProdType = "RPO" Or ProdType = "RIO" Then
    'hgfgfhgfghfgfhf 
    'Click the AddBeneficiary Button 
     Call FuncAddBeneficiary(Browser, test, env)
     'Activate the Role Player Sheet
     Excel.WorkSheets("RolePlayer").Activate
    
    Set panel = section.panelContainer.panelColSm12.section.panelFormHorizontal
    
       
    if panel.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Exists Then
    
    Call panel.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(626, 14)
    Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
    Call browser2.Drag(1359, 301, 6, 96)
    Set form2 = form.formFormHorizontalNgUntouchedNg
    SourceofIncome = Excel.Cells(b,2)
    Employer = Excel.Cells(b,3)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectIncomesourceinput0.ClickItem(SourceofIncome)
    'Call form2.selectSourceOfIncome.ClickItem(SourceofIncome)
    Employer = Excel.Cells(b,3)
    if SourceofIncome = "Employed" Then
    '
    'Set Employ = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    Set Employ = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    Employ.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
   ' Set panel2 = form2.panelFormGroup.panelFormDynamicSectionNoMargin
   ' Set textbox = panel2.textboxNameOfEmployer
  '  Call textbox.Click(333, 17)
    
    'Call textbox.SetText(Employer)
    elseif SourceofIncome = "Unemployed" Then
    'Nothing is entered
    elseif SourceofIncome = "Self-employed" Then
    'Name of business
    'Set NameofB = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    Set NameofB = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    'NameofB.DblClickM
    NameofB.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
    elseif SourceofIncome = "Other" Then
    'Enter the details
    'Set OtherDetails = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    'OtherDetails.DblClickM
    Set OtherDetails = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    OtherDetails.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelColSm3.panelWellMyDropZoneTextCenter.textareaOthersourceinput0.Keys(Employer)
    End if 
    Call browser2.Drag(1355, 320, 10, 94)
    Set panel3 = form.panelFormGroup3.panelColSm9
    SourceOfFunds = Excel.Cells(b,4)
'    Call panel3.selectSourceOfFunds.ClickItem(SourceOfFunds)
    Set sourceof =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectMoneysourceinput0
    sourceof.ClickItem(SourceOfFunds)
 '   Call panel3.selectSourceOfFunds.Keys("[Tab]")

    src = Excel.Cells(b,5)
    if SourceOfFunds = "Salary/Remuneration" Then

     Set funds = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
'     funds.DblClickM
     funds.SetText(src)
    Elseif SourceOfFunds = "Self-employed" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set SelfEmploy = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
 '   SelfEmploy.DblClickM
    SelfEmploy.SetText(src)
    Elseif SourceOfFunds = "Business Transaction" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set BizTrans = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("natureOfBusinessInput_0")
  '  BizTrans.DblClickM
    BizTrans.SetText(src)
    Elseif SourceOfFunds = "Investment" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set Invest = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("capitalSourceInput_0")
   ' Invest.DblClickM
    Invest.SetText(src)
    Elseif SourceOfFunds = "Savings" Then
    Set savings = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("savingsOriginInput_0")
    'savings.DblClickM
    savings.KeSetTextys(src)
    Elseif SourceOfFunds = "Inheritance" Then
    Set Inheritance = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("deceasedEstateNameInput_0")
    'Inheritance.DblClickM
    Inheritance.SetText(src)
    Elseif SourceOfFunds = "Other" Then
    Set other = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    'other.DblClickM
    other.SetText(src)
    Elseif SourceOfFunds = "Winnings" Then
    Set Source = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("winningsSourceInput_0")
    'Source.DblClickM
    Source.SetText(src)
    End If
     'Call textbox.SetText(src)
   
    Set panel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4
    investno = Excel.Cells(b,26)
 
  'Check to see if the Transfer of Over - Contribution    
    if panel.buttonNewWealthFlexibleInvestmen.Exists Then
        if investno = "" Then
            panel.buttonNewWealthFlexibleInvestmen.ClickButton
        Else
            panel.buttonActiveInvestment.ClickButton
            Set textbox = panel.textboxInvestmentNumber
            Call textbox.DblClick(39, 21)
          Call textbox.SetText(investno)  
      End if 
    End If 
       
    Call browser2.Drag(1354, 393, 11, 111)
    if form.panelFormGroup5.panelColSm4.Exists Then
  
      Set panel4 = form.panelFormGroup5.panelColSm4
      Set button = panel4.buttonYes
      Call button.Click(9, 21)
      Call panel4.buttonNo.Click(8, 20)
      Call button.Click(12, 13)
  
    End if 
  
  Set button = section.buttonCreateAndLoadProcess
  'Have to get the FullName for Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  
  Set panelbank = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(0).Link(0).Panel(0)
  panelbank.Click
  Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Panel(0).Panel(0).Click
  
  
  Set textbox = form2.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.textboxFspHouseCode
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)  
  set AddAnotherFinBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)
 

  FSPHouseCode = Excel.Cells(b,13) 
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  if fsphouse.Exists Then
  FSPHouseCode = Excel.Cells(b,13)
  fsphouse.SetText(FSPHouseCode)
  else 
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0).Click
  End if 
  FSPHouseCode = Excel.Cells(b,13)
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  fsphouse.SetText(FSPHouseCode)
  'Call textbox.SetText (FSPHouseCode)
  'Set textbox2 = panel2.panelFormGroup.textboxFinancialAdviserCode
  'Call textbox2.Click(19, 18)
  FinancialAdviseCode = Excel.Cells(b,14)
  set fadvisorcode = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox("financialAdviserCodeInput_0")
  fadvisorcode.Click
  fadvisorcode.SetText(FinancialAdviseCode) 
  fadvisorcode.Click
  'Call textbox2.SetText (FinancialAdviseCode)
  Set textbox3 = form.formFormNgUntouchedNgPristineN2.panelFormGroup2.panelColSm8.panelColSm8.textboxMarketingAdviserCode
  Call browser2.Drag(1354, 284, 11, 122)

  Set textbox = form.panelFormGroup.panelColSm9.textboxFullNames2
  'Call textbox.Click(164, 23)
  FullNm = Excel.Cells(b,16)
  set full = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("contactFullNameInput")
  full.SetText(FullNm)
  Surname = Excel.Cells(b,17)
  set SurNm = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("contactSurnameInput")
  SurNm.SetText(Surname)
  'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup3.panelColSm9.textboxSurname.SetText(Surname)
  Set phoneInput = panel.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
  'Call phoneInput.Click(135, 10)
  phone = Excel.Cells(b,18)
  set phon = Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
 ' phon.SetText(phone)
  set phon = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).PhoneInput("contactTelephoneInput")
  phon.SetText(phone)
  Set phoneInput = form.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'Call phoneInput.Click(67, 24)
  cell = Excel.Cells(b,19)
  Set cellular = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).PhoneInput("contactCellphoneInput")
  cellular.SetText(cell)
  set cel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'cel.SetText(cell)
  Set textbox = panel4.textboxEmail
  'Call textbox.Click(220, 18)
  emailrl = Excel.Cells(b,20)
  set email1 = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4.textboxEmail
 ' email1.SetText(emailrl)
  
  Set emailadd1 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Textbox("contactEmailInput")
  emailadd1.SetText(emailrl)
  Call browser2.Drag(1364, 414, 1, 112)
  'Call textbox.Click(596, 17)
  Set button2 = form.panel.panelFormGroup.buttonYes
  Set NoRadio = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(1).Label(0)
  NoRadio.Click
  
  'Call button2.Click(12, 17)
  'Call button2.Click(6, 16)
  Call browser2.Drag(1360, 535, 5, 93)
  
 'Click the FullNAme
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updateFinancialAdviserDetails").Click
  'Call button.Click(50, 21)
  Call page.HoverMouse(1348, 463)
  Call section.HoverMouse(1340, 695)
  Call browser2.Drag(1357, 517, 8, 112)
  'Call the Amount Transfer Function
   Call AmntTransfer(test,env)  
  
  'HAve to get the FullName of the Button - Documents Button
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("documents").Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
  
    Set ContinueBTN = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(0)
    if ContinueBTN.Exists Then
    ContinueBTN.Click
    End IF   
    Result = "pass" 
   Else 
   Result = "fail"
  End If
  
'jhghfhgfgfhgfghfhgfghfhg  
  ElseIf ProdType = "RAO" Then
  
    if form.panelFormGroup2.buttonYes.Exists  Then
       
    
     Call form.panelFormGroup2.buttonYes.Click(12, 14)
    'Click the Add Beneficiary Details Section when
     Call FuncAddBeneficiary(Browser, test, env)    
     Excel.WorkSheets("RolePlayer").Activate
      
    Set panel = section.panelContainer.panelColSm12.section.panelFormHorizontal
    'Click the 
    Call panel.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(626, 14)
    Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
    Call browser2.Drag(1359, 301, 6, 96)
    Set form2 = form.formFormHorizontalNgUntouchedNg
    SourceofIncome = Excel.Cells(b,2)
    Employer = Excel.Cells(b,3)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectIncomesourceinput0.ClickItem(SourceofIncome)
    'Call form2.selectSourceOfIncome.ClickItem(SourceofIncome)
    Employer = Excel.Cells(b,3)
    if SourceofIncome = "Employed" Then
    '
    'Set Employ = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    Set Employ = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    'Employ.DblClickM
    Employ.Keys(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
   ' Set panel2 = form2.panelFormGroup.panelFormDynamicSectionNoMargin
   ' Set textbox = panel2.textboxNameOfEmployer
  '  Call textbox.Click(333, 17)
    
    'Call textbox.SetText(Employer)
    elseif SourceofIncome = "Unemployed" Then
    'Nothing is entered
    elseif SourceofIncome = "Self-employed" Then
    'Name of business
   ' Set NameofB = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
   Set NameofB = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    'NameofB.DblClickM
    NameofB.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
    elseif SourceofIncome = "Other" Then
    'Enter the details
    Set OtherDetails = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    'OtherDetails.DblClickM
    OtherDetails.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelColSm3.panelWellMyDropZoneTextCenter.textareaOthersourceinput0.Keys(Employer)
    End if 

    
    Call browser2.Drag(1355, 320, 10, 94)
    Set panel3 = form.panelFormGroup3.panelColSm9
    SourceOfFunds = Excel.Cells(b,4)
    'Call panel3.selectSourceOfFunds.ClickItem(SourceOfFunds)
    Set sourceof =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectMoneysourceinput0
    sourceof.ClickItem(SourceOfFunds)
    
   ' Call panel3.selectSourceOfFunds.Keys("[Tab]")
    ' Call textbox.Click(128, 8)
    ' Call textbox.Click(128, 8)
    src = Excel.Cells(b,5)
    if SourceOfFunds = "Salary/Remuneration" Then

     Set funds = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
     funds.SetText(src)
    Elseif SourceOfFunds = "Self-employed" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set SelfEmploy = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    SelfEmploy.DblClickM
    SelfEmploy.SetText(src)
    Elseif SourceOfFunds = "Business Transaction" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set BizTrans = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("natureOfBusinessInput_0")
    BizTrans.DblClickM
    BizTrans.SetText(src)
    Elseif SourceOfFunds = "Investment" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set Invest = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("capitalSourceInput_0")
    Invest.DblClickM
    Invest.SetText(src)
    Elseif SourceOfFunds = "Savings" Then
    Set savings = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("savingsOriginInput_0")
    savings.DblClickM
    savings.SetText(src)
    Elseif SourceOfFunds = "Inheritance" Then
    Set Inheritance = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("deceasedEstateNameInput_0")
    Inheritance.DblClickM
    Inheritance.SetText(src)
    Elseif SourceOfFunds = "Other" Then
    Set other = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    other.DblClickM
    other.SetText(src)
    Elseif SourceOfFunds = "Winnings" Then
    Set Source = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("winningsSourceInput_0")
    Source.DblClickM
    Source.SetText(src)
    End If
     'Call textbox.SetText(src)
   
    Set panel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4
    investno = Excel.Cells(b,26)
 
  'Check to see if the Transfer of Over - Contribution    
    if panel.buttonNewWealthFlexibleInvestmen.Exists Then
        if investno = "" Then
            panel.buttonNewWealthFlexibleInvestmen.ClickButton
        Else
            panel.buttonActiveInvestment.ClickButton
            Set textbox = panel.textboxInvestmentNumber
            Call textbox.DblClick(39, 21)
          Call textbox.SetText(investno)  
      End if 
    End If 
       
    Call browser2.Drag(1354, 393, 11, 111)
    if form.panelFormGroup5.panelColSm4.Exists Then
  
      Set panel4 = form.panelFormGroup5.panelColSm4
      Set button = panel4.buttonYes
      Call button.Click(9, 21)
      Call panel4.buttonNo.Click(8, 20)
      Call button.Click(12, 13)
  
    End if 
  
  Set button = section.buttonCreateAndLoadProcess
  'Have to get the FullName for Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  
  Set panelbank = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(0).Link(0).Panel(0)
  panelbank.Click
  Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Panel(0).Panel(0).Click
  
  
  Set textbox = form2.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.textboxFspHouseCode
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)  
  set AddAnotherFinBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)
 

  FSPHouseCode = Excel.Cells(b,13) 
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  if fsphouse.Exists Then
  FSPHouseCode = Excel.Cells(b,13)
  fsphouse.SetText(FSPHouseCode)
  else 
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0).Click
  End if 
  FSPHouseCode = Excel.Cells(b,13)
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  fsphouse.SetText(FSPHouseCode)
  'Call textbox.SetText (FSPHouseCode)
  'Set textbox2 = panel2.panelFormGroup.textboxFinancialAdviserCode
  'Call textbox2.Click(19, 18)
  FinancialAdviseCode = Excel.Cells(b,14)
  set fadvisorcode = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox("financialAdviserCodeInput_0")
  fadvisorcode.Click
  fadvisorcode.SetText(FinancialAdviseCode) 
  fadvisorcode.Click
  'Call textbox2.SetText (FinancialAdviseCode)
  Set textbox3 = form.formFormNgUntouchedNgPristineN2.panelFormGroup2.panelColSm8.panelColSm8.textboxMarketingAdviserCode
  Call browser2.Drag(1354, 284, 11, 122)

  Set textbox = form.panelFormGroup.panelColSm9.textboxFullNames2
  'Call textbox.Click(164, 23)
  FullNm = Excel.Cells(b,16)
  set full = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("contactFullNameInput")
  full.SetText(FullNm)
  Surname = Excel.Cells(b,17)
  set SurNm = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("contactSurnameInput")
  SurNm.SetText(Surname)
  'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup3.panelColSm9.textboxSurname.SetText(Surname)
  Set phoneInput = panel.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
  'Call phoneInput.Click(135, 10)
  phone = Excel.Cells(b,18)
  set phon = Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
 ' phon.SetText(phone)
  set phon = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).PhoneInput("contactTelephoneInput")
  phon.SetText(phone)
  Set phoneInput = form.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'Call phoneInput.Click(67, 24)
  cell = Excel.Cells(b,19)
  Set cellular = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).PhoneInput("contactCellphoneInput")
  cellular.SetText(cell)
  set cel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'cel.SetText(cell)
  Set textbox = panel4.textboxEmail
  'Call textbox.Click(220, 18)
  emailrl = Excel.Cells(b,20)
  set email1 = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4.textboxEmail
 ' email1.SetText(emailrl)
  
  Set emailadd1 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Textbox("contactEmailInput")
  emailadd1.SetText(emailrl)
  Call browser2.Drag(1364, 414, 1, 112)
  'Call textbox.Click(596, 17)
  Set button2 = form.panel.panelFormGroup.buttonYes
  Set NoRadio = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(1).Label(0)
  NoRadio.Click
'  Call button2.Click(12, 17)
'  Call button2.Click(6, 16)
  Call browser2.Drag(1360, 535, 5, 93)
  
 'Click the FullNAme
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updateFinancialAdviserDetails").Click
  'Call button.Click(50, 21)
  Call page.HoverMouse(1348, 463)
  Call section.HoverMouse(1340, 695)
  Call browser2.Drag(1357, 517, 8, 112)
  'Call the Amount Transfer Function
   Call AmntTransfer(test,env)  
  
  'HAve to get the FullName of the Button - Documents Button
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("documents").Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
  
     Set ContinueBTN = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(0)
    if ContinueBTN.Exists Then
    ContinueBTN.Click
    End IF   
   Result = "pass" 
   Else 
   Result = "fail"
  End If   
  
  Elseif ProdType = "FEO" Then
''''''''''''''''''''''
    if form.panelFormGroup2.buttonYes.Exists  Then
  
    Call form.panelFormGroup2.buttonYes.Click(12, 14)
    
    'Add Beneficiary Details Section
    Call FuncAddBeneficiary(Browser, test, env) 
           
    'Add Beneficiary of ownership summary
    Call FuncAddBeneficiaryOwner(Browser, test, env)
    
    'Add Life insured summary
    Call FuncAddInsure(Browser, test, env)
    
    Excel.WorkSheets("RolePlayer").Activate
        
    Set panel = section.panelContainer.panelColSm12.section.panelFormHorizontal
    Call panel.panelPanelPanelDefault.panelPanelHeading.panelContactDetails.Click(626, 14)
    Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
    Call browser2.Drag(1359, 301, 6, 96)
    Set form2 = form.formFormHorizontalNgUntouchedNg
    SourceofIncome = Excel.Cells(b,2)
    Employer = Excel.Cells(b,3)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectIncomesourceinput0.ClickItem(SourceofIncome)
    'Call form2.selectSourceOfIncome.ClickItem(SourceofIncome)
    Employer = Excel.Cells(b,3)
    if SourceofIncome = "Employed" Then
    '
    'Set Employ = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    Set Employ = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput_0")
    Employ.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
   ' Set panel2 = form2.panelFormGroup.panelFormDynamicSectionNoMargin
   ' Set textbox = panel2.textboxNameOfEmployer
  '  Call textbox.Click(333, 17)
    
    'Call textbox.SetText(Employer)
    elseif SourceofIncome = "Unemployed" Then
    'Nothing is entered
    elseif SourceofIncome = "Self-employed" Then
    'Name of business
   ' Set NameofB = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    Set NameofB = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    'NameofB.DblClickM
    NameofB.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(Employer)
    elseif SourceofIncome = "Other" Then
    'Enter the details
    'Set OtherDetails = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    Set OtherDetails = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    'OtherDetails.DblClickM
    OtherDetails.SetText(Employer)
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelColSm3.panelWellMyDropZoneTextCenter.textareaOthersourceinput0.Keys(Employer)
    End if 
    
    Call browser2.Drag(1355, 320, 10, 94)
    Set panel3 = form.panelFormGroup3.panelColSm9
    SourceOfFunds = Excel.Cells(b,4)
   ' Call panel3.selectSourceOfFunds.ClickItem(SourceOfFunds)
    Set sourceof =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.selectMoneysourceinput0
    sourceof.ClickItem(SourceOfFunds)
    'Call panel3.selectSourceOfFunds.Keys("[Tab]")
    ' Call textbox.Click(128, 8)
    ' Call textbox.Click(128, 8)
    src = Excel.Cells(b,5)
    if SourceOfFunds = "Salary/Remuneration" Then

     Set funds = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("employerNameInput")
     funds.DblClickM
     funds.Keys(src)
    Elseif SourceOfFunds = "Self-employed" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set SelfEmploy = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("businessNameInput_0")
    SelfEmploy.DblClickM
    SelfEmploy.SetText(src)
    Elseif SourceOfFunds = "Business Transaction" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set BizTrans = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("natureOfBusinessInput_0")
    BizTrans.DblClickM
    BizTrans.SetText(src)
    Elseif SourceOfFunds = "Investment" Then
    'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.textbox.SetText(src)
    Set Invest = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("capitalSourceInput_0")
    Invest.DblClickM
    Invest.SetText(src)
    Elseif SourceOfFunds = "Savings" Then
    Set savings = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("savingsOriginInput_0")
    savings.DblClickM
    savings.SetText(src)
    Elseif SourceOfFunds = "Inheritance" Then
    Set Inheritance = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("deceasedEstateNameInput_0")
    Inheritance.DblClickM
    Inheritance.SetText(src)
    Elseif SourceOfFunds = "Other" Then
    Set other = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textarea("otherSourceInput_0")
    other.DblClickM
    other.SetText(src)
    Elseif SourceOfFunds = "Winnings" Then
    Set Source = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Form(0).Panel(0).Panel(1).Panel(0).Textbox("winningsSourceInput_0")
    Source.DblClickM
    Source.SetText(src)
    End If
     'Call textbox.SetText(src)
   
    Set panel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4
    investno = Excel.Cells(b,26)
 
  'Check to see if the Transfer of Over - Contribution    
    if panel.buttonNewWealthFlexibleInvestmen.Exists Then
        if investno = "" Then
            panel.buttonNewWealthFlexibleInvestmen.ClickButton
        Else
            panel.buttonActiveInvestment.ClickButton
            Set textbox = panel.textboxInvestmentNumber
            Call textbox.DblClick(39, 21)
          Call textbox.SetText(investno)  
      End if 
    End If 
       
    Call browser2.Drag(1354, 393, 11, 111)
    if form.panelFormGroup5.panelColSm4.Exists Then
  
      Set panel4 = form.panelFormGroup5.panelColSm4
      Set button = panel4.buttonYes
      Call button.Click(9, 21)
      Call panel4.buttonNo.Click(8, 20)
      Call button.Click(12, 13)
  
    End if 
  
  Set button = section.buttonCreateAndLoadProcess
  'Have to get the FullName for Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  
  Set panelbank = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(0).Link(0).Panel(0)
  panelbank.Click
  Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.Panel(0).Panel(0).Click
  
  
  Set textbox = form2.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.textboxFspHouseCode
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)  
  set AddAnotherFinBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0)
 

  FSPHouseCode = Excel.Cells(b,13) 
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  if fsphouse.Exists Then
  FSPHouseCode = Excel.Cells(b,13)
  fsphouse.SetText(FSPHouseCode)
  else 
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Panel(0).Button(0).Click
  End if 
  FSPHouseCode = Excel.Cells(b,13)
  set fsphouse =  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.panelColSm6.panelColSm8.Textbox("fspHouseCodeInput_0")
  fsphouse.SetText(FSPHouseCode)
  'Call textbox.SetText (FSPHouseCode)
  'Set textbox2 = panel2.panelFormGroup.textboxFinancialAdviserCode
  'Call textbox2.Click(19, 18)
  FinancialAdviseCode = Excel.Cells(b,14)
  set fadvisorcode = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(1).Panel(0).Panel(0).Textbox("financialAdviserCodeInput_0")
  fadvisorcode.Click
  fadvisorcode.SetText(FinancialAdviseCode) 
  fadvisorcode.Click
  'Call textbox2.SetText (FinancialAdviseCode)
  Set textbox3 = form.formFormNgUntouchedNgPristineN2.panelFormGroup2.panelColSm8.panelColSm8.textboxMarketingAdviserCode
  Call browser2.Drag(1354, 284, 11, 122)

  Set textbox = form.panelFormGroup.panelColSm9.textboxFullNames2
  'Call textbox.Click(164, 23)
  FullNm = Excel.Cells(b,16)
  set full = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("contactFullNameInput")
  full.SetText(FullNm)
  
  Surname = Excel.Cells(b,17)
  set SurNm = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("contactSurnameInput")
  SurNm.SetText(Surname)
  'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup3.panelColSm9.textboxSurname.SetText(Surname)
  Set phoneInput = panel.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
  'Call phoneInput.Click(135, 10)
  phone = Excel.Cells(b,18)
  set phon = Aliases.browser.pageNewBusinessCapture2.section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault3.panelPanelHeading.phoneinputContacttelephoneinput
 ' phon.SetText(phone)
  set phon = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).PhoneInput("contactTelephoneInput")
  phon.SetText(phone)
  Set phoneInput = form.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'Call phoneInput.Click(67, 24)
  cell = Excel.Cells(b,19)
  Set cellular = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(1).PhoneInput("contactCellphoneInput")
  cellular.SetText(cell)
  set cel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup4.panelColSm9.phoneinputContactcellphoneinput
  'cel.SetText(cell)
  Set textbox = panel4.textboxEmail
  'Call textbox.Click(220, 18)
  emailrl = Excel.Cells(b,20)
  set email1 = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4.textboxEmail
 ' email1.SetText(emailrl)
  
  Set emailadd1 = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(0).Textbox("contactEmailInput")
  emailadd1.SetText(emailrl)
  Call browser2.Drag(1364, 414, 1, 112)
  'Call textbox.Click(596, 17)
  Set button2 = form.panel.panelFormGroup.buttonYes
  
  Set NoRadio = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Panel(6).Panel(1).Label(0)
  NoRadio.Click
'  Call button2.Click(12, 17)
'  Call button2.Click(6, 16)
  Call browser2.Drag(1360, 535, 5, 93)
  
 'Click the FullNAme
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(0).Form(0).Button("updateFinancialAdviserDetails").Click
  
  'Call button.Click(50, 21)
  Call page.HoverMouse(1348, 463)
  Call section.HoverMouse(1340, 695)
  Call browser2.Drag(1357, 517, 8, 112)
  'HAve to get the FullName of the Button - Documents Button
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button("documents").Click
  'Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click

  'Call button.Click(44, 16)
 'if test3.Exists Then
 'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(1).Click
 'End IF
    Set ContinueBTN = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(2).Button(0)
    if ContinueBTN.Exists Then
    ContinueBTN.Click
    End IF 
  
 
   Result = "pass" 
   Else 
   Result = "fail"  

   End if
''''''''   
  End IF
'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")   
End Function

Function Documents(Byval test, Byval env)
  Dim browser,browser2,section,form,panel,textbox,panel2, table,textNode, legend  
  
  
    Excel.WorkSheets("CaptureDocs").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     'ProcessId = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

     
  'Call Browsers.Item(btIExplorer, "", Browsers.pX64).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/uploadAndShare")
  Set browser = Aliases.browser
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1360, 274, -27, 215)
  Set section = browser.pageNewBusinessCapture2.section
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  Set textbox = panel.panelColSm9.textboxClientcontactemail
 ' Call textbox.DblClick(160, 19)
  'Call textbox.Click(160, 19)
  Call browser2.Drag(1360, 489, 4, 55)
  Set panel2 = section.panelContainer.panelColSm12
  Call panel2.panelPanelHeading.panelUpload.Click(546, 23)
  
  
  Set table = panel.tableTableTableStripedTableNoBo
  table.cellTextRight4.link.Click
  'table.cellTextRight4.link.Click
  
  
  Set textNode = table.textnodeUpload
  Call textNode.Click(76, 7)
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Table(0).Cell(1, 4).Click
  'Call browser2.Click(739, 119)
  Call Uploadfile()
  'Call browser2.Click(1194, 245)
  table.cellTextRight5.link.Click
  
  Call textNode.Click(45, 12)
  Call Uploadfile()
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Table(0).Cell(2, 4).Click
  'Call browser2.Click(693, 119)
  'Call browser2.Click(1189, 247)
  table.cellTextRight6.link.Click
  Call textNode.Click(85, 12)
  Call Uploadfile()
 
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Table(0).Cell(3, 4).Link(0).Click
 ' Call browser2.Click(722, 121)
 ' Call browser2.Click(1204, 247)
  Call browser2.Drag(1354, 270, 11, 221)

  'Second Section for the documents
  
  Set table = form.panelFormGroup
  Set table2 = table.tableTableTableStripedTableNoBo
  'Investment Proposal
  table2.cellTextRight4.link.Click
  Set textNode = table.panelColSm9.textnodeUpload
  Call textNode.Click(87, 12)
  Call Uploadfile()
  'Call textNode.Click(87, 12)
  'Call browser2.Click
  'Application Form
  table2.cellTextRight5.link.Click
  Call textNode.Click(95, 7)
  Call Uploadfile()
  'Call textNode.Click(95, 7)
  'Call browser2.Click  
    
  'The end
  'Set panel = form.panelFormGroup
  'Set table = panel.tableTableTableStripedTableNoBo
  'table.cellTextRight4.link.Click
  'Set textNode = panel.panelColSm9.textnodeUpload
  'Call textNode.Click(70, 16)
  'Call browser2.Click(1198, 247)
  'table.cellTextRight2.link.Click
  'Call textNode.DblClick(70, 14)
  'Call textNode.Click(53, 10)
  'Call browser2.Click(1203, 245)
  'table.cellTextRight3.link.Click
  'Call textNode.Click(59, 9)
  'Call browser2.Click(1193, 248)
  
  'Select the Compliance Documents
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup3.panelColSm9.selectComplianceOption.ClickItem("")
  If SelectedOption1 = "Option 1 – Pace record" Then
  'Pace Interaction log Document
  
  Elseif SelectedOption1 = "Option 2 – Combined advice records" Then
  'Load four documents
  
  Elseif SelectedOption1 = "Option 3 – Separate advice records" Then
  'Load 6 documents
    
  End If 
  
  
  'Call section.buttonCreateAndLoadProcess.Click(34, 15)
  'Click the Fullname of the review Button
  Set ReviewBtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/uploadAndShare").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(1).Button("review")
      ReviewBtn.Click
      
  Set panel = panel2.panelPanelBody.panelPanelBodyForm
  Call panel.panelFormDynamicSectionNoMargin.panelColSm6.labelColSm6ControlLabel.HoverMouse(2, 22)
  Set panel2 = panel.legendFloatNone.panel1
  'Check if the Client details has all been captured
  if panel2.Exists Then 
  Call panel2.HoverMouse(13, 13)
  Call panel2.DblClick(9, 7)
  End If 
  
  Call browser2.Drag(1360, 149, 5, 226)
  Set legend = panel.legendFloatNone2
  Call legend.HoverMouse(203, 4)
  Set panel2 = legend.panel1
  'Check if all the product details has been captured
  if panel2.Exists Then
  Call panel2.DblClick(9, 11)
  Call panel2.Click(9, 11)
  End If 
  
  Call browser2.Drag(1358, 383, 1, 127)
  Set panel2 = panel.legendFloatNone3.panel3
  'Call panel2.HoverMouse(14, 15)
  'Check the Financial Advisor details
  if panel2.Exists Then
  Call panel2.HoverMouse(14, 15)
  Call panel2.DblClick(10, 8)
  End If
  'Tst = aqObject.GetPropertyValue(panel.legendFloatNone3.panel3, "Wtext")
  'MsgBox (Tst)
  Call browser2.Drag(1359, 461, 6, 66)
  'aqObject.Get
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-"&env&".momentum.co.za/nbc/")
End Function

Sub Test1
  Dim browser
  Dim section
  Dim panel
  Dim panel2
  Dim browser2
  Dim form
  Dim panel3
  Dim table
  Dim textNode
  Dim explorer
  Dim MSTaskListWClass
  Dim wndTesting
  Dim UIItem
  Dim UIProperty
  Dim panel4
  Dim button
  Dim wndTaskListThumbnailWnd
  Dim UIImage
  Dim legend
  Dim legend2
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set panel = section.panelContainer.panelColSm12
  Set panel2 = panel.panelPanelHeading.panelUpload
  Call panel2.Click(468, 41)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1356, 218, 9, 315)
  Call panel2.Click(912, 11)
  Call browser2.Drag(1360, 397, 5, 152)
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel3 = form.panelFormGroup2
  Set table = panel3.tableTableTableStripedTableNoBo
  table.cellTextRight.link.Click
  Set textNode = table.textnodeUpload
  Call textNode.Click(93, 12)
  Set explorer = Aliases.explorer
  Set MSTaskListWClass = explorer.wndShell_TrayWnd.ReBarWindow32.MSTaskSwWClass.MSTaskListWClass
  Call MSTaskListWClass.Click(100, 18)
  Set wndTesting = explorer.wndTesting
  Call wndTesting.Drag(301, 12, 18, -160)
  Set UIItem = wndTesting.Testing.DUIViewWndClassName.Explorer_Pane.CtrlNotifySink.ShellView.Items_View.Testing
  Set UIProperty = UIItem.Name
  Call UIProperty.Drag(27, 12, 25, -464)
  Set panel4 = panel3.panelColSm3.panelWellMyDropZoneTextCenter
  Call panel4.HoverMouse(587, 78)
  Call wndTesting.Drag(668, 19, -21, 120)
  wndTesting.Minimize
  Set button = section.buttonCreateAndLoadProcess
  button.ClickButton
  table.cellTextRight2.link.Click
  Call textNode.Click(61, 14)
  Set wndTaskListThumbnailWnd = explorer.wndTaskListThumbnailWnd
  Call wndTaskListThumbnailWnd.Click(133, 197)
  Call wndTesting.Drag(215, 20, -57, -92)
  Call UIProperty.Drag(17, 7, 126, -485)
  Call panel4.HoverMouse(600, 80)
  wndTesting.Minimize
  button.ClickButton
  table.cellTextRight3.link.Click
  Call textNode.Click(55, 15)
  Call MSTaskListWClass.Click(95, 27)
  Call UIProperty.Drag(13, 11, 104, -484)
  Call panel4.HoverMouse(574, 85)
  button.ClickButton
  Set panel3 = form.panelFormGroup
  Set table = panel3.tableTableTableStripedTableNoBo
  table.cellTextRight.link.Click
  Set panel4 = panel3.panelColSm9
  Set textNode = panel4.textnodeUpload
  Call textNode.Click(80, 13)
  Call wndTaskListThumbnailWnd.Click(145, 182)
  Set UIImage = UIItem.UIImage
  Call UIImage.Drag(14, 10, 142, -488)
  Set panel3 = panel4.panelModalContent.panelModalBody.panelWellMyDropZoneTextCenter
  Call panel3.HoverMouse(595, 80)
  button.ClickButton
  table.cellTextRight2.link.Click
  Call textNode.Click(106, 9)
  Call wndTaskListThumbnailWnd.Click(146, 206)
  Call UIProperty.Drag(21, 11, 95, -490)
  Call panel3.HoverMouse(573, 79)
  button.ClickButton
  table.cellTextRight3.link.Click
  Call textNode.Click(101, 5)
  Call wndTaskListThumbnailWnd.Click(142, 186)
  Call UIImage.Drag(4, 11, 140, -498)
  Call panel3.HoverMouse(583, 71)
  button.ClickButton
  button.ClickButton
  Call panel2.HoverMouse(1039, 658)
  Set legend = panel.panelPanelBody.panelPanelBodyForm
  Set legend2 = legend.legendFloatNone
  Call legend2.HoverMouse(175, 9)
  Call legend2.panel1.DblClick(10, 8)
  Call browser2.Drag(1361, 111, 4, 244)
  Set panel = legend.legendFloatNone2.panel1
  Call panel.HoverMouse(3, 16)
  Call panel.DblClick(8, 6)
  Call panel.Click(8, 6)
  Call browser2.Drag(1355, 361, 10, 205)
  button.ClickButton
End Sub



Sub Test3
  Dim section
  Dim form
  Dim textbox
  Dim panel
  Dim phoneInput
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set section = Aliases.browser.pageNewBusinessCapture2.section
  Set form = section.formFormHorizontalNgUntouchedNg
  Set textbox = form.panelFormGroup3.panelColSm9.textboxFullNames
  Call textbox.DblClick(88, 15)
  Call textbox.DblClick(88, 15)
  Call textbox.Click(88, 15)
  Call textbox.DblClick(88, 15)
  Call textbox.Click(88, 15)
  Call textbox.SetText("TestT")
  Set textbox = section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault3.panelPanelHeading.textboxSurname
  Call textbox.Click(84, 21)
  Call textbox.Click(84, 21)
  Call textbox.DblClick(84, 21)
  Call textbox.Click(84, 21)
  Call textbox.SetText("TesterS")
  Set panel = form.panelFormGroup5.panelColSm4
  Set phoneInput = panel.phoneinputContacttelephoneinput
  Call phoneInput.Click(105, 31)
  Call phoneInput.SetText("0124581235")
  Set phoneInput = panel.phoneinputContactcellphoneinput
  Call phoneInput.Click(94, 16)
  Call phoneInput.SetText("0624581232")
  Set textbox = form.panel.panelFormGroup.textboxEmail
  Call textbox.Click(177, 20)
  Call textbox.SetText("asdv@rthh.co.za")
End Sub


Sub Test4
  Dim browser
  Dim page
  Dim section
  Dim form
  Dim button
  Dim panel
  Dim panel2
  Dim panel3
  Dim textbox
  Dim panel4
  Dim button2
  Dim browser2
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set form = section.formFormHorizontalNgUntouchedNg
  Call form.buttonYes.Click(13, 7)
 ' Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(5).Panel(2).Panel(4).Panel(0).Textbox("reducedRatePercentageDividendWithholdingTax").Click
  Call form.panelFormGroup.panelColSm9.textboxSarsTaxReference.setActive
  Call form.panelFormGroup.panelColSm9.textboxSarsTaxReference.SetText("56544545")
  Call form.panelFormGroup.panelColSm9.textboxSarsTaxReference.Click(98, 22)
  Set button = section.buttonCreateAndLoadProcess
  aqUtils.Delay 2500
'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panel.panelFormGroup.buttonYes.Click(6,16)
  url = "https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails*"
 ' Browsers.Item(btIExplorer).Run url
  Set page = Sys.Browser("*").Page(url)
  page.Wait()

  Set btn = page.FindChild("contentText", "Add another country", 30)
 ' btn.Click
  Set anote = Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(0).Button(0)
  anote.Click
  Set anotherC = Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Panel(0).Button(0)
  anotherC.Click
  'Call button.Click(25, 18) Add another Country
  
'  Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).Panel(0).Button(0).Click
  Call form.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelFormGroup.selectCountry.ClickItem("Angola")
  Set panel = section.panelContainer.panelColSm12.section.panelFormHorizontal.panelPanelPanelDefault2
  Set panel2 = panel.panelPanelCollapseCollapse
  Set panel3 = panel2.panelPanelBody
  Set textbox = panel3.textboxTaxIdentificationNumberTi
  Call textbox.Click(388, 17)
  Call textbox.SetText("235678900")
  Set panel4 = form.formFormNgUntouchedNgPristineN2
  Call panel4.panelFormGroup2.panelColSm8.buttonYes.Click(11, 20)
  Set button2 = panel2.buttonNo
  Call button2.Click(11, 21)
  Call panel4.panelFormGroup3.panelColSm8.buttonYes.Click(10, 15)
  Call button2.Click(12, 19)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1361, 333, 4, 134)
  Call browser2.Drag(1365, 469, 0, 75)
  Set panel2 = form.panelFormGroup4
  Call panel2.panelColSm9.buttonYes.Click(15, 8)
  Call form.buttonNo2.Click(8, 10)
  Call panel2.buttonNo.Click(9, 9)
  Set panel4 = panel2.panelColSm4
  
  Set reducerate = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4.Panel(0).Panel(0).Label(0)
  
  reducerate.Click
  
  'Call panel4.buttonYes.Click(7, 9)
  Call browser2.Drag(1356, 380, 9, 95)
  Set textbox = panel.panelPanelHeading.panelBankingDetails.textboxRegisteredCompanyName
  Call textbox.Click(39, 16)
  Call textbox.SetText("Testing")
  Set textbox = panel3.textboxReasonYouMeetTheRequireme
  Call textbox.Click(22, 29)
  Call textbox.SetText("Testing Services")
  Set textbox = panel4.textboxArticleNumber
  Call textbox.Click(28, 12)
  Call textbox.SetText("100011")
  Set textbox = panel4.textboxReducedRate
  Set txtReduce = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup3.panelColSm4.Textbox("reducedRatePercentageDividendWithholdingTax")
  txtReduce.SetText("50")
  'Call textbox.Click(38, 25)
  'Call textbox.DblClick(38, 25)
  'Call textbox.SetText("50")
  Call browser2.Drag(1362, 503, 3, 48)
  Set Update = Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0)
  Update.Click
  'Sys.Browser("iexplore").Page("https://internal-retail-dev.momentum.co.za/nbc/#/investment-proposal/clientDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0).Click
  Call button.Click(24, 14)
  Call page.HoverMouse(1333, 310)
  Call section.HoverMouse(1302, 303)
  Call browser2.Drag(1364, 493, 1, -58)
End Sub


Sub Test6
  Dim panel
  Dim textbox
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set panel = Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup5.panelColSm4
  panel.buttonActiveInvestment.ClickButton
  Set textbox = panel.textboxInvestmentNumber
  Call textbox.DblClick(39, 21)
  Call textbox.SetText("012567689")
  panel.buttonNewWealthFlexibleInvestmen.ClickButton
End Sub


Function AmntTransfer(Byval test, Byval env)
  Dim browser, section,panel, form, panel2, button,browser2, form2, textbox   

  Excel.WorkSheets("AmntTransfer").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  
  
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set panel = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Call panel.panelPanelPanelDefault3.panelPanelHeading.panelTaxDetails.panelAccordionToggle.panelAmountTransfer.Click(305, 17)
    
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel2 = form.panelFormGroup2
  'Call panel2.panelColSm3.buttonNo.ClickButton
  aqUtils.Delay 1000
  Set button = panel2.panelColSm9.buttonYes
 ' button.ClickButton
 
  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Panel(0).Label(0).ClickButton
  'Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.panelFormGroup2.panelColSm9.buttonYes.ClickButton
  
  'Call button.HoverMouse(9, 20)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1352, 470, 13, 94)
  Set button = section.buttonCreateAndLoadProcess
 ' Set AddAnotherbtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Panel(0).Panel(0).Button(0)
  AmntTransfer = Excel.Cells(b,2)
  if AmntTransfer = "Yes" Then
  
  Set AddAnotherbtn =  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Panel(0).Panel(0).Button(0)
  
  if AddAnotherbtn.Exists Then
  AddAnotherbtn.Click
  End IF
  
'  button.ClickButton
  
  Set btnamtsaved =  Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Panel(0).Panel(0).Button(0)
  if btnamtsaved.Exists Then
  btnamtsaved.Click
  End If  
 
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Set textbox = form2.panelFormGroup2.panelFormGroup.panelColSm6.textboxTransferringcompany0
  Call textbox.Click(22, 19)
  Compref = Excel.Cells(b,3)
  Call textbox.SetText("Test")
  Set textbox = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup.textboxCompanyreference0
  Call textbox.Click(33, 28)
  Company = Excel.Cells(b,4)
  Call textbox.SetText(Company)
  Call browser2.Drag(1358, 472, 7, 147)
  Set textbox = panel.panelPanelPanelDefault2.panelPanelHeading.panelBankingDetails.textboxExpectedamount0
  Call textbox.Click(63, 21)
  ExpectedAmnt = Excel.Cells(b,5)
  Call textbox.SetText(ExpectedAmnt) 
  
  ElseIF AmntTransfer = "No" Then
  Call panel2.panelColSm3.buttonNo.ClickButton
  End If
  
  
  'Set Updatebtn = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0)
  Set Updatebtn = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(3).Panel(1).Panel(0).Panel(0).Form(0).Button(0)
  Updatebtn.Click
  'button.ClickButton
End Function

Sub AddBeneficiary1

  Dim browser, page, section, button, form, form2, vselect, browser2, panel, panel2,panel3,textbox,panel4,panel5, textbox2, emailInput, textbox3   
  
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set button = section.buttonCreateAndLoadProcess
  'Click button using the Full Name
  Set AddBen = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Button(0)
  AddBen.Click
  'button.ClickButton
  Set form = section.formFormHorizontalNgUntouchedNg
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Set vselect = form2.panelFormGroup2.panelFormGroup.formFormHorizontalNgUntouchedNg.selectTypeinput
  Call vselect.ClickItem("Individual")
  'Call browser.pagepopup0.Click(654, 18)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1358, 335, -8, 135)
  Set panel = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  Call panel.selectTitleinput.ClickItem("Mr"&"*")
  Set panel2 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Set panel3 = panel2.panelPanelPanelDefault2
  Set textbox = panel3.textboxInitialsinput
  Call textbox.Click(34, 27)
  Call textbox.SetText("T")
 ' Call textbox.Keys("[Tab]")
  Set panel4 = form.panelFormGroup2.panelColSm3.panelWellMyDropZoneTextCenter
  Set textbox = panel4.textboxFullnamesinput
  Call textbox.Click(174, 16)
  Call textbox.SetText("Testing")
  Set panel5 = panel3.panelPanelHeading
  Set textbox = panel5.textboxSurnameinput
  Call textbox.Click(116, 12)
  Call textbox.SetText("Tester")
  Set textbox = panel4.textboxRsaIdNumber
  Call textbox.Click(55, 12)
  Call textbox.SetText("8507275841084")
  Set textbox = panel5.textboxClientrelationshipinput
  Call textbox.Click(49, 12)
  Call textbox.SetText("Sister")
  Set textbox2 = panel2.panelPanelPanelDefault3.panelPanelHeading.textboxContactnumberinput
  Call textbox2.Click(37, 14)
  Call textbox2.SetText("0732098048")
  Set emailInput = form.formFormNgUntouchedNgPristineN2.panelFormGroup4.panelColSm8.emailinputEmailinput
  Call emailInput.Click(36, 10)
  Call emailInput.SetText("ghgg@hghh.co.za")
  Call browser2.Drag(1365, 481, 0, 115)
  Call page.HoverMouse(1342, 488)
  Call section.HoverMouse(1346, 988)
  Call browser2.Drag(1359, 530, -13, -10)
  
  Call emailInput.Click(284, 15)
  Call page.HoverMouse(1351, 444)
  Call section.HoverMouse(1330, 681)
  Call browser2.Drag(1359, 454, -51, -145)
  Call vselect.ClickItem("Company")
  Set textbox3 = panel.textboxSurnameinput
  Call textbox3.Click(389, 22)
  Call textbox3.Drag(389, 24, 150, 0)
  Call textbox3.SetText("Ab")
  Call textbox3.Keys("![ReleaseLast]")
  Call textbox3.SetText("AbcT")
  Set textbox3 = panel4.textboxRegistrationnumberinput
  Call textbox3.Click(127, 33)
  Call textbox3.SetText("1000012233")
  Call textbox.DblClick(32, 22)
  Call textbox2.Click(95, 20)
  Call emailInput.Click(150, 25)
  Call browser2.Drag(1354, 514, 3, 153)
  'Sys.Browser("iexplore")
  'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Button(0).Click  
  ' Click the Product Details Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
 
 
End Sub

Function FuncAddBeneficiary(Byval Browser, Byval test, Byval env)
  'Read Data from the excel sheet
  Excel.WorkSheets("AddBeneficiary").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  
    
   AddBen = Excel.Cells(b,2)
  'Check if you want to add a beneficiary  Or Not
  if AddBen = "Y"  Then

  'Dim browser, page, section, button, form, form2, vselect, browser2, panel, panel2,panel3,textbox,panel4,panel5, textbox2, emailInput, textbox3   
    
  CustType = Excel.Cells(b,3)
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set button = section.buttonCreateAndLoadProcess
  'Click button using the Full Name
  Set AddBen = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Button(0)
  AddBen.Click
  'button.ClickButton
  'Select the Customer Type
  if CustType = "Individual" Then
  
  Set form = section.formFormHorizontalNgUntouchedNg
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Set vselect = form2.panelFormGroup2.panelFormGroup.formFormHorizontalNgUntouchedNg.selectTypeinput
  Call vselect.ClickItem(CustType)
  'Call browser.pagepopup0.Click(654, 18)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1358, 335, -8, 135)
  Set panel = form2.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup
  Title = Excel.Cells(b,10)
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.panelFormGroup.panelFormDynamicSectionNoMargin.panelFormGroup.selectTitleinput.ClickItem(Title)
  ''Call panel.selectTitleinput.ClickItem(Title)
  Set panel2 = section.panelContainer.panelColSm12.section.panelFormHorizontal
  Set panel3 = panel2.panelPanelPanelDefault2
  Set textbox = panel3.textboxInitialsinput
  Call textbox.Click(34, 27)
  'Initials
  Initials = Excel.Cells(b,11)
  Call textbox.SetText(Initials)
 ' Call textbox.Keys("[Tab]")
  Set panel4 = form.panelFormGroup2.panelColSm3.panelWellMyDropZoneTextCenter
  Set textbox = panel4.textboxFullnamesinput
  Call textbox.Click(174, 16)
  FullName = Excel.Cells(b,12)
  Call textbox.SetText(FullName)
  Set panel5 = panel3.panelPanelHeading
  Set textbox = panel5.textboxSurnameinput
  Call textbox.Click(116, 12)
  SurName = Excel.Cells(b,13)
  Call textbox.SetText(SurName)
  Set textbox = panel4.textboxRsaIdNumber
  Call textbox.Click(55, 12)
  IDNum = Excel.Cells(b,15)
  Call textbox.SetText(IDNum)
  Set textbox = panel5.textboxClientrelationshipinput
  Call textbox.Click(49, 12)
  Relationship = Excel.Cells(b,16)
  Call textbox.SetText(Relationship)
  Set textbox2 = panel2.panelPanelPanelDefault3.panelPanelHeading.textboxContactnumberinput
  Call textbox2.Click(37, 14)
  ContactNo = Excel.Cells(b,17)
  Call textbox2.SetText(ContactNo)
  Set emailInput = form.formFormNgUntouchedNgPristineN2.panelFormGroup4.panelColSm8.emailinputEmailinput
  Call emailInput.Click(36, 10)
  Email = Excel.Cells(b,18)
  Call emailInput.SetText(Email)
  Call browser2.Drag(1365, 481, 0, 115)
  Call page.HoverMouse(1342, 488)
  Call section.HoverMouse(1346, 988)
  Call browser2.Drag(1359, 530, -13, -10)
  Call emailInput.Click(284, 15)
  Call page.HoverMouse(1351, 444)
  Call section.HoverMouse(1330, 681)
  Call browser2.Drag(1359, 454, -51, -145)
    'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Button(0).Click  
 ' Click the Product Details Button
 Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
  'If its the corporations that have been inputed  
  Else 
  Set form = section.formFormHorizontalNgUntouchedNg
  Set form2 = form.formFormHorizontalNgUntouchedNg
  Set vselect = form2.panelFormGroup2.panelFormGroup.formFormHorizontalNgUntouchedNg.selectTypeinput
  Call vselect.ClickItem(CustType)

  Name =  Excel.Cells(b,5)  
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(1).Panel(0).Panel(0).Textbox("surnameInput_").SetText(Name)

  RegNo =  Excel.Cells(b,6)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(1).Panel(1).Panel(0).Textbox("registrationNumberInput_").SetText(RegNo)
  'Relationship to Client
  Relate =  Excel.Cells(b,7)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(2).Panel(0).Textbox("clientRelationshipInput_").SetText(Relate)
  'Contact  number
  ContactNum = Excel.Cells(b,8)
  Set Cont = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(3).Panel(0).Textbox("contactNumberInput_")
   Cont.SetText(ContactNum)
  'Email Address
  EmailAd = Excel.Cells(b,9)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Panel(0).Panel(0).Form(0).Panel(4).Panel(0).EmailInput("emailInput_").SetText(EmailAd)
  'Call browser2.Drag(1354, 514, 3, 153)
 
  'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Form(0).Button(0).Click  
 ' Click the Product Details Button
 Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiary").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(1).Button(0).Click
 End If
 End if 
End Function


Sub AddBeneficiaryOwnership
  Dim browser
  Dim page
  Dim section
  Dim button
  Dim browser2
  Dim form
  Dim panel
  Dim vselect
  Dim textbox
  Dim panel2
  Dim panel3
  Dim panel4
  Dim panel5
  Dim button2
  Dim emailInput
  Dim textbox2
  Dim explorer
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set button = section.buttonCreateAndLoadProcess
  'Click the Add Beneficiary Ownership Button
  Set AddBeneficiaryOwner = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Form(0).Panel(0).Panel(0).Panel(0).Button(0)
  AddBeneficiaryOwner.Click
  Call page.HoverMouse(1352, 435)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1358, 358, -10, 44)
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  Set vselect = panel.selectTitle
  'Call vselect.ClickItem("Select..")
  Call vselect.ClickItem("Select..")
  Call vselect.ClickItem("Dr.")
  Set textbox = panel.panelColSm3.textboxInitials
  Call textbox.Click(35, 24)
  Call textbox.SetText("M")
  Call textbox.Click(35, 24)
  Set panel2 = form.panelFormGroup
  Set textbox = panel2.panelColSm9.textboxFullNames
  Call textbox.Click(105, 13)
  Call textbox.SetText("Mmmmmmm")
  Set panel3 = form.panelFormGroup3
  Set textbox = panel3.panelColSm9.textboxPreferredName
  Call textbox.Click(33, 18)
  Call textbox.SetText("Testing")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  Call textbox.Click(35, 25)
  Call textbox.SetText("Kekana")
  Call browser2.Drag(1354, 413, -8, 119)
  Set panel5 = form.panelFormGroup5.panelColSm4
  panel5.buttonPassportNumber.ClickButton
  Set button2 = form.buttonRsaIdNumber
  button2.ClickButton
  Call button2.HoverMouse(11, 12)
  Set textbox = form.panel.panelFormGroup.panelColSm9.textboxIdNumber
  Call textbox.Click(19, 22)
  Call textbox.SetText("8507275841084")
  form.buttonSouthAfrican.ClickButton
  Set button2 = form.buttonMale
  button2.ClickButton
  form.buttonFemale.ClickButton
  button2.ClickButton
  Set textbox = form.textbox
  Call textbox.Click(65, 21)
  'Call textbox.Click(148, 21)
  'Call textbox.Click(44, 15)
  Call browser2.Drag(1364, 468, 1, 93)
  'form.formFormHorizontalNgUntouchedNg.buttonNo.ClickButton
  'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails").Click
  
  'button.ClickButton
  'Call browser2.Click(755, 349)
  'button.ClickButton
  Call browser2.Drag(1359, 412, 6, 124)
  Call section.panelContainer.panelColSm12.panelPanelBody.panelPanelBodyForm.panelFormDynamicSectionNoMargin.panelContactDetails.Click(593, 22)
  Call page.HoverMouse(1348, 336)
  Call section.HoverMouse(1332, 382)
  Call browser2.Drag(1353, 390, -21, -161)
  Call page.HoverMouse(1365, 228)
  Call browser2.Drag(1363, 252, 2, -82)
  panel.panelColSm9.buttonYes.ClickButton
  panel2.buttonPost.ClickButton
  Call browser2.Drag(1361, 310, 4, 176)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
  Call textbox.Click(56, 22)
  Call textbox.SetText("0124578912")
  Set textbox = panel3.panelColSm42.textboxHometelephone
  Call textbox.Click(25, 18)
  Call textbox.SetText("0321456845")
  Set textbox = panel4.panelColSm4.textboxCellphone
  Call textbox.Click(241, 19)
  Call textbox.SetText("0725412369")
  Set textbox = panel4.panelColSm42.textboxFax
  Call textbox.Click(30, 23)
  Call textbox.SetText("0861237895")
  Set emailInput = panel5.emailinputEmail
  Call emailInput.Click(165, 13)
  Call emailInput.SetText("ghghg@hghgj.com")
  Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.ClickButton(cbChecked)
  Set textbox = form.formFormNgUntouchedNgPristineN2
  Set textbox2 = textbox.panelFormGroup.panelColSm8.textboxLine1
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  lin1.SetText("123")
  'Call textbox2.SetText("123")
  Set textbox2 = textbox.panelFormGroup2.panelColSm8.textboxLine2
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  lin2.SetText("456")
  'Call textbox2.SetText("456")
  Set textbox2 = textbox.panelFormGroup3.panelColSm8.textboxLine3
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  lin3.SetText("789")
  'Call textbox2.SetText("789")
  Set textbox2 = textbox.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox2.Click(113, 15)
  Set city = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  city.SetText("Joburg")
  'Call textbox2.SetText("Joburg")
  Set textbox2 = textbox.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox2.Click(132, 17)
  'Call textbox2.SetText("0002")
Set Code =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  Code.SetText("0002")
  'Call browser2.DblClick(1359, 655)
  'Call browser2.Click(1359, 655)
  Set textbox2 = textbox.panelFormGroup6.panelColSm8.textboxProvince
  Set Provinc = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  Provinc.SetText("Gauteng")
  'Call textbox2.SetText("Gauteng")
  'Call textbox2.Click(183, 24)
  Call textbox.selectCountry.ClickItem("South Africa")
  
  Set Country = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(7).Panel(0).Select("countryCode_Physical")
  Country.ClickItem("South Africa")
  
  Set btnupdate = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails")
  btnupdate.Click
  
  Set btnlink = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button(0)
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Link(0)
  btnlink.Click
  
End Sub

Function FuncAddBeneficiaryOwner(Byval Browser, Byval test, Byval env)
  
    'Read Data from the excel sheet
  Excel.WorkSheets("AddBenOwnership").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  

  

'  Dim browser,page, section, button, browser2, form, panel, vselect, textbox, panel2, panel3, panel4,panel5, button2, emailInput, textbox2, explorer  


  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set button = section.buttonCreateAndLoadProcess
  'Click the Add Beneficiary Ownership Button
  Set AddBeneficiaryOwner = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(1).Form(0).Panel(0).Panel(0).Panel(0).Button(0)
  AddBeneficiaryOwner.Click
  Call page.HoverMouse(1352, 435)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1358, 358, -10, 44)
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  Set vselect = panel.selectTitle
  'Call vselect.ClickItem("Select..")
  Title = Excel.Cells(b,2)
  Call vselect.ClickItem(Title)
  Set textbox = panel.panelColSm3.textboxInitials
  Call textbox.Click(35, 24)
  Initials = Excel.Cells(b,3)
  Call textbox.SetText(Initials)
  Call textbox.Click(35, 24)
  Set panel2 = form.panelFormGroup
  Set textbox = panel2.panelColSm9.textboxFullNames
  Call textbox.Click(105, 13)
  Fullnames = Excel.Cells(b,4)
  Call textbox.SetText(Fullnames)
  Set panel3 = form.panelFormGroup3
  Set textbox = panel3.panelColSm9.textboxPreferredName
  Call textbox.Click(33, 18)
  Call textbox.SetText("Testing")
  Set panel4 = form.panelFormGroup4
  Set textbox = panel4.panelColSm9.textboxSurname
  Call textbox.Click(35, 25)
  Surname = Excel.Cells(b,6) 
  Call textbox.SetText(Surname)
  Call browser2.Drag(1354, 413, -8, 119)
  Set panel5 = form.panelFormGroup5.panelColSm4
 ' panel5.buttonPassportNumber.ClickButton
  Set button2 = form.buttonRsaIdNumber
  button2.ClickButton
  Call button2.HoverMouse(11, 12)
  Set textbox = form.panel.panelFormGroup.panelColSm9.textboxIdNumber
  Call textbox.Click(19, 22)
  Surname = Excel.Cells(b,8)
  Call textbox.SetText(Surname)
  form.buttonSouthAfrican.ClickButton
  
  'Make selection based on Gender
  Gender = Excel.Cells(b,10)
  if Gender = "Male" Then
  Set button2 = form.buttonMale
  
  button2.ClickButton
   Else 
  form.buttonFemale.ClickButton
  
  button2.ClickButton
  
  End If 
  
  Set textbox = form.textbox
  Call textbox.Click(65, 21)
  'Call textbox.Click(148, 21)
  'Call textbox.Click(44, 15)
  Call browser2.Drag(1364, 468, 1, 93)
  'form.formFormHorizontalNgUntouchedNg.buttonNo.ClickButton
  'Click the Update Button
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails").Click
  
  'button.ClickButton
  'Call browser2.Click(755, 349)
  'button.ClickButton
  Call browser2.Drag(1359, 412, 6, 124)
  Call section.panelContainer.panelColSm12.panelPanelBody.panelPanelBodyForm.panelFormDynamicSectionNoMargin.panelContactDetails.Click(593, 22)
  Call page.HoverMouse(1348, 336)
  Call section.HoverMouse(1332, 382)
  Call browser2.Drag(1353, 390, -21, -161)
  Call page.HoverMouse(1365, 228)
  Call browser2.Drag(1363, 252, 2, -82)
  panel.panelColSm9.buttonYes.ClickButton
  
  panel2.buttonPost.ClickButton
  
  Call browser2.Drag(1361, 310, 4, 176)
  Set textbox = panel3.panelColSm4.textboxTelephoneW
  Call textbox.Click(56, 22)
  TelW = Excel.Cells(b,14)
  Call textbox.SetText(TelW)
  Set textbox = panel3.panelColSm42.textboxHometelephone
  Call textbox.Click(25, 18)
  TelH = Excel.Cells(b,15) 
  Call textbox.SetText(TelH)
  Set textbox = panel4.panelColSm4.textboxCellphone
  Call textbox.Click(241, 19)
  Cell = Excel.Cells(b,16) 
  Call textbox.SetText(Cell)
  Set textbox = panel4.panelColSm42.textboxFax
  Call textbox.Click(30, 23)
   Fax = Excel.Cells(b,17)
  Call textbox.SetText(Fax)
  Set emailInput = panel5.emailinputEmail
  Call emailInput.Click(165, 13)
   Email = Excel.Cells(b,18)  
  Call emailInput.SetText(Email)
  
  Call form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress.ClickButton(cbChecked)
  Set textbox = form.formFormNgUntouchedNgPristineN2
  Set textbox2 = textbox.panelFormGroup.panelColSm8.textboxLine1
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  line1 = Excel.Cells(b,19)
  lin1.SetText(line1)
  'Call textbox2.SetText("123")
  Set textbox2 = textbox.panelFormGroup2.panelColSm8.textboxLine2
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  line2 = Excel.Cells(b,20)
  lin2.SetText(line2)
  'Call textbox2.SetText("456")
  Set textbox2 = textbox.panelFormGroup3.panelColSm8.textboxLine3
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
   line3 = Excel.Cells(b,21)
  lin3.SetText(line3)
  'Call textbox2.SetText("789")
  Set textbox2 = textbox.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox2.Click(113, 15)
  Set city = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  CityDt = Excel.Cells(b,22)
  city.SetText(CityDt)
  'Call textbox2.SetText("Joburg")
  Set textbox2 = textbox.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox2.Click(132, 17)
  'Call textbox2.SetText("0002")
Set Code =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  Postal = Excel.Cells(b,23)
  Code.SetText(Postal)
  'Call browser2.DblClick(1359, 655)
  'Call browser2.Click(1359, 655)
  Set textbox2 = textbox.panelFormGroup6.panelColSm8.textboxProvince
  Set Provinc = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  Prov = Excel.Cells(b,24)
  Provinc.SetText(Prov)

  countr = Excel.Cells(b,25)
  Set Country = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(7).Panel(0).Select("countryCode_Physical")
  
  Country.ClickItem(countr)
  
  
  Set btnupdate = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails")
  btnupdate.Click
  
  'Set btnlink = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button(0)
  Set btnlink = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button("productDetails")
  'Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/beneficiaryOfOwnership;isBeneficiaryOfOwnership=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Link(0)
  btnlink.Click
  
End Function


'Add Insure Function
Function FuncAddInsure(Byval Browser, Byval test, Byval env)
  
      'Read Data from the excel sheet
  Excel.WorkSheets("AddBenOwnership").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count

	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
		 Else     
     
		  Exit For	
		End If		
	Next  


 ' Dim browser,page,section,form,panel,button,button2,browser2,panel2,textbox,panel3,panel4,panel5
 ' Dim button3, emailInput,textbox2, checkbox

  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails")
  Set browser = Aliases.browser
  Set page = browser.pageNewBusinessCapture2
  Set section = page.section
  Set form = section.formFormHorizontalNgUntouchedNg
  Set panel = form.panelFormGroup2
  Set button = panel.panelColSm9.buttonYes
  button.ClickButton
  'button.ClickButton
  Set button2 = section.buttonCreateAndLoadProcess
  'button2.ClickButton
  Set AddInsure =  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails").Section(0).Panel(1).Panel(0).Panel(1).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(1).Panel(1).Panel(0).Panel(0).Button(0)
  AddInsure.Click
  Call page.HoverMouse(1355, 442)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1355, 372, 4, 21)
  Title = Excel.Cells(b,2)
  Call panel.selectTitle.ClickItem(Title)
  Set panel2 = panel.panelColSm3
  Set textbox = panel2.textboxInitials
  Call textbox.Click(13, 20)
  Initial = Excel.Cells(b,3)
  Call textbox.SetText(Initial)
  Set panel = form.panelFormGroup
  Set panel3 = panel.panelColSm9
  Set textbox = panel3.textboxFullNames
  Call textbox.Click(378, 25)
  FName = Excel.Cells(b,4)
  Call textbox.SetText(FName)
  Set panel4 = form.panelFormGroup3
  Set textbox = panel4.panelColSm9.textboxPreferredName
  Call textbox.Click(80, 21)
  Call textbox.SetText("Teste")
  Set panel5 = form.panelFormGroup4
  Set textbox = panel5.panelColSm9.textboxSurname
  Call textbox.Click(49, 9)
  SName = Excel.Cells(b,6)
  Call textbox.SetText(SName)
  Call browser2.Drag(1359, 367, 6, 146)
  Set textbox = form.panel.panelFormGroup.panelColSm9.textboxIdNumber
  Call textbox.Click(13, 18)
  IDNum = Excel.Cells(b,8)
  Call textbox.SetText(IDNum)
  form.buttonSouthAfrican.ClickButton
    
    'Get Gender from excel file
    Gender = Excel.Cells(b,10)
  
    if Gender = "Male" Then
    'Set button3 = form.buttonMale
    'button3.ClickButton
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.buttonMale.ClickButton
    else 
    'Set button3 = form.buttonMale
    'form.buttonFemale.ClickButton
    'button3.ClickButton
    Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.buttonFemale.ClickButton
    End If
  
  Call browser2.Drag(1360, 394, 5, 149)
  'button2.ClickButton ' Click The Update Button
  Set UpdateInsure = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Form(0).Panel(9).Panel(0).Button("updatePersonDetails")
  UpdateInsure.Click
  
  Call browser2.Drag(1360, 494, 5, 115)
  section.panelContainer.panelColSm12.panelPanelBody.panelPanelBodyForm.panelFormDynamicSectionNoMargin.panelContactDetails.Click
  Call page.HoverMouse(1365, 165)
  Call browser2.Drag(1358, 301, 7, -140)
  panel2.buttonNo.ClickButton
  button.ClickButton
  panel.buttonPost.ClickButton
  panel3.buttonEmail.ClickButton
  Set textbox = panel4.panelColSm4.textboxTelephoneW
  Call textbox.Click(19, 11)
  TelWork = Excel.Cells(b,14)
  Call textbox.SetText(TelWork)
  Set textbox = panel4.panelColSm42.textboxHometelephone
  Call textbox.Click(27, 21)
  TelHome = Excel.Cells(b,15)
  Call textbox.SetText(TelHome)
  Set textbox = panel5.panelColSm4.textboxCellphone
  Call textbox.Click(195, 16)
  Cell = Excel.Cells(b,16)
  Call textbox.SetText(Cell)
  Set textbox = panel5.panelColSm42.textboxFax
  Call textbox.Click(72, 20)
  Fax = Excel.Cells(b,17)
  Call textbox.SetText(Fax)
  Set emailInput = form.panelFormGroup5.panelColSm4.emailinputEmail
  Call emailInput.Click(41, 21)
  emailad = Excel.Cells(b,18)
  Call emailInput.SetText(emailad)
  Call browser2.Drag(1357, 346, 8, 206)
  Set textbox = form.formFormNgUntouchedNgPristineN2
  Set textbox2 = textbox.panelFormGroup.panelColSm8.textboxLine1
  Set lin1 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(1).Panel(0).Textbox("addressLine1_Physical")
  line1 = Excel.Cells(b,19)
  lin1.SetText(line1)
  'Call textbox2.Click(155, 27)
  'Call textbox2.SetText("Testing")
  Set textbox2 = textbox.panelFormGroup2.panelColSm8.textboxLine2
  'Call textbox2.Click(68, 10)
  'Call textbox2.SetText("5345354h")
  Set lin2 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(2).Panel(0).Textbox("addressLine2_Physical")
  line2 = Excel.Cells(b,20)
  lin2.SetText(line2)
  Set textbox2 = textbox.panelFormGroup3.panelColSm8.textboxLine3
  'Call textbox2.Click(16, 31)
  Set lin3 = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(3).Panel(0).Textbox("addressLine3_Physical")
  line3 = Excel.Cells(b,21)
  lin3.SetText(line3)
  'Call textbox2.SetText("546546")
  Set textbox2 = textbox.panelFormGroup4.panelColSm8.textboxCity
  'Call textbox2.Click(39, 20)
  Set city = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(4).Panel(0).Textbox("addressCity_Physical")
  Cit = Excel.Cells(b,22)
  city.SetText(Cit)
  'Call textbox2.SetText("Johannesburg")
  Set textbox2 = textbox.panelFormGroup5.panelColSm8.textboxPostalCode
  'Call textbox2.Click(45, 18)'
  Set code = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(5).Panel(0).Textbox("addressPostalCode_Physical")
  Post = Excel.Cells(b,23)
  code.SetText(Post)
  'Call textbox2.SetText("0002")
  Set textbox2 = textbox.panelFormGroup6.panelColSm8.textboxProvince
  'Call textbox2.Click(40, 5)
  Set Provinc = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Form(0).Panel(6).Panel(0).Textbox("addressProvince_Physical")
  Prov = Excel.Cells(b,24)
  Provinc.SetText(Prov)
  'Call textbox2.SetText("Mpumalanga")
    countr = Excel.Cells(b,25)
  Aliases.browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg.formFormHorizontalNgUntouchedNg.selectCountrycodePhysical.ClickItem(countr)
 ' Call textbox.selectCountry.ClickItem("South Africa")
  Set checkbox = form.formFormNgUntouchedNgPristineN.checkboxSameAsPhysicalAddress
  Call checkbox.ClickButton(cbChecked)
  'button2.ClickButton
  'Click the Update Button
  Set Update = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Button("updatePersonContactDetails")
  Update.Click

 ' Set ProdLink = Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button(0)
  Set ProdLink = Sys.Browser("iexplore").Page("https://internal-retail-"&env&".momentum.co.za/nbc/#/investment-proposal/productDetails/lifeInsured;isLifeInsured=true").Section(0).Panel(1).Panel(0).Panel(2).Section(0).Panel(1).Button("productDetails")
  ProdLink.Click
End Function

Sub Test7

  Dim browser,form, table, textNode, browser2, table2  
  
  Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare")
  Set browser = Aliases.browser
  Set form = browser.pageNewBusinessCapture2.section.formFormHorizontalNgUntouchedNg
  Set table = form.panelFormGroup2.tableTableTableStripedTableNoBo
  'Proof Of ID
  table.cellTextRight4.link.Click
  Set textNode = table.textnodeUpload
  Call textNode.Click(88, 4)
  Set browser2 = browser.BrowserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Click
  'Proof of Residence
  table.cellTextRight5.link.Click
  Call textNode.Click(70, 18)
  Call browser2.Click
  'Proof of Banking Details
  table.cellTextRight6.link.Click
  Call textNode.Click(109, 9)
  Call browser2.Click
  'Advice Documents Section
  Set table = form.panelFormGroup
  Set table2 = table.tableTableTableStripedTableNoBo
  'Investment Proposal
  table2.cellTextRight4.link.Click
  Set textNode = table.panelColSm9.textnodeUpload
  Call textNode.Click(87, 12)
  Call browser2.Click
  'Application Form
  table2.cellTextRight5.link.Click
  Call textNode.Click(95, 7)
  Call browser2.Click
  
End Sub


Function Uploadfile()
  Dim browser
  Dim section
  Dim panel
  'Call Browsers.Item(btIExplorer).Navigate("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare")
  Set browser = Aliases.browser
  Set section = browser.pageNewBusinessCapture2.section
  Set panel = section.formFormHorizontalNgUntouchedNg.panelFormGroup2
  panel.panelColSm9.buttonYes.Click
  Call browser.dlgViewDownloadsInternetExplorer.OpenFile("C:\Users\johannes.kekana\Pictures\Beneficiary Screen\Delete Beneficiary Add Insure.PNG", "All Files (*.*)")
  Call panel.panelColSm3.HoverMouse(1194, 526)
  Sys.Browser("iexplore").Page("https://internal-retail-pre.momentum.co.za/nbc/#/investment-proposal/uploadAndShare").Section(0).Panel(1).Panel(0).Panel(0).Section(0).Panel(0).Panel(1).Panel(1).Panel(0).Panel(0).Form(0).Panel(0).Table(0).Panel(0).Panel(0).Panel(2).Button(1).Click
  'section.buttonCreateAndLoadProcess.ClickButton
End Function

Function LogOff
  

End Function 


Sub LoginMDS
  Dim browser,form, textbox, table, passwordBox, page, browserWindow, panel, browser2, frame
  'Call Aliases.explorer.wndTaskListThumbnailWnd.Click(790, 148)
  Call Browsers.Item(btIExplorer).Navigate("http://mdsonlinepre.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp")
  Set browser = Aliases.browser
  Set form = browser.pageMomentum.formLoginform
  Set textbox = form.textboxJUsername
  'Call textbox.Click(9, 10)
  Call textbox.SetText("derek")
  Call textbox.Keys("[Tab]")
  Set table = form.table.cellContentbold.table
  Set passwordBox = table.passwordboxJPassword
  Call passwordBox.Click
  Call passwordBox.SetText("Momentum1")
  Call table.imageSubmitGif.Click(24, 9)
  Aqutils.Delay 3000
  browser.pageHomePage.Wait
  Set page = browser.pageLogin
  Call page.frameHeadermenuframe.formActcodes.selectBrokercodeslistdiv.Click(280, 4)
  page.frameLeftmenuframe.linkLeftmainmenu10.Click
  aqUtils.Delay 3000
  Set form = page.frameContentframe.formWealthinvestmentcontracts
  'Call form.panelOcmenuOurproducts.HoverMouse(55, 0)
  'Call form.panelOcmenubbar0.HoverMouse(833, 8)
  'Call form.cellHeading3td3id.HoverMouse(439, 15)
  Set table = form.table
  'Call table.cell.table.cell.HoverMouse(55, 67)
  Call table.imageNewwebsitelivePng.Click(234, 62)
  aqUtils.Delay 2000
  Set browserWindow = browser.BrowserWindow2
  browserWindow.Maximize
  'Call browser.ToUrl("https://wealthpre.momentum.co.za/wealth/wealth.html?token=dccfb655-7e3e-4d73-b13e-3883c039ff19#!/")
  aqUtils.Delay 2000
  Set page = browser.pageMomentumWealth
  page.navTop.panel.panelNavbarInverse.linkTools.Click
  Set panel = page.panelContainerRow
  aqUtils.Delay 1500
  Call panel.panelPanelCollapseCollapseIn.panelPanelBodyNgScope.panelMediaLeftPullLeft.imageTool1Jpg.Click(96, 46)
  page.Wait
  Set browser2 = browserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1359, 329, 6, 206)
  Set frame = panel.frameWealthquotetooliframecontai
  frame.buttonAddClient.ClickButton
  Set panel = frame.panelClientDetails.panelPanelCollapseCollapseIn
  Set textbox = panel.panelFormGroupNgScope.textbox
  Call textbox.Click(22, 21)
  Call textbox.Keys("9007197625003")
  Call textbox.Click
  Call panel.panelFormGroupNgScope2.textbox.Click(127, 18)
  Set textbox = panel.panelFormGroupNgScope3.textbox
  Call textbox.Click(48, 9)
  Call textbox.Keys("Matso")
  Call textbox.Click
  Call textbox.Keys("[Tab]")
  Call panel.panelFormGroupNgScope4.panelColMd9.textbox.Keys("M")
  'Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=2dbcec6b-a176-435d-bbb8-dc94cf29b2d9#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(4).Panel(0).Textbox(0).SetText("M")
  Set textbox = panel.panelFormGroupNgScope5.textbox
  Call textbox.Click(20, 15)
  Call textbox.Keys("Testing")
  Set textbox = panel.panelFormGroupNgScope6.textbox
  Call textbox.Click(34, 18)
  Call textbox.Keys("joe@vodacom.com")
  Call panel.select.Click(93, 20)
 ' Call browser.pagepopup0.Click(93, 36)
  Set textbox = panel.panelFormGroupNgScope7.textbox
  Call textbox.Click(52, 24)
  Call textbox.SetText("0732098048")
  frame.buttonSaveClient.ClickButton
  Call browser2.Drag(1354, 448, 11, 103)
  frame.buttonAddQuote.ClickButton
  Aqutils.Delay 3000
  Call browser2.Drag(1358, 233, 7, 115)
  Set panel = frame.formCtrlForm.panelNgScope
'  Call panel.select.ClickItem("Retirement Income Option")
'  Call panel.panelPanelBodyCollapseNgScopeIn.panelRow.panelFormGroupColMd6.HoverMouse(435, 15)
End Sub
Sub Login
  Dim browser,form, textbox, table, passwordBox, page, browserWindow, panel, browser2, frame
  'Call Aliases.explorer.wndTaskListThumbnailWnd.Click(790, 148)
  Call Browsers.Item(btIExplorer).Navigate("http://mdsonlinepre.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp")
  Set browser = Aliases.browser
  Set form = browser.pageMomentum.formLoginform
  Set textbox = form.textboxJUsername
  'Call textbox.Click(9, 10)
  Call textbox.SetText("derek")
  Call textbox.Keys("[Tab]")
  Set table = form.table.cellContentbold.table
  Set passwordBox = table.passwordboxJPassword
  Call passwordBox.Click
  Call passwordBox.SetText("Momentum1")
  Call table.imageSubmitGif.Click(24, 9)
  Aqutils.Delay 3000
  browser.pageHomePage.Wait
  Set page = browser.pageLogin
  Call page.frameHeadermenuframe.formActcodes.selectBrokercodeslistdiv.Click(280, 4)
  page.frameLeftmenuframe.linkLeftmainmenu10.Click
  aqUtils.Delay 3000
  Set form = page.frameContentframe.formWealthinvestmentcontracts
  'Call form.panelOcmenuOurproducts.HoverMouse(55, 0)
  'Call form.panelOcmenubbar0.HoverMouse(833, 8)
  'Call form.cellHeading3td3id.HoverMouse(439, 15)
  Set table = form.table
  'Call table.cell.table.cell.HoverMouse(55, 67)
  Call table.imageNewwebsitelivePng.Click(234, 62)
End Sub 

Sub TestFlow
  Login
  QuoteDetails
End Sub 

Sub QuoteDetails

Dim browser,form, textbox, table, passwordBox, page, browserWindow, panel, browser2, frame
  'Call Aliases.explorer.wndTaskListThumbnailWnd.Click(790, 148)
'  Call Browsers.Item(btIExplorer).Navigate("http://mdsonlinepre.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp")
  Set browser = Aliases.browser
  Set form = browser.pageMomentum.formLoginform
  Set textbox = form.textboxJUsername
  'Call textbox.Click(9, 10)
 ' Call textbox.SetText("derek")
 ' Call textbox.Keys("[Tab]")
  Set table = form.table.cellContentbold.table
  'Set passwordBox = table.passwordboxJPassword
 ' Call passwordBox.Click
 ' Call passwordBox.SetText("Momentum1")
 ' Call table.imageSubmitGif.Click(24, 9)
'  Aqutils.Delay 3000
  'browser.pageHomePage.Wait
  Set page = browser.pageLogin
  'Call page.frameHeadermenuframe.formActcodes.selectBrokercodeslistdiv.Click(280, 4)
  'page.frameLeftmenuframe.linkLeftmainmenu10.Click
 ' aqUtils.Delay 3000
  Set form = page.frameContentframe.formWealthinvestmentcontracts
  'Call form.panelOcmenuOurproducts.HoverMouse(55, 0)
  'Call form.panelOcmenubbar0.HoverMouse(833, 8)
  'Call form.cellHeading3td3id.HoverMouse(439, 15)
  Set table = form.table
  'Call table.cell.table.cell.HoverMouse(55, 67)
  'Call table.imageNewwebsitelivePng.Click(234, 62)
  aqUtils.Delay 2000
  Set browserWindow = browser.BrowserWindow2
  'browserWindow.Maximize
  'Call browser.ToUrl("https://wealthpre.momentum.co.za/wealth/wealth.html?token=dccfb655-7e3e-4d73-b13e-3883c039ff19#!/")
  aqUtils.Delay 2000
  Set page = browser.pageMomentumWealth
  page.navTop.panel.panelNavbarInverse.linkTools.Click
  Set panel = page.panelContainerRow
  aqUtils.Delay 1500
  Call panel.panelPanelCollapseCollapseIn.panelPanelBodyNgScope.panelMediaLeftPullLeft.imageTool1Jpg.Click(96, 46)
  page.Wait
  Set browser2 = browserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1359, 329, 6, 206)
  Set frame = panel.frameWealthquotetooliframecontai
  frame.buttonAddClient.ClickButton
  Set panel = frame.panelClientDetails.panelPanelCollapseCollapseIn
  Set textbox = panel.panelFormGroupNgScope.textbox
  Call textbox.Click(22, 21)
  Call textbox.Keys("9007197625003")
  Call textbox.Click
  Call panel.panelFormGroupNgScope2.textbox.Click(127, 18)
  Set textbox = panel.panelFormGroupNgScope3.textbox
  Call textbox.Click(48, 9)
  Call textbox.Keys("Matso")
  Call textbox.Click
  Call textbox.Keys("[Tab]")
  Call panel.panelFormGroupNgScope4.panelColMd9.textbox.Keys("M")
  'Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=2dbcec6b-a176-435d-bbb8-dc94cf29b2d9#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(4).Panel(0).Textbox(0).SetText("M")
  Set textbox = panel.panelFormGroupNgScope5.textbox
  Call textbox.Click(20, 15)
  Call textbox.Keys("Testing")
  Set textbox = panel.panelFormGroupNgScope6.textbox
  Call textbox.Click(34, 18)
  Call textbox.Keys("joe@vodacom.com")
  Call panel.select.Click(93, 20)
 ' Call browser.pagepopup0.Click(93, 36)
  Set textbox = panel.panelFormGroupNgScope7.textbox
  Call textbox.Click(52, 24)
  Call textbox.SetText("0732098048")
  frame.buttonSaveClient.ClickButton
  Call browser2.Drag(1354, 448, 11, 103)
  frame.buttonAddQuote.ClickButton
  Aqutils.Delay 3000
  Call browser2.Drag(1358, 233, 7, 115)
  Set panel = frame.formCtrlForm.panelNgScope
'  Call panel.select.ClickItem("Retirement Income Option")

End Sub 

Function FuncLoginMDS
    Dim Process
  Excel.WorkSheets("CreateProcess").Activate
	RowCnt = Excel.ActiveSheet.UsedRange.Rows.Count
'	str1 = str
 ' msgbox str1
	For b = 2 to RowCnt
'        msgbox lcase(Excel.Cells(b,1))&" - "&lcase(str1)
		If lcase(Excel.Cells(b,1)) <> lcase(test) Then
 '     MsgBox lcase(Excel.Cells(b,1))&" - "& lcase(val1) 
		 'Move to the next row
		 Else     
     Process = Excel.Cells(b,2)
		  Exit For	
		End If		
	Next  

Dim browser,form, textbox, table, passwordBox, page, browserWindow, panel, browser2, frame
  'Call Aliases.explorer.wndTaskListThumbnailWnd.Click(790, 148)
  Call Browsers.Item(btIExplorer).Navigate("http://mdsonlinepre.momentum.co.za/mdsonline/welcome/loginScreen/loginScreen.jsp")
  Set browser = Aliases.browser
  Set form = browser.pageMomentum.formLoginform
  Set textbox = form.textboxJUsername
  Call textbox.Click(9, 10)
  Call textbox.SetText("derek")
  Call textbox.Keys("[Tab]")
  Set table = form.table.cellContentbold.table
  Set passwordBox = table.passwordboxJPassword
  Call passwordBox.Click
  Call passwordBox.SetText("Momentum1")
  Call table.imageSubmitGif.Click(24, 9)
  Aqutils.Delay 4000
  browser.pageHomePage.Wait
  Set page = browser.pageLogin
  Call page.frameHeadermenuframe.formActcodes.selectBrokercodeslistdiv.Click(280, 4)
  page.frameLeftmenuframe.linkLeftmainmenu10.Click
  aqUtils.Delay 3000
  Set form = page.frameContentframe.formWealthinvestmentcontracts
  'Call form.panelOcmenuOurproducts.HoverMouse(55, 0)
  'Call form.panelOcmenubbar0.HoverMouse(833, 8)
  'Call form.cellHeading3td3id.HoverMouse(439, 15)
  Set table = form.table
  'Call table.cell.table.cell.HoverMouse(55, 67)
  Call table.imageNewwebsitelivePng.Click(234, 62)
  aqUtils.Delay 2000
  Set browserWindow = browser.BrowserWindow2
  browserWindow.Maximize
  Call browser.ToUrl("https://wealthpre.momentum.co.za/wealth/wealth.html?token=dccfb655-7e3e-4d73-b13e-3883c039ff19#!/")
  aqUtils.Delay 2000
  Set page = browser.pageMomentumWealth
  page.navTop.panel.panelNavbarInverse.linkTools.Click
  Set panel = page.panelContainerRow
  aqUtils.Delay 1500
  Call panel.panelPanelCollapseCollapseIn.panelPanelBodyNgScope.panelMediaLeftPullLeft.imageTool1Jpg.Click(96, 46)
  page.Wait
  Set browser2 = browserWindow.FrameTab.tabpage.ShellDocObjectView.browser
  Call browser2.Drag(1359, 329, 6, 206)
  Set frame = panel.frameWealthquotetooliframecontai
  frame.buttonAddClient.ClickButton
  Set panel = frame.panelClientDetails.panelPanelCollapseCollapseIn
  Set textbox = panel.panelFormGroupNgScope.textbox
  Call textbox.Click(22, 21)
  Call textbox.Keys("9007197625003")
  Call textbox.Click
  Call panel.panelFormGroupNgScope2.textbox.Click(127, 18)
  Set textbox = panel.panelFormGroupNgScope3.textbox
  Call textbox.Click(48, 9)
  Call textbox.Keys("Matso")
  Call textbox.Click
  Call textbox.Keys("[Tab]")
  Call panel.panelFormGroupNgScope4.panelColMd9.textbox.Keys("M")
  'Sys.Browser("iexplore").Page("https://wealthpre.momentum.co.za/wealth/wealth.html?token=2dbcec6b-a176-435d-bbb8-dc94cf29b2d9#!/tools/quote/new").Panel(0).Panel(0).Panel(0).Frame("wealthQuoteToolIframeContainer").Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(4).Panel(0).Textbox(0).SetText("M")
  Set textbox = panel.panelFormGroupNgScope5.textbox
  Call textbox.Click(20, 15)
  Call textbox.Keys("Testing")
  Set textbox = panel.panelFormGroupNgScope6.textbox
  Call textbox.Click(34, 18)
  Call textbox.Keys("joe@vodacom.com")
  Call panel.select.Click(93, 20)
 ' Call browser.pagepopup0.Click(93, 36)
  Set textbox = panel.panelFormGroupNgScope7.textbox
  Call textbox.Click(52, 24)
  Call textbox.SetText("0732098048")
  frame.buttonSaveClient.ClickButton
  Call browser2.Drag(1354, 448, 11, 103)
  frame.buttonAddQuote.ClickButton
  Aqutils.Delay 2000
  Call browser2.Drag(1358, 233, 7, 115)
  Set panel = frame.formCtrlForm.panelNgScope
End Function